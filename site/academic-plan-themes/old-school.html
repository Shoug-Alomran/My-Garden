<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PSU · SE-CYS Degree Planner</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link
        href="https://fonts.googleapis.com/css2?family=Archivo+Black&family=Courier+Prime:ital,wght@0,400;0,700;1,400&family=Instrument+Serif:ital@0;1&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --paper: #f5f0e8;
            --paper2: #ede7d9;
            --paper3: #e3dccf;
            --ink: #1a1612;
            --ink2: #3d3530;
            --ink3: #7a6f65;
            --ink4: #b0a89e;
            --stamp-red: #c0392b;
            --stamp-green: #1a7a4a;
            --stamp-blue: #1a3d7a;
            --rule: #c8bfb0;
            --accent: #c0392b;
            --highlight: #f0d060;
            --shadow: 4px 4px 0px rgba(0, 0, 0, 0.15);
            --font-head: 'Archivo Black', sans-serif;
            --font-mono: 'Courier Prime', monospace;
            --font-serif: 'Instrument Serif', serif;
        }

        .dark {
            --paper: #141210;
            --paper2: #1c1916;
            --paper3: #242018;
            --ink: #f0e8d8;
            --ink2: #c8bfaf;
            --ink3: #7a7060;
            --ink4: #4a4438;
            --rule: #2e2820;
            --accent: #e05040;
            --highlight: #3a3010;
            --shadow: 4px 4px 0px rgba(0, 0, 0, 0.5);
        }

        *,
        *::before,
        *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            background: var(--paper);
            color: var(--ink);
            font-family: var(--font-mono);
            font-size: 13px;
            line-height: 1.5;
            transition: background 0.3s, color 0.3s;
            min-height: 100vh;
        }

        /* PAPER TEXTURE */
        body::before {
            content: '';
            position: fixed;
            inset: 0;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='300' height='300'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3CfeColorMatrix type='saturate' values='0'/%3E%3C/filter%3E%3Crect width='300' height='300' filter='url(%23noise)' opacity='0.04'/%3E%3C/svg%3E");
            pointer-events: none;
            z-index: 0;
            opacity: 0.6;
        }

        /* RULED LINES on paper background */
        body::after {
            content: '';
            position: fixed;
            inset: 0;
            background-image: repeating-linear-gradient(transparent,
                    transparent 27px,
                    var(--rule) 27px,
                    var(--rule) 28px);
            pointer-events: none;
            z-index: 0;
            opacity: 0.3;
        }

        .app {
            position: relative;
            z-index: 1;
            max-width: 1000px;
            margin: 0 auto;
            padding: 0 16px 80px;
        }

        /* ═══ MASTHEAD ═══ */
        .masthead {
            border-bottom: 3px solid var(--ink);
            padding: 28px 0 16px;
            margin-bottom: 0;
            position: relative;
        }

        .masthead-top {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 16px;
            flex-wrap: wrap;
        }

        .masthead-title {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .masthead-eyebrow {
            font-family: var(--font-mono);
            font-size: 10px;
            letter-spacing: 3px;
            text-transform: uppercase;
            color: var(--ink3);
            font-weight: 700;
        }

        .masthead-h1 {
            font-family: var(--font-head);
            font-size: clamp(28px, 5vw, 52px);
            line-height: 0.95;
            letter-spacing: -1px;
            color: var(--ink);
            text-transform: uppercase;
        }

        .masthead-h1 span {
            display: inline-block;
            background: var(--accent);
            color: var(--paper);
            padding: 0 6px;
            transform: skew(-2deg);
            margin-left: 4px;
        }

        .masthead-sub {
            font-family: var(--font-serif);
            font-style: italic;
            font-size: 14px;
            color: var(--ink3);
            margin-top: 6px;
        }

        .masthead-actions {
            display: flex;
            flex-direction: column;
            gap: 6px;
            align-items: flex-end;
            flex-shrink: 0;
        }

        .masthead-actions-row {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
            justify-content: flex-end;
        }

        /* STAMP BUTTON */
        .btn-stamp {
            font-family: var(--font-head);
            font-size: 10px;
            letter-spacing: 1.5px;
            text-transform: uppercase;
            padding: 6px 14px;
            border: 2px solid var(--ink);
            background: transparent;
            color: var(--ink);
            cursor: pointer;
            transition: all 0.12s;
            position: relative;
            white-space: nowrap;
        }

        .btn-stamp::after {
            content: '';
            position: absolute;
            bottom: -4px;
            right: -4px;
            width: 100%;
            height: 100%;
            border: 2px solid var(--ink);
            z-index: -1;
            transition: all 0.12s;
        }

        .btn-stamp:hover {
            transform: translate(-2px, -2px);
        }

        .btn-stamp:hover::after {
            bottom: -6px;
            right: -6px;
        }

        .btn-stamp:active {
            transform: translate(2px, 2px);
        }

        .btn-stamp:active::after {
            bottom: -2px;
            right: -2px;
        }

        .btn-stamp.red {
            border-color: var(--stamp-red);
            color: var(--stamp-red);
        }

        .btn-stamp.red::after {
            border-color: var(--stamp-red);
        }

        .btn-stamp.green {
            border-color: var(--stamp-green);
            color: var(--stamp-green);
        }

        .btn-stamp.green::after {
            border-color: var(--stamp-green);
        }

        .btn-stamp.filled {
            background: var(--ink);
            color: var(--paper);
        }

        /* ═══ STATS BAR ═══ */
        .stats-bar {
            display: grid;
            grid-template-columns: repeat(4, 1fr) 2fr;
            gap: 0;
            border: 2px solid var(--ink);
            border-top: none;
            margin-bottom: 24px;
        }

        .stat-cell {
            padding: 12px 16px;
            border-right: 2px solid var(--ink);
            position: relative;
        }

        .stat-cell:last-child {
            border-right: none;
        }

        .stat-label {
            font-family: var(--font-mono);
            font-size: 9px;
            letter-spacing: 2px;
            text-transform: uppercase;
            color: var(--ink3);
            display: block;
            margin-bottom: 4px;
        }

        .stat-num {
            font-family: var(--font-head);
            font-size: 28px;
            line-height: 1;
            color: var(--ink);
        }

        .stat-denom {
            font-family: var(--font-mono);
            font-size: 12px;
            color: var(--ink3);
        }

        .stat-bar-cell {
            padding: 12px 16px;
        }

        .progress-track {
            width: 100%;
            height: 8px;
            background: var(--rule);
            border: 1px solid var(--ink4);
            margin-top: 8px;
            position: relative;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--ink);
            transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: repeating-linear-gradient(45deg,
                    transparent,
                    transparent 3px,
                    rgba(255, 255, 255, 0.15) 3px,
                    rgba(255, 255, 255, 0.15) 6px);
        }

        .progress-pct-label {
            font-family: var(--font-head);
            font-size: 28px;
            color: var(--accent);
            line-height: 1;
        }

        /* ═══ CHOICE GROUPS ═══ */
        .choice-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0;
            border: 2px solid var(--ink);
            margin-bottom: 24px;
        }

        .choice-block {
            padding: 14px 16px;
            border-right: 2px solid var(--ink);
            position: relative;
        }

        .choice-block:last-child {
            border-right: none;
        }

        .choice-tag {
            display: inline-block;
            font-family: var(--font-head);
            font-size: 9px;
            letter-spacing: 2px;
            background: var(--ink);
            color: var(--paper);
            padding: 2px 8px;
            margin-bottom: 10px;
        }

        .choice-label {
            font-family: var(--font-serif);
            font-style: italic;
            font-size: 13px;
            color: var(--ink3);
            display: block;
            margin-bottom: 10px;
        }

        .choice-btns {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .choice-btn {
            font-family: var(--font-mono);
            font-size: 11px;
            font-weight: 700;
            padding: 5px 12px;
            border: 1.5px solid var(--rule);
            background: transparent;
            color: var(--ink3);
            cursor: pointer;
            transition: all 0.12s;
            position: relative;
        }

        .choice-btn.active {
            border-color: var(--accent);
            color: var(--accent);
            background: transparent;
        }

        .choice-btn.active::before {
            content: '✦ ';
            font-size: 8px;
        }

        .choice-btn:not(.active):hover {
            border-color: var(--ink3);
            color: var(--ink);
        }

        /* ═══ CONTROLS ═══ */
        .controls {
            display: flex;
            gap: 0;
            margin-bottom: 0;
            border: 2px solid var(--ink);
            border-bottom: none;
        }

        .search-box {
            flex: 1;
            position: relative;
            border-right: 2px solid var(--ink);
        }

        .search-box input {
            width: 100%;
            padding: 10px 14px 10px 36px;
            background: transparent;
            border: none;
            outline: none;
            font-family: var(--font-mono);
            font-size: 12px;
            color: var(--ink);
            letter-spacing: 0.5px;
        }

        .search-box input::placeholder {
            color: var(--ink4);
        }

        .search-icon {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--ink3);
            font-size: 13px;
        }

        .filter-group {
            display: flex;
        }

        .filter-btn {
            font-family: var(--font-head);
            font-size: 9px;
            letter-spacing: 1.5px;
            text-transform: uppercase;
            padding: 10px 14px;
            border: none;
            border-right: 2px solid var(--ink);
            background: transparent;
            color: var(--ink3);
            cursor: pointer;
            transition: all 0.12s;
            white-space: nowrap;
        }

        .filter-btn:last-child {
            border-right: none;
        }

        .filter-btn.active {
            background: var(--ink);
            color: var(--paper);
        }

        .filter-btn:not(.active):hover {
            background: var(--rule);
            color: var(--ink);
        }

        /* ═══ LEVEL SECTIONS ═══ */
        .level-wrap {
            margin-bottom: 0;
        }

        .level-head {
            display: grid;
            grid-template-columns: 56px 1fr auto;
            align-items: center;
            border: 2px solid var(--ink);
            border-top: none;
            cursor: pointer;
            user-select: none;
            transition: background 0.1s;
        }

        .level-head:hover {
            background: var(--paper2);
        }

        .level-num {
            font-family: var(--font-head);
            font-size: 22px;
            text-align: center;
            padding: 10px 8px;
            border-right: 2px solid var(--ink);
            line-height: 1;
            color: var(--ink);
            background: var(--paper2);
        }

        .level-name-wrap {
            padding: 10px 16px;
            border-right: 2px solid var(--ink);
        }

        .level-name {
            font-family: var(--font-head);
            font-size: 12px;
            letter-spacing: 2px;
            text-transform: uppercase;
            color: var(--ink);
        }

        .level-sub {
            font-size: 11px;
            color: var(--ink3);
            font-family: var(--font-mono);
        }

        .level-meta-box {
            padding: 10px 16px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .level-fraction {
            font-family: var(--font-head);
            font-size: 14px;
            color: var(--ink3);
            white-space: nowrap;
        }

        .level-caret {
            font-size: 12px;
            color: var(--ink3);
            transition: transform 0.2s;
        }

        .level-wrap.collapsed .level-caret {
            transform: rotate(-90deg);
        }

        .level-wrap.collapsed .level-body {
            display: none;
        }

        /* ═══ COURSE ROWS ═══ */
        .course-row {
            display: grid;
            grid-template-columns: 44px 90px 1fr 80px 90px;
            align-items: center;
            border: 2px solid var(--ink);
            border-top: none;
            cursor: pointer;
            transition: background 0.1s;
            position: relative;
            min-height: 48px;
        }

        .course-row:hover:not(.locked) {
            background: var(--paper2);
        }

        .course-row.locked {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .course-row.completed {
            background: var(--highlight);
        }

        .dark .course-row.completed {
            background: var(--highlight);
        }

        .course-row.highlighted-row {
            outline: 3px solid var(--accent);
            outline-offset: -3px;
            z-index: 2;
        }

        /* Checkbox cell */
        .cr-check {
            display: flex;
            align-items: center;
            justify-content: center;
            border-right: 2px solid var(--ink);
            align-self: stretch;
            font-size: 18px;
            transition: all 0.15s;
        }

        .check-box {
            width: 22px;
            height: 22px;
            border: 2px solid var(--ink3);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.15s;
            font-size: 14px;
            font-weight: 700;
            color: transparent;
            font-family: var(--font-mono);
        }

        .course-row.completed .check-box {
            border-color: var(--stamp-green);
            color: var(--stamp-green);
            background: transparent;
            font-size: 16px;
            animation: stampIn 0.25s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .course-row.locked .check-box {
            border-style: dashed;
        }

        @keyframes stampIn {
            0% {
                transform: scale(1.6) rotate(-10deg);
                opacity: 0;
            }

            60% {
                transform: scale(0.9) rotate(2deg);
                opacity: 1;
            }

            100% {
                transform: scale(1) rotate(0deg);
                opacity: 1;
            }
        }

        /* ID cell */
        .cr-id {
            padding: 8px 10px;
            border-right: 2px solid var(--ink);
            font-family: var(--font-head);
            font-size: 11px;
            letter-spacing: 0.5px;
            color: var(--ink);
            align-self: stretch;
            display: flex;
            align-items: center;
            word-break: break-all;
        }

        /* Name cell */
        .cr-name-cell {
            padding: 8px 12px;
            border-right: 2px solid var(--ink);
            align-self: stretch;
            display: flex;
            flex-direction: column;
            justify-content: center;
            gap: 4px;
        }

        .cr-name {
            font-family: var(--font-serif);
            font-style: italic;
            font-size: 14px;
            color: var(--ink);
            line-height: 1.3;
        }

        .cr-prereqs {
            display: flex;
            gap: 4px;
            flex-wrap: wrap;
        }

        .pr-chip {
            font-family: var(--font-mono);
            font-size: 9px;
            font-weight: 700;
            letter-spacing: 0.5px;
            padding: 1px 5px;
            border: 1px solid;
            cursor: pointer;
            transition: all 0.1s;
            white-space: nowrap;
        }

        .pr-chip.met {
            border-color: var(--stamp-green);
            color: var(--stamp-green);
        }

        .pr-chip.unmet {
            border-color: var(--stamp-red);
            color: var(--stamp-red);
        }

        .pr-chip:hover {
            background: currentColor;
        }

        .pr-chip:hover span {
            color: var(--paper);
            mix-blend-mode: unset;
        }

        .pr-chip:hover {
            filter: brightness(1.2);
        }

        /* Hours cell */
        .cr-hours {
            padding: 8px 10px;
            border-right: 2px solid var(--ink);
            font-family: var(--font-head);
            font-size: 13px;
            color: var(--ink3);
            text-align: center;
            align-self: stretch;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            gap: 1px;
        }

        .cr-hours-num {
            font-size: 20px;
            color: var(--ink);
            line-height: 1;
        }

        .cr-hours-label {
            font-size: 8px;
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        /* Status cell */
        .cr-status {
            padding: 8px 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            align-self: stretch;
        }

        .status-stamp {
            font-family: var(--font-head);
            font-size: 9px;
            letter-spacing: 2px;
            text-transform: uppercase;
            padding: 3px 8px;
            border: 2px solid;
            transform: rotate(-3deg);
            white-space: nowrap;
        }

        .status-stamp.done {
            border-color: var(--stamp-green);
            color: var(--stamp-green);
        }

        .status-stamp.avail {
            border-color: var(--stamp-blue);
            color: var(--stamp-blue);
            transform: rotate(2deg);
        }

        .status-stamp.lock {
            border-color: var(--ink4);
            color: var(--ink4);
            transform: rotate(-1deg);
            border-style: dashed;
        }

        .status-stamp.nosel {
            border-color: var(--ink4);
            color: var(--ink4);
            transform: rotate(1deg);
            border-style: dotted;
            font-size: 8px;
        }

        /* ═══ COLUMN HEADER ═══ */
        .col-header {
            display: grid;
            grid-template-columns: 44px 90px 1fr 80px 90px;
            border: 2px solid var(--ink);
            border-top: none;
            background: var(--paper3);
        }

        .ch-cell {
            padding: 6px 10px;
            border-right: 2px solid var(--ink);
            font-family: var(--font-head);
            font-size: 9px;
            letter-spacing: 2px;
            text-transform: uppercase;
            color: var(--ink3);
        }

        .ch-cell:last-child {
            border-right: none;
        }

        .ch-cell.center {
            text-align: center;
        }

        /* ═══ TOAST ═══ */
        #toast-root {
            position: fixed;
            bottom: 24px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 9999;
            display: flex;
            flex-direction: column;
            gap: 6px;
            align-items: center;
        }

        .toast {
            font-family: var(--font-mono);
            font-size: 12px;
            letter-spacing: 0.5px;
            padding: 10px 18px;
            background: var(--ink);
            color: var(--paper);
            border: 2px solid var(--ink);
            white-space: nowrap;
            animation: toastPop 0.2s;
            position: relative;
        }

        .toast::after {
            content: '';
            position: absolute;
            bottom: -4px;
            right: -4px;
            width: 100%;
            height: 100%;
            border: 2px solid var(--ink);
            z-index: -1;
        }

        .toast.err {
            background: var(--stamp-red);
            border-color: var(--stamp-red);
        }

        .toast.ok {
            background: var(--stamp-green);
            border-color: var(--stamp-green);
        }

        @keyframes toastPop {
            from {
                transform: translateY(10px) scale(0.95);
                opacity: 0;
            }

            to {
                transform: translateY(0) scale(1);
                opacity: 1;
            }
        }

        /* ═══ MODAL ═══ */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.6);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.15s;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        .modal-box {
            background: var(--paper);
            border: 3px solid var(--ink);
            padding: 0;
            max-width: 420px;
            width: 90%;
            box-shadow: 8px 8px 0 var(--ink);
            animation: modalDrop 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes modalDrop {
            from {
                transform: translateY(-12px) scale(0.97);
                opacity: 0;
            }

            to {
                transform: none;
                opacity: 1;
            }
        }

        .modal-header {
            background: var(--ink);
            color: var(--paper);
            padding: 12px 20px;
            font-family: var(--font-head);
            font-size: 13px;
            letter-spacing: 2px;
            text-transform: uppercase;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-body {
            padding: 20px;
        }

        .modal-body p {
            font-family: var(--font-mono);
            font-size: 12px;
            color: var(--ink2);
            margin-bottom: 14px;
            line-height: 1.6;
        }

        .modal-list {
            list-style: none;
            margin-bottom: 20px;
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .modal-list li {
            font-family: var(--font-mono);
            font-size: 11px;
            padding: 4px 10px;
            border-left: 3px solid var(--stamp-red);
            color: var(--stamp-red);
            background: var(--paper2);
        }

        .modal-footer {
            border-top: 2px solid var(--ink);
            padding: 12px 20px;
            display: flex;
            gap: 8px;
            justify-content: flex-end;
        }

        .empty-msg {
            border: 2px dashed var(--rule);
            border-top: none;
            padding: 32px;
            text-align: center;
            font-family: var(--font-serif);
            font-style: italic;
            color: var(--ink4);
            font-size: 15px;
        }

        @media (max-width: 640px) {
            .stats-bar {
                grid-template-columns: repeat(2, 1fr) 1fr;
            }

            .stat-cell:nth-child(3) {
                border-right: none;
            }

            .stat-cell:nth-child(4) {
                border-right: 2px solid var(--ink);
            }

            .course-row {
                grid-template-columns: 36px 72px 1fr 60px 72px;
            }

            .col-header {
                grid-template-columns: 36px 72px 1fr 60px 72px;
            }

            .choice-section {
                grid-template-columns: 1fr;
            }

            .choice-block {
                border-right: none;
                border-bottom: 2px solid var(--ink);
            }

            .choice-block:last-child {
                border-bottom: none;
            }
        }
    </style>
  <script src="/javascripts/standalone-theme.js"></script>
</head>

<body>

    <div class="app">

        <!-- MASTHEAD -->
        <div class="masthead">
            <div class="masthead-top">
                <div class="masthead-title">
                    <span class="masthead-eyebrow">Prince Sultan University · CCIS</span>
                    <h1 class="masthead-h1">DEGREE<span>PLAN</span></h1>
                    <div class="masthead-sub">Software Engineering (Cybersecurity Track) — Mandatory Course Registry
                    </div>
                </div>
                <div class="masthead-actions">
                    <div class="masthead-actions-row">
                        <button class="btn-stamp green" id="mark13Btn">MARK L1–3 DONE</button>
                        <button class="btn-stamp green" id="markAllBtn">MARK ALL DONE</button>
                    </div>
                    <div class="masthead-actions-row">
                        <button class="btn-stamp red" id="resetBtn">RESET</button>
                        <button class="btn-stamp filled" id="themeBtn">◐ DARK / LIGHT</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- STATS BAR -->
        <div class="stats-bar">
            <div class="stat-cell">
                <span class="stat-label">Credit Hrs</span>
                <div><span class="stat-num" id="statHours">0</span> <span class="stat-denom">/ <span
                            id="statTotal">—</span></span></div>
            </div>
            <div class="stat-cell">
                <span class="stat-label">Courses</span>
                <div><span class="stat-num" id="statCourses">0</span> <span class="stat-denom">/ <span
                            id="statTotalC">—</span></span></div>
            </div>
            <div class="stat-cell">
                <span class="stat-label">Remaining</span>
                <div><span class="stat-num" id="statRemain">—</span> <span class="stat-denom">hrs</span></div>
            </div>
            <div class="stat-cell">
                <span class="stat-label">GPA Track</span>
                <div><span class="stat-num" style="font-size:16px;padding-top:6px;display:block;color:var(--ink3)">— /
                        5.0</span></div>
            </div>
            <div class="stat-cell stat-bar-cell">
                <span class="stat-label">Progress</span>
                <span class="progress-pct-label" id="statPct">0%</span>
                <div class="progress-track">
                    <div class="progress-fill" id="progressFill" style="width:0%"></div>
                </div>
            </div>
        </div>

        <!-- CHOICE GROUPS -->
        <div class="choice-section">
            <div class="choice-block">
                <span class="choice-tag">GROUP A — CHOOSE 1</span>
                <span class="choice-label">Mathematics Elective</span>
                <div class="choice-btns">
                    <button class="choice-btn active" data-group="A" data-val="MATH223">MATH223 · Linear
                        Algebra</button>
                    <button class="choice-btn" data-group="A" data-val="CS223">CS223 · Computational Linear
                        Algebra</button>
                </div>
            </div>
            <div class="choice-block">
                <span class="choice-tag">GROUP B — CHOOSE 1</span>
                <span class="choice-label">Cybersecurity Elective</span>
                <div class="choice-btns">
                    <button class="choice-btn active" data-group="B" data-val="CYS406">CYS406 · Data & Network
                        Security</button>
                    <button class="choice-btn" data-group="B" data-val="CYS404">CYS404 · Cyber-Physical Systems
                        Security</button>
                </div>
            </div>
        </div>

        <!-- CONTROLS -->
        <div class="controls">
            <div class="search-box">
                <span class="search-icon">⌕</span>
                <input type="text" id="searchInput" placeholder="Search course code or name…">
            </div>
            <div class="filter-group">
                <button class="filter-btn active" data-filter="all">ALL</button>
                <button class="filter-btn" data-filter="completed">DONE</button>
                <button class="filter-btn" data-filter="available">OPEN</button>
                <button class="filter-btn" data-filter="locked">LOCKED</button>
            </div>
        </div>

        <!-- COLUMN HEADER -->
        <div class="col-header" id="colHeader">
            <div class="ch-cell center">✓</div>
            <div class="ch-cell">CODE</div>
            <div class="ch-cell">COURSE NAME / PREREQUISITES</div>
            <div class="ch-cell center">HOURS</div>
            <div class="ch-cell center">STATUS</div>
        </div>

        <!-- COURSE LIST -->
        <div id="courseList"></div>

    </div>

    <div id="toast-root"></div>

    <script>
        const COURSES_RAW = [
            { id: 'ARAB101', name: 'Arabic Writing', hours: 2, level: 1, prereqs: [] },
            { id: 'ENG101', name: 'Intensive Writing', hours: 3, level: 1, prereqs: [] },
            { id: 'ISC101', name: 'Islamic Ethics', hours: 2, level: 1, prereqs: [] },
            { id: 'CS101', name: 'Computer Programming I', hours: 4, level: 1, prereqs: [] },
            { id: 'MATH111', name: 'Calculus I', hours: 3, level: 1, prereqs: [] },
            { id: 'CHM101', name: 'General Chemistry', hours: 4, level: 1, prereqs: [] },
            { id: 'CS102', name: 'Computer Programming II', hours: 3, level: 2, prereqs: ['CS101'] },
            { id: 'CS175', name: 'Digital Logic & Computer Organization', hours: 3, level: 2, prereqs: ['CS101'] },
            { id: 'ENG103', name: 'Research Writing Techniques', hours: 3, level: 2, prereqs: ['ENG101'] },
            { id: 'STAT101', name: 'Introduction to Statistics & Probability', hours: 3, level: 2, prereqs: ['MATH111'] },
            { id: 'MATH113', name: 'Calculus II', hours: 3, level: 2, prereqs: ['MATH111'] },
            { id: 'ISC103', name: 'Islamic Economic System', hours: 2, level: 2, prereqs: [] },
            { id: 'SE201', name: 'Introduction to Software Engineering', hours: 3, level: 3, prereqs: ['CS102', 'ENG103'] },
            { id: 'PHY105', name: 'Physics I', hours: 4, level: 3, prereqs: ['MATH111'] },
            { id: 'CS285', name: 'Discrete Math for Computing', hours: 3, level: 3, prereqs: ['CS210'] },
            { id: 'CS210', name: 'Data Structures & Algorithms', hours: 3, level: 3, prereqs: ['CS102'] },
            { id: 'ISC105', name: 'Holy Quran Sciences', hours: 2, level: 3, prereqs: [] },
            { id: 'COM201', name: 'Communication Skills', hours: 3, level: 3, prereqs: [] },
            { id: 'SE365', name: 'Human–Computer Interaction', hours: 3, level: 4, prereqs: ['CS210'] },
            { id: 'SE311', name: 'Software Requirements Engineering', hours: 3, level: 4, prereqs: ['SE201'] },
            { id: 'PHY205', name: 'Physics II', hours: 4, level: 4, prereqs: ['PHY105'] },
            { id: 'CS330', name: 'Introduction to Operating Systems', hours: 3, level: 4, prereqs: ['CS175', 'CS210'] },
            { id: 'PSY101', name: 'Introduction to Psychology', hours: 3, level: 4, prereqs: [] },
            { id: 'SE322', name: 'Software Design & Architecture', hours: 3, level: 5, prereqs: ['SE311'] },
            { id: 'CYS401', name: 'Fundamentals of Cybersecurity', hours: 3, level: 5, prereqs: ['CS210'] },
            { id: 'CS340', name: 'Introduction to Database Systems', hours: 3, level: 5, prereqs: ['CS210'] },
            { id: 'CS331', name: 'Data Communications & Computer Networks', hours: 3, level: 5, prereqs: ['CS175', 'CS210'] },
            { id: 'ISC203', name: 'Contemporary Financial Transactions', hours: 2, level: 5, prereqs: [] },
            { id: 'ARAB103', name: 'Professional & Literary Writing', hours: 2, level: 5, prereqs: [] },
            { id: 'CYS403', name: 'Cybersecurity Risk, Governance & Compliance', hours: 3, level: 6, prereqs: ['CYS401'] },
            { id: 'CYS402', name: 'Secure Software Development', hours: 3, level: 6, prereqs: ['CYS401'] },
            { id: 'SE401', name: 'Software Testing & Quality Assurance', hours: 3, level: 6, prereqs: ['SE322'] },
            { id: 'SE371', name: 'Web Engineering', hours: 3, level: 6, prereqs: ['CS210'] },
            { id: 'MATH221', name: 'Numerical Analysis', hours: 3, level: 6, prereqs: ['MATH113'] },
            { id: 'ETHC303', name: 'Ethical & Social Aspects of Computing', hours: 3, level: 6, prereqs: [] },
            { id: 'CYS405', name: 'Penetration Testing & Ethical Hacking', hours: 3, level: 7, prereqs: ['CS331', 'CYS401'] },
            { id: 'SE499', name: 'Senior Project', hours: 3, level: 7, prereqs: ['SE423'] },
            { id: 'SE423', name: 'Software Engineering Project Management', hours: 3, level: 7, prereqs: ['SE401'] },
            { id: 'SE411', name: 'Software Construction', hours: 3, level: 7, prereqs: ['SE401'] },
            { id: 'ARAB203', name: 'Arabic Grammar', hours: 2, level: 7, prereqs: [] },
            { id: 'SE492', name: 'Cooperative Training', hours: 10, level: 8, prereqs: ['SE499'] },
            { id: 'MATH223', name: 'Linear Algebra', hours: 3, level: 6, prereqs: ['MATH113'], group: 'A' },
            { id: 'CS223', name: 'Computational Linear Algebra', hours: 3, level: 6, prereqs: ['CS101', 'MATH113'], group: 'A' },
            { id: 'CYS406', name: 'Data & Network Security', hours: 3, level: 7, prereqs: ['CS331', 'CYS401'], group: 'B' },
            { id: 'CYS404', name: 'Cyber-Physical Systems Security', hours: 3, level: 7, prereqs: ['CS331', 'CYS401'], group: 'B' },
        ];

        let completed = new Set();
        let choices = { A: 'MATH223', B: 'CYS406' };
        let searchQ = '';
        let filterMode = 'all';
        let highlighted = null;
        let darkMode = true;

        function persist() {
            localStorage.setItem('psu2_done', JSON.stringify([...completed]));
            localStorage.setItem('psu2_choices', JSON.stringify(choices));
            localStorage.setItem('psu2_dark', darkMode ? '1' : '0');
        }
        function loadState() {
            const d = localStorage.getItem('psu2_done');
            if (d) completed = new Set(JSON.parse(d));
            const c = localStorage.getItem('psu2_choices');
            if (c) choices = JSON.parse(c);
            const th = localStorage.getItem('psu2_dark');
            if (th !== null) darkMode = th === '1';
        }

        function getActive() {
            return COURSES_RAW.filter(c => !c.group || c.id === choices[c.group]);
        }
        function getStatus(c) {
            if (completed.has(c.id)) return 'completed';
            return c.prereqs.every(p => completed.has(p)) ? 'available' : 'locked';
        }
        function allDependents(id) {
            const res = new Set();
            const q = [id];
            while (q.length) {
                const cur = q.shift();
                getActive().forEach(c => {
                    if (c.prereqs.includes(cur) && !res.has(c.id)) {
                        res.add(c.id);
                        q.push(c.id);
                    }
                });
            }
            return [...res];
        }
        function topoSort(ids) {
            const map = {};
            ids.forEach(id => { const c = COURSES_RAW.find(x => x.id === id); map[id] = c ? c.prereqs.filter(p => ids.includes(p)) : []; });
            const visited = new Set(), result = [];
            function visit(id) { if (visited.has(id)) return; visited.add(id); (map[id] || []).forEach(visit); result.push(id); }
            ids.forEach(visit);
            return result;
        }

        function updateStats() {
            const active = getActive();
            const total = active.length;
            const done = active.filter(c => completed.has(c.id)).length;
            const th = active.reduce((s, c) => s + c.hours, 0);
            const ch = active.filter(c => completed.has(c.id)).reduce((s, c) => s + c.hours, 0);
            const pct = th > 0 ? Math.round(ch / th * 100) : 0;
            document.getElementById('statHours').textContent = ch;
            document.getElementById('statTotal').textContent = th;
            document.getElementById('statCourses').textContent = done;
            document.getElementById('statTotalC').textContent = total;
            document.getElementById('statRemain').textContent = th - ch;
            document.getElementById('statPct').textContent = pct + '%';
            document.getElementById('progressFill').style.width = pct + '%';
        }

        function render() {
            updateStats();
            const active = getActive();
            const levels = [...new Set(active.map(c => c.level))].sort((a, b) => a - b);
            const list = document.getElementById('courseList');
            const q = searchQ.toLowerCase();
            list.innerHTML = '';
            let anyVisible = false;

            const levelNames = { 1: 'Freshman I', 2: 'Freshman II', 3: 'Sophomore I', 4: 'Sophomore II', 5: 'Junior I', 6: 'Junior II', 7: 'Senior I', 8: 'Senior II' };

            levels.forEach(lv => {
                let courses = active.filter(c => c.level === lv).sort((a, b) => a.id.localeCompare(b.id));
                let filtered = courses.filter(c => {
                    if (q && !c.id.toLowerCase().includes(q) && !c.name.toLowerCase().includes(q)) return false;
                    const st = getStatus(c);
                    if (filterMode === 'completed' && st !== 'completed') return false;
                    if (filterMode === 'available' && st !== 'available') return false;
                    if (filterMode === 'locked' && st !== 'locked') return false;
                    return true;
                });
                if (!filtered.length) return;
                anyVisible = true;

                const doneC = filtered.filter(c => completed.has(c.id)).length;
                const totalHrs = filtered.reduce((s, c) => s + c.hours, 0);

                const wrap = document.createElement('div');
                wrap.className = 'level-wrap';

                wrap.innerHTML = `
      <div class="level-head">
        <div class="level-num">L${lv}</div>
        <div class="level-name-wrap">
          <div class="level-name">Level ${lv} · ${levelNames[lv] || ''}</div>
          <div class="level-sub">${totalHrs} credit hours</div>
        </div>
        <div class="level-meta-box">
          <span class="level-fraction">${doneC} / ${filtered.length}</span>
          <span class="level-caret">▼</span>
        </div>
      </div>
      <div class="level-body"></div>
    `;
                wrap.querySelector('.level-head').addEventListener('click', () => wrap.classList.toggle('collapsed'));

                const body = wrap.querySelector('.level-body');

                filtered.forEach(course => {
                    const st = getStatus(course);
                    const row = document.createElement('div');
                    row.className = `course-row ${st}${highlighted === course.id ? ' highlighted-row' : ''}`;
                    row.dataset.id = course.id;

                    const prereqHtml = course.prereqs.map(p => {
                        const met = completed.has(p);
                        return `<span class="pr-chip ${met ? 'met' : 'unmet'}" data-prereq="${p}">${p}</span>`;
                    }).join('');

                    let stampHtml = '';
                    if (st === 'completed') stampHtml = `<span class="status-stamp done">DONE</span>`;
                    else if (st === 'available') stampHtml = `<span class="status-stamp avail">OPEN</span>`;
                    else stampHtml = `<span class="status-stamp lock">LOCKED</span>`;

                    const checkContent = st === 'completed' ? '✓' : (st === 'locked' ? '⊘' : '○');

                    row.innerHTML = `
        <div class="cr-check"><div class="check-box">${checkContent}</div></div>
        <div class="cr-id">${course.id}${course.group ? `<br><span style="font-size:9px;font-weight:400;letter-spacing:1px;color:var(--ink4)">GRP ${course.group}</span>` : ''}</div>
        <div class="cr-name-cell">
          <div class="cr-name">${course.name}</div>
          <div class="cr-prereqs">${prereqHtml}</div>
        </div>
        <div class="cr-hours"><span class="cr-hours-num">${course.hours}</span><span class="cr-hours-label">HRS</span></div>
        <div class="cr-status">${stampHtml}</div>
      `;

                    row.addEventListener('click', e => {
                        if (e.target.closest('.pr-chip')) return;
                        toggleCourse(course.id);
                    });

                    row.querySelectorAll('.pr-chip').forEach(chip => {
                        chip.addEventListener('click', e => {
                            e.stopPropagation();
                            const pid = chip.dataset.prereq;
                            highlighted = highlighted === pid ? null : pid;
                            render();
                            const el = document.querySelector(`.course-row[data-id="${pid}"]`);
                            if (el) el.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        });
                    });

                    body.appendChild(row);
                });
                list.appendChild(wrap);
            });

            // Inactive choices
            const inactive = COURSES_RAW.filter(c => c.group && c.id !== choices[c.group]);
            if (inactive.length && (filterMode === 'all' || filterMode === 'locked')) {
                anyVisible = true;
                const wrap2 = document.createElement('div');
                wrap2.className = 'level-wrap';
                wrap2.innerHTML = `
      <div class="level-head">
        <div class="level-num" style="font-size:14px">ALT</div>
        <div class="level-name-wrap">
          <div class="level-name">Not Selected — Choice Alternatives</div>
          <div class="level-sub">These courses are excluded from your plan</div>
        </div>
        <div class="level-meta-box"><span class="level-fraction">0 / ${inactive.length}</span><span class="level-caret">▼</span></div>
      </div>
      <div class="level-body"></div>
    `;
                wrap2.querySelector('.level-head').addEventListener('click', () => wrap2.classList.toggle('collapsed'));
                const body2 = wrap2.querySelector('.level-body');
                inactive.forEach(c => {
                    const row = document.createElement('div');
                    row.className = 'course-row locked';
                    row.style.opacity = '0.35';
                    row.innerHTML = `
        <div class="cr-check"><div class="check-box">—</div></div>
        <div class="cr-id">${c.id}</div>
        <div class="cr-name-cell"><div class="cr-name">${c.name}</div></div>
        <div class="cr-hours"><span class="cr-hours-num">${c.hours}</span><span class="cr-hours-label">HRS</span></div>
        <div class="cr-status"><span class="status-stamp nosel">NOT SEL</span></div>
      `;
                    body2.appendChild(row);
                });
                list.appendChild(wrap2);
            }

            if (!anyVisible) {
                list.innerHTML = '<div class="empty-msg">No courses match the current filter.</div>';
            }
        }

        function toggleCourse(id) {
            const course = COURSES_RAW.find(c => c.id === id);
            if (!course) return;
            if (completed.has(id)) {
                const deps = allDependents(id).filter(d => completed.has(d));
                if (deps.length) {
                    showModal('Remove Dependents', `Unchecking <b>${id}</b> will also remove:`, deps, () => {
                        completed.delete(id);
                        deps.forEach(d => completed.delete(d));
                        persist(); render();
                        toast(`${id} and ${deps.length} dependent(s) removed.`, 'err');
                    });
                } else {
                    completed.delete(id);
                    persist(); render();
                    toast(`${course.id} unchecked.`, 'err');
                }
            } else {
                const missing = course.prereqs.filter(p => !completed.has(p));
                if (missing.length) {
                    toast(`Missing prereqs for ${id}: ${missing.join(', ')}`, 'err');
                    return;
                }
                completed.add(id);
                persist(); render();
                toast(`${course.id} — ${course.name}`, 'ok');
            }
        }

        function showModal(title, msg, items, onOk) {
            const ov = document.createElement('div');
            ov.className = 'modal-overlay';
            ov.innerHTML = `
    <div class="modal-box">
      <div class="modal-header"><span>${title}</span><span>PSU · SE-CYS</span></div>
      <div class="modal-body">
        <p>${msg}</p>
        <ul class="modal-list">${items.map(i => `<li>${i}</li>`).join('')}</ul>
      </div>
      <div class="modal-footer">
        <button class="btn-stamp" id="mCancel">CANCEL</button>
        <button class="btn-stamp red" id="mOk">CONFIRM</button>
      </div>
    </div>
  `;
            document.body.appendChild(ov);
            ov.querySelector('#mCancel').addEventListener('click', () => ov.remove());
            ov.querySelector('#mOk').addEventListener('click', () => { ov.remove(); onOk(); });
            ov.addEventListener('click', e => { if (e.target === ov) ov.remove(); });
        }

        function toast(msg, type = '') {
            const r = document.getElementById('toast-root');
            const t = document.createElement('div');
            t.className = `toast ${type}`;
            t.textContent = msg;
            r.appendChild(t);
            setTimeout(() => { t.style.opacity = '0'; t.style.transform = 'translateY(8px)'; t.style.transition = 'all 0.3s'; setTimeout(() => t.remove(), 300); }, 3000);
        }

        // Choice buttons
        document.querySelectorAll('.choice-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const g = btn.dataset.group, val = btn.dataset.val;
                if (choices[g] === val) return;
                const old = choices[g];
                const aff = completed.has(old) ? [old, ...allDependents(old).filter(d => completed.has(d))] : [];
                const doSwitch = () => {
                    aff.forEach(d => completed.delete(d));
                    choices[g] = val;
                    document.querySelectorAll(`.choice-btn[data-group="${g}"]`).forEach(b => b.classList.toggle('active', b.dataset.val === val));
                    persist(); render();
                    toast(`Group ${g}: switched to ${val}`, 'ok');
                };
                if (aff.length) showModal(`Change Group ${g}`, `Switching will remove completed courses:`, aff, doSwitch);
                else doSwitch();
            });
        });

        document.getElementById('mark13Btn').addEventListener('click', () => {
            const ids = topoSort(getActive().filter(c => c.level <= 3).map(c => c.id));
            ids.forEach(id => completed.add(id));
            persist(); render();
            toast('Levels 1–3 marked complete.', 'ok');
        });
        document.getElementById('markAllBtn').addEventListener('click', () => {
            showModal('Mark All Complete', 'Mark every active course as completed?', [], () => {
                const ids = topoSort(getActive().map(c => c.id));
                ids.forEach(id => completed.add(id));
                persist(); render();
                toast('All courses marked complete.', 'ok');
            });
        });
        document.getElementById('resetBtn').addEventListener('click', () => {
            showModal('Reset All Progress', 'Clear all completion data?', [], () => {
                completed.clear(); persist(); render();
                toast('Progress reset.', 'err');
            });
        });
        document.getElementById('themeBtn').addEventListener('click', () => {
            darkMode = !darkMode;
            document.body.classList.toggle('dark', darkMode);
            persist();
        });
        document.getElementById('searchInput').addEventListener('input', e => { searchQ = e.target.value; render(); });
        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                filterMode = btn.dataset.filter;
                document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                render();
            });
        });

        // Init
        loadState();
        document.body.classList.toggle('dark', darkMode);
        render();
    </script>
</body>

</html>