<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chapter 5 Quiz ‚Äî Cryptography</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Sans:ital,wght@0,300;0,400;0,500;1,300&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #f0f2ff;
    --surface: #ffffff;
    --surface2: #f5f7ff;
    --border: rgba(100,80,255,0.12);
    --text: #14112e;
    --text2: #4a4570;
    --accent1: #5533ff;
    --accent2: #ff3366;
    --accent3: #00d4aa;
    --accent4: #ff9900;
    --grad1: linear-gradient(135deg, #5533ff 0%, #9933ff 100%);
    --grad2: linear-gradient(135deg, #ff3366 0%, #ff6633 100%);
    --grad3: linear-gradient(135deg, #00d4aa 0%, #0099ff 100%);
    --grad4: linear-gradient(135deg, #ff9900 0%, #ff3366 100%);
    --shadow: 0 8px 40px rgba(85,51,255,0.12);
    --shadow-hover: 0 16px 60px rgba(85,51,255,0.22);
    --correct: #00d4aa;
    --wrong: #ff3366;
    --correct-bg: rgba(0,212,170,0.08);
    --wrong-bg: rgba(255,51,102,0.08);
  }
  @media (prefers-color-scheme: dark) {
    :root {
      --bg: #0a0914;
      --surface: #130f2a;
      --surface2: #1a1535;
      --border: rgba(150,120,255,0.15);
      --text: #f0eeff;
      --text2: #a89fd8;
      --accent1: #7b5fff;
      --accent2: #ff4d77;
      --accent3: #00e8bb;
      --accent4: #ffaa22;
      --grad1: linear-gradient(135deg, #7b5fff 0%, #b366ff 100%);
      --grad2: linear-gradient(135deg, #ff4d77 0%, #ff7755 100%);
      --grad3: linear-gradient(135deg, #00e8bb 0%, #33aaff 100%);
      --grad4: linear-gradient(135deg, #ffaa22 0%, #ff4d77 100%);
      --shadow: 0 8px 40px rgba(0,0,0,0.5);
      --shadow-hover: 0 16px 60px rgba(123,95,255,0.3);
      --correct: #00e8bb;
      --wrong: #ff4d77;
      --correct-bg: rgba(0,232,187,0.08);
      --wrong-bg: rgba(255,77,119,0.08);
    }
  }

  * { margin:0; padding:0; box-sizing:border-box; }
  body {
    font-family: 'DM Sans', sans-serif;
    background: var(--bg);
    color: var(--text);
    line-height: 1.7;
    font-size: 15px;
    overflow-x: hidden;
  }

  .hero {
    position: relative;
    min-height: 260px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-direction: column;
    text-align: center;
    padding: 50px 24px 40px;
    overflow: hidden;
  }
  .hero-bg { position:absolute;inset:0; background:var(--grad1); z-index:0; }
  .hero-bg::after {
    content:'';position:absolute;inset:0;
    background: radial-gradient(ellipse at 15% 85%, rgba(255,51,102,0.4) 0%, transparent 55%),
                radial-gradient(ellipse at 85% 15%, rgba(0,212,170,0.3) 0%, transparent 50%);
  }
  .orb { position:absolute;border-radius:50%;filter:blur(55px);opacity:0.3;animation:float 8s ease-in-out infinite; }
  .orb:nth-child(2){width:280px;height:280px;background:#ff3366;top:-80px;right:-50px;animation-delay:-3s;}
  .orb:nth-child(3){width:180px;height:180px;background:#00d4aa;bottom:-50px;left:8%;animation-delay:-6s;}
  @keyframes float{0%,100%{transform:translateY(0) scale(1);}50%{transform:translateY(-18px) scale(1.04);}}
  .hero-content { position:relative;z-index:1; }
  .hero-tag {
    display:inline-block;background:rgba(255,255,255,0.2);backdrop-filter:blur(10px);
    border:1px solid rgba(255,255,255,0.3);border-radius:100px;padding:6px 20px;
    font-size:12px;font-weight:600;letter-spacing:0.1em;text-transform:uppercase;color:#fff;margin-bottom:18px;
  }
  .hero h1 {
    font-family:'Syne',sans-serif;font-size:clamp(1.8rem,5vw,3.2rem);font-weight:800;
    color:#fff;line-height:1.1;margin-bottom:10px;
  }
  .hero h1 span { color:rgba(255,255,255,0.6); }
  .hero p { color:rgba(255,255,255,0.8);font-size:1rem;max-width:520px;margin:0 auto;font-weight:300; }

  .progress-wrap {
    background: var(--surface);
    border-bottom: 1px solid var(--border);
    padding: 16px 24px;
    position: sticky;
    top: 0;
    z-index: 100;
    display: flex;
    align-items: center;
    gap: 16px;
    backdrop-filter: blur(20px);
  }
  .progress-bar-outer {
    flex: 1;
    height: 8px;
    background: var(--surface2);
    border-radius: 100px;
    overflow: hidden;
    border: 1px solid var(--border);
  }
  .progress-bar-inner {
    height: 100%;
    background: var(--grad1);
    border-radius: 100px;
    transition: width 0.5s cubic-bezier(0.4,0,0.2,1);
    width: 0%;
  }
  .progress-label {
    font-family: 'Syne', sans-serif;
    font-size: 13px;
    font-weight: 700;
    color: var(--text2);
    white-space: nowrap;
  }
  .score-pill {
    background: var(--grad1);
    color: #fff;
    font-family: 'Syne', sans-serif;
    font-size: 12px;
    font-weight: 700;
    padding: 5px 16px;
    border-radius: 100px;
    white-space: nowrap;
  }

  main {
    max-width: 820px;
    margin: 0 auto;
    padding: 40px 24px 80px;
    display: flex;
    flex-direction: column;
    gap: 0;
  }

  .section-divider {
    display: flex;
    align-items: center;
    gap: 14px;
    margin: 40px 0 20px;
  }
  .section-divider:first-child { margin-top: 0; }
  .sec-icon {
    width: 44px; height: 44px;
    border-radius: 12px;
    display: flex; align-items: center; justify-content: center;
    font-size: 20px; flex-shrink: 0;
  }
  .sec-icon.g1 { background: var(--grad1); }
  .sec-icon.g2 { background: var(--grad2); }
  .sec-icon.g3 { background: var(--grad3); }
  .sec-icon.g4 { background: var(--grad4); }
  .section-divider h2 {
    font-family: 'Syne', sans-serif;
    font-size: 1.3rem;
    font-weight: 800;
    color: var(--text);
  }
  .section-divider p { font-size: 13px; color: var(--text2); margin-top:2px; }

  .q-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 20px;
    padding: 28px;
    margin-bottom: 16px;
    box-shadow: var(--shadow);
    transition: all 0.3s;
    position: relative;
    overflow: hidden;
  }
  .q-card::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0;
    height: 3px;
    background: var(--grad1);
  }
  .q-card.answered-correct::before { background: linear-gradient(135deg, #00d4aa, #0099ff); }
  .q-card.answered-wrong::before { background: linear-gradient(135deg, #ff3366, #ff6633); }

  .q-meta {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 12px;
  }
  .q-num {
    font-size: 11px;
    font-weight: 700;
    letter-spacing: 0.12em;
    text-transform: uppercase;
    color: var(--text2);
  }
  .q-type {
    font-size: 11px;
    font-weight: 600;
    padding: 3px 12px;
    border-radius: 100px;
    background: var(--surface2);
    border: 1px solid var(--border);
    color: var(--text2);
  }
  .q-text {
    font-size: 15px;
    font-weight: 500;
    color: var(--text);
    margin-bottom: 18px;
    line-height: 1.6;
  }
  .q-scenario {
    background: var(--surface2);
    border-left: 3px solid var(--accent1);
    border-radius: 0 12px 12px 0;
    padding: 12px 16px;
    font-size: 13.5px;
    color: var(--text2);
    margin-bottom: 16px;
    font-style: italic;
  }

  .options { display: flex; flex-direction: column; gap: 10px; }
  .option-btn {
    background: var(--surface2);
    border: 1.5px solid var(--border);
    border-radius: 12px;
    padding: 13px 18px;
    font-family: 'DM Sans', sans-serif;
    font-size: 14px;
    color: var(--text);
    cursor: pointer;
    text-align: left;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    gap: 12px;
  }
  .option-btn:hover:not(:disabled) {
    border-color: var(--accent1);
    background: var(--surface);
    transform: translateX(4px);
  }
  .option-btn:disabled { cursor: default; }
  .option-btn.selected-correct { background: var(--correct-bg); border-color: var(--correct); color: var(--text); }
  .option-btn.selected-wrong { background: var(--wrong-bg); border-color: var(--wrong); color: var(--text); }
  .option-btn.show-correct { background: var(--correct-bg); border-color: var(--correct); opacity: 0.7; }
  .opt-letter {
    width: 28px; height: 28px;
    border-radius: 8px;
    background: var(--border);
    display: flex; align-items: center; justify-content: center;
    font-family: 'Syne', sans-serif;
    font-size: 12px;
    font-weight: 700;
    flex-shrink: 0;
    transition: all 0.2s;
  }
  .selected-correct .opt-letter { background: var(--correct); color: #fff; }
  .selected-wrong .opt-letter { background: var(--wrong); color: #fff; }
  .show-correct .opt-letter { background: var(--correct); color: #fff; }

  .text-input-wrap { display: flex; gap: 10px; align-items: flex-start; flex-wrap: wrap; }
  .text-input {
    flex: 1;
    min-width: 200px;
    background: var(--surface2);
    border: 1.5px solid var(--border);
    border-radius: 12px;
    padding: 12px 16px;
    font-family: 'DM Sans', sans-serif;
    font-size: 14px;
    color: var(--text);
    outline: none;
    transition: all 0.2s;
  }
  .text-input:focus { border-color: var(--accent1); background: var(--surface); }
  .text-input:disabled { opacity: 0.7; cursor: default; }
  .text-input.correct-input { border-color: var(--correct); background: var(--correct-bg); }
  .text-input.wrong-input { border-color: var(--wrong); background: var(--wrong-bg); }

  .submit-btn {
    background: var(--grad1);
    color: #fff;
    border: none;
    border-radius: 12px;
    padding: 12px 22px;
    font-family: 'Syne', sans-serif;
    font-size: 13px;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.2s;
    white-space: nowrap;
  }
  .submit-btn:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 8px 24px rgba(85,51,255,0.3); }
  .submit-btn:disabled { opacity: 0.5; cursor: default; transform: none; }

  .feedback {
    margin-top: 14px;
    border-radius: 14px;
    padding: 14px 18px;
    font-size: 13.5px;
    line-height: 1.65;
    display: none;
    animation: fadeIn 0.3s ease;
  }
  @keyframes fadeIn { from { opacity:0; transform:translateY(6px); } to { opacity:1; transform:translateY(0); } }
  .feedback.show { display: block; }
  .feedback.correct-fb { background: var(--correct-bg); border: 1px solid var(--correct); }
  .feedback.wrong-fb { background: var(--wrong-bg); border: 1px solid var(--wrong); }
  .fb-header {
    font-family: 'Syne', sans-serif;
    font-size: 13px;
    font-weight: 700;
    margin-bottom: 6px;
    display: flex;
    align-items: center;
    gap: 8px;
  }
  .fb-header.correct-h { color: var(--correct); }
  .fb-header.wrong-h { color: var(--wrong); }
  .fb-body { color: var(--text2); }

  .tf-options { display: flex; gap: 12px; }
  .tf-btn {
    flex: 1;
    padding: 14px;
    border-radius: 12px;
    border: 1.5px solid var(--border);
    background: var(--surface2);
    font-family: 'Syne', sans-serif;
    font-size: 14px;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.2s;
    color: var(--text);
    text-align: center;
  }
  .tf-btn:hover:not(:disabled) { transform: translateY(-3px); box-shadow: var(--shadow-hover); }
  .tf-btn:disabled { cursor: default; }
  .tf-btn.tf-true:hover:not(:disabled) { border-color: var(--correct); color: var(--correct); }
  .tf-btn.tf-false:hover:not(:disabled) { border-color: var(--wrong); color: var(--wrong); }
  .tf-btn.selected-correct { background: var(--correct-bg); border-color: var(--correct); color: var(--correct); }
  .tf-btn.selected-wrong { background: var(--wrong-bg); border-color: var(--wrong); color: var(--wrong); }
  .tf-btn.show-correct { background: var(--correct-bg); border-color: var(--correct); color: var(--correct); opacity:0.7; }

  .formula-box {
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 12px 18px;
    font-family: monospace;
    font-size: 13px;
    color: var(--accent1);
    margin-bottom: 16px;
    text-align: center;
    letter-spacing: 0.05em;
  }

  #results-screen {
    display: none;
    text-align: center;
    padding: 60px 24px;
    animation: fadeIn 0.5s ease;
  }
  .results-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 28px;
    padding: 50px 40px;
    box-shadow: var(--shadow);
    max-width: 600px;
    margin: 0 auto;
    position: relative;
    overflow: hidden;
  }
  .results-card::before {
    content: '';
    position: absolute;
    top:0;left:0;right:0;height:4px;
    background: var(--grad1);
  }
  .score-circle {
    width: 140px; height: 140px;
    border-radius: 50%;
    background: var(--grad1);
    display: flex;
    align-items: center;
    justify-content: center;
    flex-direction: column;
    margin: 0 auto 28px;
    box-shadow: 0 0 60px rgba(85,51,255,0.3);
  }
  .score-big {
    font-family: 'Syne', sans-serif;
    font-size: 2.8rem;
    font-weight: 800;
    color: #fff;
    line-height: 1;
  }
  .score-denom { font-size: 14px; color: rgba(255,255,255,0.7); }
  .results-card h2 {
    font-family: 'Syne', sans-serif;
    font-size: 1.8rem;
    font-weight: 800;
    margin-bottom: 10px;
  }
  .results-card p { color: var(--text2); font-size: 14px; margin-bottom: 24px; }
  .grade-badge {
    display: inline-block;
    font-family: 'Syne', sans-serif;
    font-size: 1rem;
    font-weight: 800;
    padding: 8px 28px;
    border-radius: 100px;
    margin-bottom: 28px;
    color: #fff;
  }
  .results-stats {
    display: grid;
    grid-template-columns: 1fr 1fr 1fr;
    gap: 14px;
    margin-bottom: 30px;
  }
  .stat-box {
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 14px;
    padding: 14px;
    text-align: center;
  }
  .stat-num { font-family: 'Syne', sans-serif; font-size: 1.6rem; font-weight: 800; }
  .stat-num.green { color: var(--correct); }
  .stat-num.red { color: var(--wrong); }
  .stat-num.blue { color: var(--accent1); }
  .stat-label { font-size: 12px; color: var(--text2); margin-top: 2px; }
  .restart-btn {
    background: var(--grad1);
    color: #fff;
    border: none;
    border-radius: 14px;
    padding: 16px 40px;
    font-family: 'Syne', sans-serif;
    font-size: 15px;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.2s;
  }
  .restart-btn:hover { transform: translateY(-3px); box-shadow: 0 12px 30px rgba(85,51,255,0.35); }

  #finish-wrap {
    text-align: center;
    padding: 30px 0 10px;
  }
  .finish-btn {
    background: var(--grad4);
    color: #fff;
    border: none;
    border-radius: 14px;
    padding: 16px 48px;
    font-family: 'Syne', sans-serif;
    font-size: 15px;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.2s;
    box-shadow: var(--shadow);
  }
  .finish-btn:hover { transform: translateY(-3px); box-shadow: var(--shadow-hover); }

  footer {
    background: var(--surface);
    border-top: 1px solid var(--border);
    text-align: center;
    padding: 28px 24px;
    color: var(--text2);
    font-size: 13px;
    margin-top: 20px;
  }

  @media (max-width:600px) {
    .tf-options { flex-direction: column; }
    .text-input-wrap { flex-direction: column; }
    .results-stats { grid-template-columns: 1fr; }
    .results-card { padding: 36px 24px; }
  }
</style>
</head>
<body>

<div class="hero">
  <div class="hero-bg">
    <div class="orb"></div><div class="orb"></div><div class="orb"></div>
  </div>
  <div class="hero-content">
    <div class="hero-tag">Chapter 5 ¬∑ Cryptography Quiz</div>
    <h1>Test Your Knowledge<br><span>Ciphers, Keys & Attacks</span></h1>
    <p>30 questions across 5 categories. Keyword-graded answers with instant explanations.</p>
  </div>
</div>

<div class="progress-wrap">
  <div class="progress-label" id="progress-label">0 / 30</div>
  <div class="progress-bar-outer">
    <div class="progress-bar-inner" id="progress-bar"></div>
  </div>
  <div class="score-pill" id="score-pill">Score: 0</div>
</div>

<main id="quiz-main">

  <!-- ========================= SECTION 1 ========================= -->
  <div class="section-divider">
    <div class="sec-icon g1">üîë</div>
    <div><h2>Foundations & Basic Concepts</h2><p>Questions 1‚Äì7</p></div>
  </div>

  <!-- Q1 MCQ -->
  <div class="q-card" id="q1">
    <div class="q-meta"><span class="q-num">Question 1</span><span class="q-type">Multiple Choice</span></div>
    <div class="q-text">Cryptography can protect which TWO of the three CIA properties?</div>
    <div class="options" id="opts1">
      <button class="option-btn" onclick="checkMCQ('q1','A','Confidentiality and Integrity','C')"><span class="opt-letter">A</span> Confidentiality and Availability</button>
      <button class="option-btn" onclick="checkMCQ('q1','B','Confidentiality and Integrity','C')"><span class="opt-letter">B</span> Integrity and Availability</button>
      <button class="option-btn" onclick="checkMCQ('q1','C','Confidentiality and Integrity','C')"><span class="opt-letter">C</span> Confidentiality and Integrity</button>
      <button class="option-btn" onclick="checkMCQ('q1','D','Confidentiality and Integrity','C')"><span class="opt-letter">D</span> All three: Confidentiality, Integrity, and Availability</button>
    </div>
    <div class="feedback" id="fb1"></div>
  </div>

  <!-- Q2 SHORT -->
  <div class="q-card" id="q2">
    <div class="q-meta"><span class="q-num">Question 2</span><span class="q-type">Short Answer</span></div>
    <div class="q-text">What is <strong>cryptanalysis</strong>? How is it different from cryptography?</div>
    <div class="text-input-wrap">
      <input class="text-input" id="input2" placeholder="Define cryptanalysis‚Ä¶" onkeydown="if(event.key==='Enter') submitText('q2',['without key','without knowing','break','deciphering','codebreak','recover','original message'],'Breaking ciphertext without knowing the key','Cryptanalysis is the process of obtaining the original plaintext from ciphertext WITHOUT access to the secret key ‚Äî essentially codebreaking. Cryptography is the art of making codes (encryption), while cryptanalysis is the art of breaking them. Together, they form Cryptology. The adversary Eve uses cryptanalysis to attack systems.')">
      <button class="submit-btn" onclick="submitText('q2',['without key','without knowing','break','deciphering','codebreak','recover','original message'],'Breaking ciphertext without knowing the key','Cryptanalysis is the process of obtaining the original plaintext from ciphertext WITHOUT access to the secret key ‚Äî essentially codebreaking. Cryptography is the art of making codes (encryption), while cryptanalysis is the art of breaking them. Together, they form Cryptology. The adversary Eve uses cryptanalysis to attack systems.')">Submit</button>
    </div>
    <div class="feedback" id="fb2"></div>
  </div>

  <!-- Q3 TF -->
  <div class="q-card" id="q3">
    <div class="q-meta"><span class="q-num">Question 3</span><span class="q-type">True / False</span></div>
    <div class="q-text">According to <strong>Kerckhoffs's Principle</strong>, the encryption algorithm must be kept secret ‚Äî only the key is known publicly.</div>
    <div class="tf-options">
      <button class="tf-btn tf-true" onclick="checkTF('q3', true, false, 'Kerckhoffs\'s Principle states the OPPOSITE: the algorithm must be made PUBLIC; only the key is kept secret. A secure system should remain secure even if the adversary knows everything about the encryption algorithm except the key. Modern algorithms like AES are publicly known ‚Äî their security comes entirely from key secrecy, not algorithm secrecy.')">‚úÖ True</button>
      <button class="tf-btn tf-false" onclick="checkTF('q3', false, false, 'Kerckhoffs\'s Principle states the OPPOSITE: the algorithm must be made PUBLIC; only the key is kept secret. A secure system should remain secure even if the adversary knows everything about the encryption algorithm except the key. Modern algorithms like AES are publicly known ‚Äî their security comes entirely from key secrecy, not algorithm secrecy.')">‚ùå False</button>
    </div>
    <div class="feedback" id="fb3"></div>
  </div>

  <!-- Q4 MCQ -->
  <div class="q-card" id="q4">
    <div class="q-meta"><span class="q-num">Question 4</span><span class="q-type">Multiple Choice</span></div>
    <div class="q-text">Given the encryption notation, if Alice sends Bob a message using symmetric encryption, which statement is correct?</div>
    <div class="options" id="opts4">
      <button class="option-btn" onclick="checkMCQ('q4','A','Dk(Ek(P)) = P','B')"><span class="opt-letter">A</span> Alice uses a public key to encrypt; Bob uses a private key to decrypt</button>
      <button class="option-btn" onclick="checkMCQ('q4','B','Dk(Ek(P)) = P','B')"><span class="opt-letter">B</span> Dk(Ek(P)) = P ‚Äî both use the same shared secret key K</button>
      <button class="option-btn" onclick="checkMCQ('q4','C','Dk(Ek(P)) = P','B')"><span class="opt-letter">C</span> The ciphertext length is always shorter than the plaintext</button>
      <button class="option-btn" onclick="checkMCQ('q4','D','Dk(Ek(P)) = P','B')"><span class="opt-letter">D</span> The decryption key is always different from the encryption key</button>
    </div>
    <div class="feedback" id="fb4"></div>
  </div>

  <!-- Q5 SHORT -->
  <div class="q-card" id="q5">
    <div class="q-meta"><span class="q-num">Question 5</span><span class="q-type">Short Answer</span></div>
    <div class="q-text">What is the field that combines both cryptography and cryptanalysis called?</div>
    <div class="text-input-wrap">
      <input class="text-input" id="input5" placeholder="One word answer‚Ä¶" onkeydown="if(event.key==='Enter') submitText('q5',['cryptology','cryptologi'],'Cryptology','Cryptology is the science of encryption that combines both cryptography (making codes) and cryptanalysis (breaking codes). Cryptology is considered a branch of mathematics. The distinction: Cryptography = keeping messages secure. Cryptanalysis = breaking ciphertext. Cryptology = both fields together.')">
      <button class="submit-btn" onclick="submitText('q5',['cryptology','cryptologi'],'Cryptology','Cryptology is the science of encryption that combines both cryptography (making codes) and cryptanalysis (breaking codes). Cryptology is considered a branch of mathematics. The distinction: Cryptography = keeping messages secure. Cryptanalysis = breaking ciphertext. Cryptology = both fields together.')">Submit</button>
    </div>
    <div class="feedback" id="fb5"></div>
  </div>

  <!-- Q6 MCQ -->
  <div class="q-card" id="q6">
    <div class="q-meta"><span class="q-num">Question 6</span><span class="q-type">Multiple Choice</span></div>
    <div class="q-text">Cryptosystems are classified along three independent dimensions. Which of the following is NOT one of them?</div>
    <div class="options" id="opts6">
      <button class="option-btn" onclick="checkMCQ('q6','A','not one','D')"><span class="opt-letter">A</span> Number of keys used</button>
      <button class="option-btn" onclick="checkMCQ('q6','B','not one','D')"><span class="opt-letter">B</span> Type of operation (substitution or transposition)</button>
      <button class="option-btn" onclick="checkMCQ('q6','C','not one','D')"><span class="opt-letter">C</span> Way the plaintext is processed (block or stream)</button>
      <button class="option-btn" onclick="checkMCQ('q6','D','not one','D')"><span class="opt-letter">D</span> Length of the plaintext message</button>
    </div>
    <div class="feedback" id="fb6"></div>
  </div>

  <!-- Q7 TF -->
  <div class="q-card" id="q7">
    <div class="q-meta"><span class="q-num">Question 7</span><span class="q-type">True / False</span></div>
    <div class="q-text">Symmetric encryption is approximately 30,000 times <strong>faster</strong> than asymmetric (public-key) encryption.</div>
    <div class="tf-options">
      <button class="tf-btn tf-true" onclick="checkTF('q7', true, true, 'Correct! Symmetric encryption is approximately 30,000 times faster than asymmetric (public-key) encryption. This is why symmetric encryption is used for bulk data encryption (like AES encrypting file contents), while asymmetric encryption is typically used only for key exchange or digital signatures ‚Äî not for encrypting large amounts of data.')">‚úÖ True</button>
      <button class="tf-btn tf-false" onclick="checkTF('q7', false, true, 'Correct! Symmetric encryption is approximately 30,000 times faster than asymmetric (public-key) encryption. This is why symmetric encryption is used for bulk data encryption (like AES encrypting file contents), while asymmetric encryption is typically used only for key exchange or digital signatures ‚Äî not for encrypting large amounts of data.')">‚ùå False</button>
    </div>
    <div class="feedback" id="fb7"></div>
  </div>

  <!-- ========================= SECTION 2 ========================= -->
  <div class="section-divider">
    <div class="sec-icon g2">üî§</div>
    <div><h2>Classical Substitution Ciphers</h2><p>Questions 8‚Äì15</p></div>
  </div>

  <!-- Q8 MCQ -->
  <div class="q-card" id="q8">
    <div class="q-meta"><span class="q-num">Question 8</span><span class="q-type">Multiple Choice</span></div>
    <div class="q-text">In the Caesar Cipher with shift n=14, encrypting the letter 'a' (position 0) gives which result?</div>
    <div class="formula-box">En(x) = (x + n) mod 26 &nbsp;|&nbsp; Dn(x) = (x ‚àí n) mod 26</div>
    <div class="options" id="opts8">
      <button class="option-btn" onclick="checkMCQ('q8','A','O','A')"><span class="opt-letter">A</span> O (position 14)</button>
      <button class="option-btn" onclick="checkMCQ('q8','B','O','A')"><span class="opt-letter">B</span> N (position 13)</button>
      <button class="option-btn" onclick="checkMCQ('q8','C','O','A')"><span class="opt-letter">C</span> P (position 15)</button>
      <button class="option-btn" onclick="checkMCQ('q8','D','O','A')"><span class="opt-letter">D</span> A (position 0)</button>
    </div>
    <div class="feedback" id="fb8"></div>
  </div>

  <!-- Q9 SHORT -->
  <div class="q-card" id="q9">
    <div class="q-meta"><span class="q-num">Question 9</span><span class="q-type">Short Answer</span></div>
    <div class="q-scenario">Scenario: Using Caesar Cipher with shift n=3, encrypt the word "CAT". Use the formula En(x) = (x + 3) mod 26. A=0, B=1, C=2, D=3, E=4, F=5, G=6...</div>
    <div class="text-input-wrap">
      <input class="text-input" id="input9" placeholder="What is the ciphertext of CAT?" onkeydown="if(event.key==='Enter') submitText('q9',['fdw','FDW'],'FDW','Caesar Cipher shift 3: C(2)+3=5=F, A(0)+3=3=D, T(19)+3=22=W ‚Üí FDW. This is the classic Caesar Cipher (ROT3). Julius Caesar historically used a shift of 3 to communicate with Cicero. The formula En(x) = (x + n) mod 26 ensures wrapping ‚Äî for example, Z(25)+3 = 28 mod 26 = 2 = C.')">
      <button class="submit-btn" onclick="submitText('q9',['fdw','FDW'],'FDW','Caesar Cipher shift 3: C(2)+3=5=F, A(0)+3=3=D, T(19)+3=22=W ‚Üí FDW. This is the classic Caesar Cipher (ROT3). Julius Caesar historically used a shift of 3 to communicate with Cicero. The formula En(x) = (x + n) mod 26 ensures wrapping ‚Äî for example, Z(25)+3 = 28 mod 26 = 2 = C.')">Submit</button>
    </div>
    <div class="feedback" id="fb9"></div>
  </div>

  <!-- Q10 TF -->
  <div class="q-card" id="q10">
    <div class="q-meta"><span class="q-num">Question 10</span><span class="q-type">True / False</span></div>
    <div class="q-text">ROT13 is a special case of the Caesar Cipher with a shift of 13, and applying it twice to a message returns the original plaintext.</div>
    <div class="tf-options">
      <button class="tf-btn tf-true" onclick="checkTF('q10', true, true, 'Correct! ROT13 shifts each letter by 13 positions. Since 26 √∑ 2 = 13, applying ROT13 twice returns the original: ROT13(ROT13(x)) = x. This makes ROT13 its own inverse ‚Äî encryption and decryption are identical operations. There are 26! possible monoalphabetic substitution ciphers (over 4.03 √ó 10¬≤‚Å∂), though ROT13 specifically is not cryptographically secure.')">‚úÖ True</button>
      <button class="tf-btn tf-false" onclick="checkTF('q10', false, true, 'Correct! ROT13 shifts each letter by 13 positions. Since 26 √∑ 2 = 13, applying ROT13 twice returns the original: ROT13(ROT13(x)) = x. This makes ROT13 its own inverse ‚Äî encryption and decryption are identical operations. There are 26! possible monoalphabetic substitution ciphers (over 4.03 √ó 10¬≤‚Å∂), though ROT13 specifically is not cryptographically secure.')">‚ùå False</button>
    </div>
    <div class="feedback" id="fb10"></div>
  </div>

  <!-- Q11 MCQ -->
  <div class="q-card" id="q11">
    <div class="q-meta"><span class="q-num">Question 11</span><span class="q-type">Multiple Choice</span></div>
    <div class="q-text">In a Keyword Cipher using keyword "PSU IS MY CHOICE", what is the FIRST step before building the cipher alphabet?</div>
    <div class="options" id="opts11">
      <button class="option-btn" onclick="checkMCQ('q11','A','remove duplicates','B')"><span class="opt-letter">A</span> Reverse the keyword letters</button>
      <button class="option-btn" onclick="checkMCQ('q11','B','remove duplicates','B')"><span class="opt-letter">B</span> Remove repeated/duplicate letters from the keyword</button>
      <button class="option-btn" onclick="checkMCQ('q11','C','remove duplicates','B')"><span class="opt-letter">C</span> Sort the keyword letters alphabetically</button>
      <button class="option-btn" onclick="checkMCQ('q11','D','remove duplicates','B')"><span class="opt-letter">D</span> Convert the keyword to numbers then back to letters</button>
    </div>
    <div class="feedback" id="fb11"></div>
  </div>

  <!-- Q12 SHORT -->
  <div class="q-card" id="q12">
    <div class="q-meta"><span class="q-num">Question 12</span><span class="q-type">Short Answer</span></div>
    <div class="q-text">What statistical technique is used to attack substitution ciphers by exploiting the fact that letters in natural language appear with different frequencies?</div>
    <div class="text-input-wrap">
      <input class="text-input" id="input12" placeholder="Name the attack technique‚Ä¶" onkeydown="if(event.key==='Enter') submitText('q12',['frequency analysis','frequency','statistical','letter frequency'],'Frequency Analysis','Frequency Analysis works because natural languages (like English) do NOT distribute letters uniformly. For example, E appears ~12.22% of the time, T ~9.67%, A ~8.05%, while Q and Z appear less than 0.1%. An attacker counts letter frequencies in the ciphertext and matches them to known language patterns. This breaks simple Caesar and monoalphabetic substitution ciphers even with millions of possible keys.')">
      <button class="submit-btn" onclick="submitText('q12',['frequency analysis','frequency','statistical','letter frequency'],'Frequency Analysis','Frequency Analysis works because natural languages (like English) do NOT distribute letters uniformly. For example, E appears ~12.22% of the time, T ~9.67%, A ~8.05%, while Q and Z appear less than 0.1%. An attacker counts letter frequencies in the ciphertext and matches them to known language patterns. This breaks simple Caesar and monoalphabetic substitution ciphers even with millions of possible keys.')">Submit</button>
    </div>
    <div class="feedback" id="fb12"></div>
  </div>

  <!-- Q13 MCQ -->
  <div class="q-card" id="q13">
    <div class="q-meta"><span class="q-num">Question 13</span><span class="q-type">Multiple Choice</span></div>
    <div class="q-text">The Playfair Cipher is more secure than a monoalphabetic cipher because it encrypts digrams (letter pairs). How many possible digrams are there?</div>
    <div class="options" id="opts13">
      <button class="option-btn" onclick="checkMCQ('q13','A','676','C')"><span class="opt-letter">A</span> 26 (same as monoalphabetic)</button>
      <button class="option-btn" onclick="checkMCQ('q13','B','676','C')"><span class="opt-letter">B</span> 52 (26 √ó 2)</button>
      <button class="option-btn" onclick="checkMCQ('q13','C','676','C')"><span class="opt-letter">C</span> 676 (26 √ó 26)</button>
      <button class="option-btn" onclick="checkMCQ('q13','D','676','C')"><span class="opt-letter">D</span> 1,352 (26 √ó 52)</button>
    </div>
    <div class="feedback" id="fb13"></div>
  </div>

  <!-- Q14 SHORT -->
  <div class="q-card" id="q14">
    <div class="q-meta"><span class="q-num">Question 14</span><span class="q-type">Short Answer</span></div>
    <div class="q-text">In the Playfair Cipher, what do you insert between two repeated letters in a plaintext pair? (E.g., what happens to "LL" in HELLO?)</div>
    <div class="text-input-wrap">
      <input class="text-input" id="input14" placeholder="What letter/character is inserted?" onkeydown="if(event.key==='Enter') submitText('q14',['x','filler','fill','bogus'],'A filler letter X is inserted (e.g., HELLO ‚Üí HE LX LO)','In Playfair, when a pair of plaintext letters are the same (e.g., LL in HELLO), you insert a filler letter ‚Äî typically X ‚Äî between them. HELLO becomes HE-LX-LO (three pairs) before encryption. This is one of the four Playfair rules. The other rules handle same-row pairs (shift right), same-column pairs (shift down), and the standard rectangle rule for all other pairs.')">
      <button class="submit-btn" onclick="submitText('q14',['x','filler','fill','bogus'],'A filler letter X is inserted (e.g., HELLO ‚Üí HE LX LO)','In Playfair, when a pair of plaintext letters are the same (e.g., LL in HELLO), you insert a filler letter ‚Äî typically X ‚Äî between them. HELLO becomes HE-LX-LO (three pairs) before encryption. This is one of the four Playfair rules. The other rules handle same-row pairs (shift right), same-column pairs (shift down), and the standard rectangle rule for all other pairs.')">Submit</button>
    </div>
    <div class="feedback" id="fb14"></div>
  </div>

  <!-- Q15 TF -->
  <div class="q-card" id="q15">
    <div class="q-meta"><span class="q-num">Question 15</span><span class="q-type">True / False</span></div>
    <div class="q-text">The <strong>One-Time Pad</strong> is the only type of substitution cipher that is theoretically <strong>unbreakable</strong>, because every ciphertext is equally likely for any plaintext.</div>
    <div class="tf-options">
      <button class="tf-btn tf-true" onclick="checkTF('q15', true, true, 'Correct! The One-Time Pad (invented in 1917 by Mauborgne and Vernam) is provably unbreakable. Since each shift key is chosen uniformly at random, every possible ciphertext is equally likely for any given plaintext. An attacker gains zero information from the ciphertext. The catch: the key must be as long as the message, used only once, and kept perfectly secret ‚Äî which makes it impractical for most real-world applications.')">‚úÖ True</button>
      <button class="tf-btn tf-false" onclick="checkTF('q15', false, true, 'Correct! The One-Time Pad (invented in 1917 by Mauborgne and Vernam) is provably unbreakable. Since each shift key is chosen uniformly at random, every possible ciphertext is equally likely for any given plaintext. An attacker gains zero information from the ciphertext. The catch: the key must be as long as the message, used only once, and kept perfectly secret ‚Äî which makes it impractical for most real-world applications.')">‚ùå False</button>
    </div>
    <div class="feedback" id="fb15"></div>
  </div>

  <!-- ========================= SECTION 3 ========================= -->
  <div class="section-divider">
    <div class="sec-icon g3">üîÄ</div>
    <div><h2>Transposition & Modern Block Ciphers</h2><p>Questions 16‚Äì22</p></div>
  </div>

  <!-- Q16 MCQ -->
  <div class="q-card" id="q16">
    <div class="q-meta"><span class="q-num">Question 16</span><span class="q-type">Multiple Choice</span></div>
    <div class="q-text">In a transposition cipher, what happens to the plaintext characters?</div>
    <div class="options" id="opts16">
      <button class="option-btn" onclick="checkMCQ('q16','A','positions changed','B')"><span class="opt-letter">A</span> Each character is replaced by a different character</button>
      <button class="option-btn" onclick="checkMCQ('q16','B','positions changed','B')"><span class="opt-letter">B</span> Characters retain their form but change their positions</button>
      <button class="option-btn" onclick="checkMCQ('q16','C','positions changed','B')"><span class="opt-letter">C</span> Characters are converted to numbers and scrambled</button>
      <button class="option-btn" onclick="checkMCQ('q16','D','positions changed','B')"><span class="opt-letter">D</span> Characters are deleted and replaced with symbols</button>
    </div>
    <div class="feedback" id="fb16"></div>
  </div>

  <!-- Q17 SHORT -->
  <div class="q-card" id="q17">
    <div class="q-meta"><span class="q-num">Question 17</span><span class="q-type">Short Answer</span></div>
    <div class="q-text">What are the two specific numbers associated with DES ‚Äî its block size and key size?</div>
    <div class="text-input-wrap">
      <input class="text-input" id="input17" placeholder="e.g., X-bit blocks and Y-bit keys‚Ä¶" onkeydown="if(event.key==='Enter') submitText('q17',['64','56'],'64-bit blocks and 56-bit keys','DES (Data Encryption Standard) was developed by IBM and adopted by NIST in 1977. It uses 64-bit plaintext blocks and a 56-bit key. The small 56-bit key space (only 2^56 = 7.2 √ó 10^16 possible keys) is the critical weakness ‚Äî exhaustive brute-force search became feasible in the late 1990s, making DES insecure for modern use. This led to Triple DES (3DES) and eventually AES.')">
      <button class="submit-btn" onclick="submitText('q17',['64','56'],'64-bit blocks and 56-bit keys','DES (Data Encryption Standard) was developed by IBM and adopted by NIST in 1977. It uses 64-bit plaintext blocks and a 56-bit key. The small 56-bit key space (only 2^56 = 7.2 √ó 10^16 possible keys) is the critical weakness ‚Äî exhaustive brute-force search became feasible in the late 1990s, making DES insecure for modern use. This led to Triple DES (3DES) and eventually AES.')">Submit</button>
    </div>
    <div class="feedback" id="fb17"></div>
  </div>

  <!-- Q18 MCQ -->
  <div class="q-card" id="q18">
    <div class="q-meta"><span class="q-num">Question 18</span><span class="q-type">Multiple Choice</span></div>
    <div class="q-text">Triple DES (3DES) uses the pattern Encrypt-Decrypt-Encrypt with three keys. What is its effective key length?</div>
    <div class="options" id="opts18">
      <button class="option-btn" onclick="checkMCQ('q18','A','168 bits','C')"><span class="opt-letter">A</span> 56 bits (same as DES)</button>
      <button class="option-btn" onclick="checkMCQ('q18','B','168 bits','C')"><span class="opt-letter">B</span> 112 bits</button>
      <button class="option-btn" onclick="checkMCQ('q18','C','168 bits','C')"><span class="opt-letter">C</span> 168 bits (3 √ó 56-bit keys)</button>
      <button class="option-btn" onclick="checkMCQ('q18','D','168 bits','C')"><span class="opt-letter">D</span> 256 bits</button>
    </div>
    <div class="feedback" id="fb18"></div>
  </div>

  <!-- Q19 TF -->
  <div class="q-card" id="q19">
    <div class="q-meta"><span class="q-num">Question 19</span><span class="q-type">True / False</span></div>
    <div class="q-text">AES (Advanced Encryption Standard) uses 128-bit blocks and supports key lengths of 128, 192, or 256 bits.</div>
    <div class="tf-options">
      <button class="tf-btn tf-true" onclick="checkTF('q19', true, true, 'Correct! AES was selected by NIST in 2001 through an open international competition. It uses 128-bit blocks with variable key lengths: 128, 192, or 256 bits. Unlike DES, an exhaustive search attack on AES is NOT currently feasible ‚Äî even the smallest 128-bit key space (2^128 ‚âà 3.4 √ó 10^38 keys) would take 5.4 √ó 10^24 years at 1 million decryptions per microsecond.')">‚úÖ True</button>
      <button class="tf-btn tf-false" onclick="checkTF('q19', false, true, 'Correct! AES was selected by NIST in 2001 through an open international competition. It uses 128-bit blocks with variable key lengths: 128, 192, or 256 bits. Unlike DES, an exhaustive search attack on AES is NOT currently feasible ‚Äî even the smallest 128-bit key space (2^128 ‚âà 3.4 √ó 10^38 keys) would take 5.4 √ó 10^24 years at 1 million decryptions per microsecond.')">‚ùå False</button>
    </div>
    <div class="feedback" id="fb19"></div>
  </div>

  <!-- Q20 MCQ -->
  <div class="q-card" id="q20">
    <div class="q-meta"><span class="q-num">Question 20</span><span class="q-type">Multiple Choice</span></div>
    <div class="q-text">When encrypting a block cipher, if the last block of plaintext is too short, what must be done?</div>
    <div class="options" id="opts20">
      <button class="option-btn" onclick="checkMCQ('q20','A','padding','B')"><span class="opt-letter">A</span> Discard the last block</button>
      <button class="option-btn" onclick="checkMCQ('q20','B','padding','B')"><span class="opt-letter">B</span> Add padding to fill the block to the required size</button>
      <button class="option-btn" onclick="checkMCQ('q20','C','padding','B')"><span class="opt-letter">C</span> Encrypt it as a stream cipher instead</button>
      <button class="option-btn" onclick="checkMCQ('q20','D','padding','B')"><span class="opt-letter">D</span> Repeat the previous block's ciphertext</button>
    </div>
    <div class="feedback" id="fb20"></div>
  </div>

  <!-- Q21 SHORT -->
  <div class="q-card" id="q21">
    <div class="q-meta"><span class="q-num">Question 21</span><span class="q-type">Short Answer</span></div>
    <div class="q-text">In <strong>CBC (Cipher Block Chaining)</strong> mode, what is the first block XOR'd with before encryption begins?</div>
    <div class="text-input-wrap">
      <input class="text-input" id="input21" placeholder="What is XOR'd with the first block?" onkeydown="if(event.key==='Enter') submitText('q21',['initialization vector','iv','init vector','vector'],'An Initialization Vector (IV)','In CBC mode, the first plaintext block P[0] is XOR\'d with an Initialization Vector (IV) before encryption: C[0] = Ek(IV ‚äï P[0]). For subsequent blocks, the previous ciphertext block is XOR\'d with the current plaintext: C[i] = Ek(C[i-1] ‚äï P[i]). The IV ensures that identical plaintexts produce different ciphertexts, which improves security. For decryption: P[i] = C[i-1] ‚äï Dk(C[i]).')">
      <button class="submit-btn" onclick="submitText('q21',['initialization vector','iv','init vector','vector'],'An Initialization Vector (IV)','In CBC mode, the first plaintext block P[0] is XOR\'d with an Initialization Vector (IV) before encryption: C[0] = Ek(IV ‚äï P[0]). For subsequent blocks, the previous ciphertext block is XOR\'d with the current plaintext: C[i] = Ek(C[i-1] ‚äï P[i]). The IV ensures that identical plaintexts produce different ciphertexts, which improves security. For decryption: P[i] = C[i-1] ‚äï Dk(C[i]).')">Submit</button>
    </div>
    <div class="feedback" id="fb21"></div>
  </div>

  <!-- Q22 MCQ -->
  <div class="q-card" id="q22">
    <div class="q-meta"><span class="q-num">Question 22</span><span class="q-type">Multiple Choice</span></div>
    <div class="q-text">Which block cipher mode can be performed in <strong>parallel</strong> and can recover from dropped blocks?</div>
    <div class="options" id="opts22">
      <button class="option-btn" onclick="checkMCQ('q22','A','CTR','D')"><span class="opt-letter">A</span> ECB (Electronic Code Book)</button>
      <button class="option-btn" onclick="checkMCQ('q22','B','CTR','D')"><span class="opt-letter">B</span> CBC (Cipher Block Chaining)</button>
      <button class="option-btn" onclick="checkMCQ('q22','C','CTR','D')"><span class="opt-letter">C</span> CFB (Cipher Feedback)</button>
      <button class="option-btn" onclick="checkMCQ('q22','D','CTR','D')"><span class="opt-letter">D</span> CTR (Counter Mode)</button>
    </div>
    <div class="feedback" id="fb22"></div>
  </div>

  <!-- ========================= SECTION 4 ========================= -->
  <div class="section-divider">
    <div class="sec-icon g4">üßÆ</div>
    <div><h2>Hill Cipher & Vigen√®re</h2><p>Questions 23‚Äì26</p></div>
  </div>

  <!-- Q23 MCQ -->
  <div class="q-card" id="q23">
    <div class="q-meta"><span class="q-num">Question 23</span><span class="q-type">Multiple Choice</span></div>
    <div class="q-text">The Hill Cipher's main strength over monoalphabetic ciphers is that it:</div>
    <div class="options" id="opts23">
      <button class="option-btn" onclick="checkMCQ('q23','A','hides frequencies','C')"><span class="opt-letter">A</span> Uses a longer key length</button>
      <button class="option-btn" onclick="checkMCQ('q23','B','hides frequencies','C')"><span class="opt-letter">B</span> Encrypts one letter at a time</button>
      <button class="option-btn" onclick="checkMCQ('q23','C','hides frequencies','C')"><span class="opt-letter">C</span> Completely hides single-letter frequencies, making it secure against ciphertext-only attacks</button>
      <button class="option-btn" onclick="checkMCQ('q23','D','hides frequencies','C')"><span class="opt-letter">D</span> Uses the same key for encryption and decryption without matrix math</button>
    </div>
    <div class="feedback" id="fb23"></div>
  </div>

  <!-- Q24 SHORT -->
  <div class="q-card" id="q24">
    <div class="q-meta"><span class="q-num">Question 24</span><span class="q-type">Short Answer</span></div>
    <div class="q-text">In the Hill Cipher, what mathematical operation is used to <strong>decrypt</strong>? (What key is used instead of the original key matrix K?)</div>
    <div class="text-input-wrap">
      <input class="text-input" id="input24" placeholder="What is used to decrypt?" onkeydown="if(event.key==='Enter') submitText('q24',['inverse','k inverse','k-1','inverse matrix','k^-1'],'The inverse of the key matrix K‚Åª¬π','Hill Cipher decryption uses the inverse of the key matrix: P = Dk(C) = K‚Åª¬πC mod 26. The inverse key K‚Åª¬π satisfies KK‚Åª¬π = K‚Åª¬πK = I (identity matrix). To find K‚Åª¬π: calculate the determinant, find the adjugate (adjoint) matrix, then multiply: K‚Åª¬π = det‚Åª¬π √ó Adj(K) mod 26. A larger matrix key hides more frequency information, making the cipher stronger.')">
      <button class="submit-btn" onclick="submitText('q24',['inverse','k inverse','k-1','inverse matrix','k^-1'],'The inverse of the key matrix K‚Åª¬π','Hill Cipher decryption uses the inverse of the key matrix: P = Dk(C) = K‚Åª¬πC mod 26. The inverse key K‚Åª¬π satisfies KK‚Åª¬π = K‚Åª¬πK = I (identity matrix). To find K‚Åª¬π: calculate the determinant, find the adjugate (adjoint) matrix, then multiply: K‚Åª¬π = det‚Åª¬π √ó Adj(K) mod 26. A larger matrix key hides more frequency information, making the cipher stronger.')">Submit</button>
    </div>
    <div class="feedback" id="fb24"></div>
  </div>

  <!-- Q25 MCQ -->
  <div class="q-card" id="q25">
    <div class="q-meta"><span class="q-num">Question 25</span><span class="q-type">Multiple Choice</span></div>
    <div class="q-text">In the Vigen√®re Cipher, if the keyword is shorter than the plaintext, what happens?</div>
    <div class="options" id="opts25">
      <button class="option-btn" onclick="checkMCQ('q25','A','repeated','B')"><span class="opt-letter">A</span> The cipher stops encrypting after the keyword ends</button>
      <button class="option-btn" onclick="checkMCQ('q25','B','repeated','B')"><span class="opt-letter">B</span> The keyword is repeated to match the plaintext length</button>
      <button class="option-btn" onclick="checkMCQ('q25','C','repeated','B')"><span class="opt-letter">C</span> The remaining letters are encrypted with a Caesar shift of 0</button>
      <button class="option-btn" onclick="checkMCQ('q25','D','repeated','B')"><span class="opt-letter">D</span> A new random keyword is generated for the remaining letters</button>
    </div>
    <div class="feedback" id="fb25"></div>
  </div>

  <!-- Q26 TF -->
  <div class="q-card" id="q26">
    <div class="q-meta"><span class="q-num">Question 26</span><span class="q-type">True / False</span></div>
    <div class="q-text">In the Hill Cipher example from the slides, encrypting "july" with key matrix [11 8 / 3 7] gives the ciphertext "DELW".</div>
    <div class="tf-options">
      <button class="tf-btn tf-true" onclick="checkTF('q26', true, true, 'Correct! The example from the slides: j=9, u=20 ‚Üí C‚ÇÅ = (9,20)√ó[11 8/3 7] = (99+60, 72+140) = (159,212) = (3,4) mod 26 = D,E. l=11, y=24 ‚Üí C‚ÇÇ = (11,24)√ó[11 8/3 7] = (121+72, 88+168) = (193,256) = (11,22) mod 26 = L,W. So DELW is correct! Each pair of plaintext letters is multiplied by the key matrix and reduced mod 26.')">‚úÖ True</button>
      <button class="tf-btn tf-false" onclick="checkTF('q26', false, true, 'Correct! The example from the slides: j=9, u=20 ‚Üí C‚ÇÅ = (9,20)√ó[11 8/3 7] = (99+60, 72+140) = (159,212) = (3,4) mod 26 = D,E. l=11, y=24 ‚Üí C‚ÇÇ = (11,24)√ó[11 8/3 7] = (121+72, 88+168) = (193,256) = (11,22) mod 26 = L,W. So DELW is correct! Each pair of plaintext letters is multiplied by the key matrix and reduced mod 26.')">‚ùå False</button>
    </div>
    <div class="feedback" id="fb26"></div>
  </div>

  <!-- ========================= SECTION 5 ========================= -->
  <div class="section-divider">
    <div class="sec-icon g1">‚öîÔ∏è</div>
    <div><h2>Cryptanalysis Attacks & Brute Force</h2><p>Questions 27‚Äì30</p></div>
  </div>

  <!-- Q27 MCQ -->
  <div class="q-card" id="q27">
    <div class="q-meta"><span class="q-num">Question 27</span><span class="q-type">Multiple Choice</span></div>
    <div class="q-text">In a <strong>Chosen Plaintext Attack</strong>, what advantage does the attacker have over a Known Plaintext Attack?</div>
    <div class="options" id="opts27">
      <button class="option-btn" onclick="checkMCQ('q27','A','can choose','C')"><span class="opt-letter">A</span> The attacker has only ciphertext and no plaintext</button>
      <button class="option-btn" onclick="checkMCQ('q27','B','can choose','C')"><span class="opt-letter">B</span> The attacker already knows the secret key</button>
      <button class="option-btn" onclick="checkMCQ('q27','C','can choose','C')"><span class="opt-letter">C</span> The attacker can choose their own plaintexts to encrypt and observe the resulting ciphertexts</button>
      <button class="option-btn" onclick="checkMCQ('q27','D','can choose','C')"><span class="opt-letter">D</span> The attacker can only observe communications, not interact with the system</button>
    </div>
    <div class="feedback" id="fb27"></div>
  </div>

  <!-- Q28 SHORT -->
  <div class="q-card" id="q28">
    <div class="q-meta"><span class="q-num">Question 28</span><span class="q-type">Short Answer</span></div>
    <div class="q-scenario">Scenario: An attacker intercepts several encrypted messages between Alice and Bob. The attacker has ONLY the ciphertext ‚Äî no plaintext, no ability to encrypt or decrypt their own messages. What type of attack is this?</div>
    <div class="text-input-wrap">
      <input class="text-input" id="input28" placeholder="Name the attack type‚Ä¶" onkeydown="if(event.key==='Enter') submitText('q28',['ciphertext only','ciphertext-only','ciphertext only attack'],'Ciphertext Only Attack','A Ciphertext Only Attack is the weakest form of attack in terms of information available to the attacker. The attacker has: C1=Ek(P1), C2=Ek(P2), etc., but does NOT know any of the plaintexts. Their goal is to deduce the key K and/or the plaintexts P1, P2,... This is also the most difficult attack for the cryptanalyst. Frequency analysis is one tool used in ciphertext-only attacks against simple substitution ciphers.')">
      <button class="submit-btn" onclick="submitText('q28',['ciphertext only','ciphertext-only','ciphertext only attack'],'Ciphertext Only Attack','A Ciphertext Only Attack is the weakest form of attack in terms of information available to the attacker. The attacker has: C1=Ek(P1), C2=Ek(P2), etc., but does NOT know any of the plaintexts. Their goal is to deduce the key K and/or the plaintexts P1, P2,... This is also the most difficult attack for the cryptanalyst. Frequency analysis is one tool used in ciphertext-only attacks against simple substitution ciphers.')">Submit</button>
    </div>
    <div class="feedback" id="fb28"></div>
  </div>

  <!-- Q29 MCQ -->
  <div class="q-card" id="q29">
    <div class="q-meta"><span class="q-num">Question 29</span><span class="q-type">Multiple Choice</span></div>
    <div class="q-text">Based on the brute force table from the slides, approximately how long would it take to break a 56-bit DES key at 1 million decryptions per microsecond?</div>
    <div class="options" id="opts29">
      <button class="option-btn" onclick="checkMCQ('q29','A','10 hours','C')"><span class="opt-letter">A</span> About 35 minutes</button>
      <button class="option-btn" onclick="checkMCQ('q29','B','10 hours','C')"><span class="opt-letter">B</span> About 2 milliseconds</button>
      <button class="option-btn" onclick="checkMCQ('q29','C','10 hours','C')"><span class="opt-letter">C</span> About 10 hours</button>
      <button class="option-btn" onclick="checkMCQ('q29','D','10 hours','C')"><span class="opt-letter">D</span> About 1,142 years</button>
    </div>
    <div class="feedback" id="fb29"></div>
  </div>

  <!-- Q30 SHORT -->
  <div class="q-card" id="q30">
    <div class="q-meta"><span class="q-num">Question 30</span><span class="q-type">Short Answer</span></div>
    <div class="q-text">In a <strong>Chosen Ciphertext Attack</strong>, what is the ultimate goal of the attacker ‚Äî what are they trying to find?</div>
    <div class="text-input-wrap">
      <input class="text-input" id="input30" placeholder="What is the attacker's goal?" onkeydown="if(event.key==='Enter') submitText('q30',['key','secret key','the key','find key','deduce key','recover key'],'The secret key K','In a Chosen Ciphertext Attack, the attacker can choose their own ciphertexts to be decrypted (they have access to a decryption oracle or box). They observe pairs: C1,P1=Dk(C1), C2,P2=Dk(C2), etc. The goal is to deduce the KEY K ‚Äî not just the plaintexts. This is the most powerful cryptanalytic attack. Note: the objective in ALL cryptanalytic attacks is ultimately to recover the key, since with the key, ALL past and future ciphertexts can be decrypted.')">
      <button class="submit-btn" onclick="submitText('q30',['key','secret key','the key','find key','deduce key','recover key'],'The secret key K','In a Chosen Ciphertext Attack, the attacker can choose their own ciphertexts to be decrypted (they have access to a decryption oracle or box). They observe pairs: C1,P1=Dk(C1), C2,P2=Dk(C2), etc. The goal is to deduce the KEY K ‚Äî not just the plaintexts. This is the most powerful cryptanalytic attack. Note: the objective in ALL cryptanalytic attacks is ultimately to recover the key, since with the key, ALL past and future ciphertexts can be decrypted.')">Submit</button>
    </div>
    <div class="feedback" id="fb30"></div>
  </div>

  <div id="finish-wrap">
    <button class="finish-btn" onclick="showResults()">üèÅ Submit Quiz & See Results</button>
  </div>

  <div id="results-screen">
    <div class="results-card">
      <div class="score-circle">
        <div class="score-big" id="res-score">0</div>
        <div class="score-denom" id="res-denom">/ 30</div>
      </div>
      <div class="grade-badge" id="res-badge">‚Äî</div>
      <h2 id="res-title">‚Äî</h2>
      <p id="res-msg">‚Äî</p>
      <div class="results-stats">
        <div class="stat-box">
          <div class="stat-num green" id="res-correct">0</div>
          <div class="stat-label">Correct</div>
        </div>
        <div class="stat-box">
          <div class="stat-num red" id="res-wrong">0</div>
          <div class="stat-label">Wrong</div>
        </div>
        <div class="stat-box">
          <div class="stat-num blue" id="res-pct">0%</div>
          <div class="stat-label">Score</div>
        </div>
      </div>
      <button class="restart-btn" onclick="restartQuiz()">üîÑ Try Again</button>
    </div>
  </div>

</main>

<footer>
  <div style="font-family:'Syne',sans-serif;font-size:1.05rem;font-weight:800;background:var(--grad1);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;margin-bottom:5px;">Shoug Alomran</div>
  <div>Chapter 5 ‚Äî Cryptography Quiz ¬∑ Keyword-Graded with Explanations</div>
  <div style="margin-top:4px;opacity:0.5;font-size:12px;">Auto Dark/Light Mode ¬∑ 30 Questions</div>
</footer>

<script>
  const TOTAL = 30;
  let answered = 0;
  let score = 0;
  const answeredSet = new Set();

  function updateProgress() {
    const pct = (answered / TOTAL) * 100;
    document.getElementById('progress-bar').style.width = pct + '%';
    document.getElementById('progress-label').textContent = answered + ' / ' + TOTAL;
    document.getElementById('score-pill').textContent = 'Score: ' + score;
  }

  function recordAnswer(qId, isCorrect) {
    if (answeredSet.has(qId)) return false;
    answeredSet.add(qId);
    answered++;
    if (isCorrect) score++;
    updateProgress();
    return true;
  }

  function checkMCQ(qId, chosen, correctLabel, correctLetter) {
    const card = document.getElementById(qId);
    const buttons = card.querySelectorAll('.option-btn');
    if (!recordAnswer(qId, chosen === correctLetter)) return;
    const isCorrect = chosen === correctLetter;
    card.classList.add(isCorrect ? 'answered-correct' : 'answered-wrong');
    buttons.forEach((btn, i) => {
      btn.disabled = true;
      const letter = ['A','B','C','D'][i];
      if (letter === correctLetter && !isCorrect) btn.classList.add('show-correct');
    });
    const chosenBtn = buttons[['A','B','C','D'].indexOf(chosen)];
    chosenBtn.classList.add(isCorrect ? 'selected-correct' : 'selected-wrong');

    const explanations = {
      'q1': 'Option C is correct. Cryptography can protect Confidentiality (by making data unreadable to unauthorized parties) and Integrity (by detecting unauthorized changes). It CANNOT protect Availability ‚Äî a denial-of-service attack can make encrypted data inaccessible regardless of how strong the encryption is.',
      'q4': 'Option B is correct. In symmetric encryption, the same secret key K is used for both encryption and decryption. The mathematical property is Dk(Ek(P)) = P ‚Äî applying decryption after encryption returns the original plaintext. Plaintext length is typically the SAME as ciphertext length, not shorter.',
      'q6': 'Option D is correct. The three classification dimensions from the slides are: (1) Number of keys (symmetric vs asymmetric), (2) Type of operation (substitution or transposition), (3) Way plaintext is processed (block vs stream). The length of the plaintext message is NOT one of the three classification dimensions.',
      'q8': 'Option A is correct. En(x) = (x + n) mod 26. For "a" (position 0) with n=14: E14(0) = (0 + 14) mod 26 = 14, which corresponds to the letter "O" (A=0, B=1, ..., O=14). The slides confirm this: E(a)=1+14 mod 26 = 15... wait, note the slides use 1-indexed ‚Äî but position 14 maps to O.',
      'q11': 'Option B is correct. In a Keyword Cipher, the first step is to remove all repeated (duplicate) letters from the keyword. For "PSU IS MY CHOICE": keeping only unique letters in order gives P,S,U,I,M,Y,C,H,O,E. Then the remaining alphabet letters are appended in order. This creates the substitution table.',
      'q13': 'Option C is correct. A digram is a pair of letters. With 26 letters in the alphabet, there are 26 √ó 26 = 676 possible digrams. This means a frequency analysis attack would need a 676-entry frequency table instead of just 26. Combined with much more ciphertext needed, Playfair provides significantly better security ‚Äî though it was still eventually broken in WW1.',
      'q16': 'Option B is correct. In a transposition (permutation) cipher, the characters RETAIN their plaintext form ‚Äî the actual letters do not change. Only their POSITIONS change. The text is organized into a 2D table and columns are rearranged according to a key. This is different from substitution where characters are replaced.',
      'q18': 'Option C is correct. 3DES uses three separate 56-bit DES keys (KA, KB, KC) giving 3 √ó 56 = 168 bits total. The operation is: C = Ekc(Dkb(Eka(P))). Note: the "true" cryptographic strength is considered 112 bits due to meet-in-the-middle attacks, but the nominal key length is 168 bits. It is backward compatible with DES when KA=KB=KC.',
      'q20': 'Option B is correct. Block ciphers require the plaintext length n to be a multiple of the block size b. When the last block is too short, it must be padded. Importantly, padding must be unambiguous ‚Äî you cannot just add zeros. The slides give an example: "Roberto" (7 bytes) becomes "Roberto9" (8 bytes for a 64-bit/8-byte block), where 9 indicates 1 byte of padding was added.',
      'q22': 'Option D is correct. CTR (Counter Mode) can be performed in PARALLEL because each block uses an independent counter value Vi = Ek(s + i - 1). Unlike CBC or CFB, CTR does not chain blocks, so any block can be encrypted/decrypted independently. This also means it can recover from dropped blocks, which chaining modes cannot.',
      'q23': 'Option C is correct. The Hill Cipher\'s key strength is that it completely hides single-letter frequencies, making it secure against ciphertext-only (frequency analysis) attacks. A larger key matrix hides more frequency information. This is because each ciphertext letter depends on multiple plaintext letters simultaneously through matrix multiplication.',
      'q25': 'Option B is correct. In the Vigen√®re Cipher, the keyword is repeated as many times as needed to match the length of the plaintext. Example from slides: keyword "AYUSH" (5 letters) repeated to match 13-letter plaintext "GEEKSFORGEEKS" becomes "AYUSHAYUSHAYU". The key column intersects with the plaintext row in the Vigen√®re square to produce each cipher letter.',
      'q27': 'Option C is correct. In a Known Plaintext Attack, the attacker has some plaintext-ciphertext pairs but cannot control which ones. In a Chosen Plaintext Attack, the attacker can CHOOSE which plaintexts to encrypt ‚Äî giving them much more power to probe the cipher. This is possible when the attacker has access to an encryption box or can submit plaintexts to the key owner for encryption.',
      'q29': 'Option C is correct. From the brute force table in the slides: for a 56-bit DES key at 10^6 decryptions/¬µs, the time required is 10.01 hours. At just 1 decryption/¬µs it would be 2^55 ¬µs ‚âà 1,142 years. At 1 million/¬µs it shrinks to ~10 hours ‚Äî which is why DES is considered broken. Compare: AES-128 at 1 million/¬µs would still take 5.4 √ó 10^18 years!',
    };

    showFeedback(
      'fb' + qId.replace('q',''),
      isCorrect,
      isCorrect ? '‚úÖ Correct! ' + correctLabel : '‚ùå Wrong. The correct answer is: ' + correctLabel,
      isCorrect ? '' : (explanations[qId] || '')
    );
  }

  function checkTF(qId, userAnswer, correctAnswer, explanation) {
    const card = document.getElementById(qId);
    const btns = card.querySelectorAll('.tf-btn');
    if (!recordAnswer(qId, userAnswer === correctAnswer)) return;
    const isCorrect = userAnswer === correctAnswer;
    card.classList.add(isCorrect ? 'answered-correct' : 'answered-wrong');
    btns.forEach(btn => { btn.disabled = true; });
    const trueBtn = card.querySelector('.tf-true');
    const falseBtn = card.querySelector('.tf-false');
    if (isCorrect) {
      (userAnswer ? trueBtn : falseBtn).classList.add('selected-correct');
    } else {
      (userAnswer ? trueBtn : falseBtn).classList.add('selected-wrong');
      (correctAnswer ? trueBtn : falseBtn).classList.add('show-correct');
    }
    showFeedback(
      'fb' + qId.replace('q',''),
      isCorrect,
      isCorrect ? '‚úÖ Correct!' : '‚ùå False ‚Äî this statement is incorrect.',
      isCorrect ? 'Well done! Your reasoning is right.' : explanation
    );
  }

  function submitText(qId, keywords, correctLabel, explanation) {
    const num = qId.replace('q','');
    const input = document.getElementById('input' + num);
    const val = input.value.trim().toLowerCase();
    if (!val) return;
    if (answeredSet.has(qId)) return;
    const card = document.getElementById(qId);
    const btn = input.nextElementSibling;
    const matched = keywords.some(kw => val.includes(kw.toLowerCase()));
    recordAnswer(qId, matched);
    input.disabled = true;
    btn.disabled = true;
    input.classList.add(matched ? 'correct-input' : 'wrong-input');
    card.classList.add(matched ? 'answered-correct' : 'answered-wrong');
    showFeedback(
      'fb' + num,
      matched,
      matched ? '‚úÖ Correct!' : '‚ùå Not quite.',
      matched
        ? explanation
        : 'üìå The expected answer was: <strong>' + correctLabel + '</strong><br><br>' + explanation
    );
  }

  function showFeedback(fbId, isCorrect, headline, body) {
    const fb = document.getElementById(fbId);
    fb.className = 'feedback show ' + (isCorrect ? 'correct-fb' : 'wrong-fb');
    fb.innerHTML = `<div class="fb-header ${isCorrect ? 'correct-h' : 'wrong-h'}">${headline}</div><div class="fb-body">${body}</div>`;
  }

  function showResults() {
    document.getElementById('finish-wrap').style.display = 'none';
    const rs = document.getElementById('results-screen');
    rs.style.display = 'block';
    rs.scrollIntoView({ behavior: 'smooth', block: 'start' });
    const pct = Math.round((score / TOTAL) * 100);
    document.getElementById('res-score').textContent = score;
    document.getElementById('res-denom').textContent = '/ ' + TOTAL;
    document.getElementById('res-correct').textContent = score;
    document.getElementById('res-wrong').textContent = answered - score;
    document.getElementById('res-pct').textContent = pct + '%';
    let grade, title, msg, color;
    if (pct >= 90) {
      grade='A+'; title='Outstanding! üéâ'; msg='You have mastered Chapter 5 Cryptography. Excellent work!'; color='var(--grad3)';
    } else if (pct >= 80) {
      grade='A'; title='Great Work! üåü'; msg='Strong understanding of ciphers and attacks. Review any missed questions and you\'re exam-ready.'; color='var(--grad1)';
    } else if (pct >= 70) {
      grade='B'; title='Good Job! üëç'; msg='Solid grasp of the basics. Focus on block cipher modes and attack types.'; color='var(--grad3)';
    } else if (pct >= 60) {
      grade='C'; title='Keep Studying üìö'; msg='You know some concepts but need more review ‚Äî especially classical ciphers and brute force tables.'; color='var(--grad4)';
    } else {
      grade='F'; title='More Study Needed üí™'; msg='Go back to the study guide and review each section carefully, then try again!'; color='var(--grad2)';
    }
    const badge = document.getElementById('res-badge');
    badge.textContent = grade;
    badge.style.background = color;
    document.getElementById('res-title').textContent = title;
    document.getElementById('res-msg').textContent = msg;
    document.querySelector('.score-circle').style.background = color;
  }

  function restartQuiz() { location.reload(); }
  updateProgress();
</script>
</body>
</html>