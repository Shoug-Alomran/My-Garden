<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CS330 Chapter 6 Exam</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2em;
            margin-bottom: 10px;
        }
        
        .header p {
            opacity: 0.9;
            font-size: 1.1em;
        }
        
        .exam-info {
            background: #f8f9fa;
            padding: 20px 30px;
            border-bottom: 3px solid #f093fb;
        }
        
        .exam-info div {
            display: inline-block;
            margin-right: 30px;
            font-weight: 600;
        }
        
        .content {
            padding: 30px;
        }
        
        .section {
            margin-bottom: 40px;
        }
        
        .section-header {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            font-size: 1.3em;
            font-weight: 600;
        }
        
        .question {
            background: #f8f9fa;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 10px;
            border-left: 4px solid #f093fb;
        }
        
        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        
        .question-number {
            font-weight: 700;
            color: #f5576c;
            font-size: 1.1em;
        }
        
        .question-marks {
            background: #f5576c;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9em;
        }
        
        .past-exam-tag {
            background: #28a745;
            color: white;
            padding: 3px 10px;
            border-radius: 15px;
            font-size: 0.8em;
            margin-left: 10px;
        }
        
        .question-text {
            margin-bottom: 15px;
            line-height: 1.6;
            color: #333;
        }
        
        .options {
            margin-left: 0;
        }
        
        .option {
            margin: 10px 0;
            padding: 12px 15px;
            background: white;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            border: 2px solid transparent;
        }
        
        .option:hover {
            background: #fff5f7;
            border-color: #f093fb;
        }
        
        .option input[type="radio"] {
            margin-right: 12px;
            cursor: pointer;
            width: 18px;
            height: 18px;
            flex-shrink: 0;
        }
        
        .option-text {
            flex: 1;
            line-height: 1.5;
        }
        
        .answer-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-family: inherit;
            font-size: 1em;
            transition: border-color 0.3s;
        }
        
        .answer-input:focus {
            outline: none;
            border-color: #f093fb;
        }
        
        textarea.answer-input {
            min-height: 120px;
            resize: vertical;
        }
        
        .code-block {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            overflow-x: auto;
            margin: 15px 0;
        }
        
        .submit-btn {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 15px 40px;
            border: none;
            border-radius: 25px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            display: block;
            margin: 30px auto;
            transition: transform 0.3s;
        }
        
        .submit-btn:hover {
            transform: scale(1.05);
        }
        
        .results {
            display: none;
            background: #f8f9fa;
            padding: 30px;
            border-radius: 15px;
            margin-top: 30px;
        }
        
        .results.show {
            display: block;
        }
        
        .score-display {
            text-align: center;
            font-size: 2em;
            margin-bottom: 30px;
            padding: 20px;
            background: white;
            border-radius: 10px;
        }
        
        .score-display .score {
            color: #f5576c;
            font-weight: 700;
            font-size: 1.5em;
        }
        
        .feedback {
            margin-top: 15px;
            padding: 15px;
            border-radius: 8px;
        }
        
        .feedback.correct {
            background: #d4edda;
            border-left: 4px solid #28a745;
        }
        
        .feedback.incorrect {
            background: #f8d7da;
            border-left: 4px solid #dc3545;
        }
        
        .feedback.partial {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
        }
        
        .feedback-title {
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .keywords-found {
            color: #28a745;
            font-weight: 600;
        }
        
        .keywords-missing {
            color: #dc3545;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîí CS330: Operating Systems</h1>
            <p>Chapter 6: Process Synchronization - Comprehensive Exam</p>
        </div>
        
        <div class="exam-info">
            <div>‚è±Ô∏è Duration: 90 minutes</div>
            <div>üìä Total Marks: 50</div>
            <div>üìù Questions: 14</div>
        </div>
        
        <div class="content">
            <form id="examForm">
                <!-- Section 1: Multiple Choice Questions -->
                <div class="section">
                    <div class="section-header">Section 1: Multiple Choice Questions (20 Marks)</div>
                    
                    <!-- Question 1 -->
                    <div class="question">
                        <div class="question-header">
                            <span class="question-number">Question 1 <span class="past-exam-tag">Past Exam</span></span>
                            <span class="question-marks">2 Marks</span>
                        </div>
                        <div class="question-text">
                            What is the primary purpose of Peterson's solution in the context of process synchronization?
                        </div>
                        <div class="options">
                            <label class="option">
                                <input type="radio" name="q1" value="a">
                                <span class="option-text">a) To optimize the performance of parallel algorithms</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q1" value="b">
                                <span class="option-text">b) To prevent deadlock in interprocess communication</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q1" value="c">
                                <span class="option-text">c) To prevent deadlock in more than two concurrent processes</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q1" value="d">
                                <span class="option-text">d) To ensure the orderly execution of processes in their critical sections</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- Question 2 -->
                    <div class="question">
                        <div class="question-header">
                            <span class="question-number">Question 2 <span class="past-exam-tag">Past Exam</span></span>
                            <span class="question-marks">2 Marks</span>
                        </div>
                        <div class="question-text">
                            How are counting semaphores utilized to control resource access?
                        </div>
                        <div class="options">
                            <label class="option">
                                <input type="radio" name="q2" value="a">
                                <span class="option-text">a) By setting the semaphore value to the number of available resources</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q2" value="b">
                                <span class="option-text">b) By initializing the semaphore to 1</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q2" value="c">
                                <span class="option-text">c) By performing a wait() operation to increment the count</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q2" value="d">
                                <span class="option-text">d) By performing a signal() operation to decrement the count</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- Question 3 -->
                    <div class="question">
                        <div class="question-header">
                            <span class="question-number">Question 3 <span class="past-exam-tag">Past Exam</span></span>
                            <span class="question-marks">2 Marks</span>
                        </div>
                        <div class="question-text">
                            How can we prevent deadlock in the Dining Philosophers problem using semaphores?
                        </div>
                        <div class="options">
                            <label class="option">
                                <input type="radio" name="q3" value="a">
                                <span class="option-text">a) By allowing philosophers to pick up any two forks simultaneously</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q3" value="b">
                                <span class="option-text">b) By limiting the number of philosophers in the dining room at any given time</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q3" value="c">
                                <span class="option-text">c) By using semaphores and carefully managing the order in which philosophers can pick up forks</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q3" value="d">
                                <span class="option-text">d) By ensuring their philosophers always wait for a signal before picking up any forks</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- Question 4 -->
                    <div class="question">
                        <div class="question-header">
                            <span class="question-number">Question 4 <span class="past-exam-tag">Past Exam</span></span>
                            <span class="question-marks">2 Marks</span>
                        </div>
                        <div class="question-text">
                            How can race conditions be mitigated in an operating system?
                        </div>
                        <div class="options">
                            <label class="option">
                                <input type="radio" name="q4" value="a">
                                <span class="option-text">a) By avoiding the use of shared resources altogether</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q4" value="b">
                                <span class="option-text">b) By introducing priority scheduling for processes</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q4" value="c">
                                <span class="option-text">c) By increasing the overall system clock speed</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q4" value="d">
                                <span class="option-text">d) By implementing mutual exclusion mechanisms such as locks or semaphores</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- Question 5 -->
                    <div class="question">
                        <div class="question-header">
                            <span class="question-number">Question 5 <span class="past-exam-tag">Past Exam</span></span>
                            <span class="question-marks">2 Marks</span>
                        </div>
                        <div class="question-text">
                            What is a semaphore in operating systems?
                        </div>
                        <div class="options">
                            <label class="option">
                                <input type="radio" name="q5" value="a">
                                <span class="option-text">a) A variable or abstract data type used to control access to a common resource</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q5" value="b">
                                <span class="option-text">b) A process scheduling algorithm</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q5" value="c">
                                <span class="option-text">c) A type of hardware interrupt</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q5" value="d">
                                <span class="option-text">d) A type of memory management scheme</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- Question 6 -->
                    <div class="question">
                        <div class="question-header">
                            <span class="question-number">Question 6 <span class="past-exam-tag">Past Exam</span></span>
                            <span class="question-marks">2 Marks</span>
                        </div>
                        <div class="question-text">
                            Which condition must be met for deadlock to occur?
                        </div>
                        <div class="options">
                            <label class="option">
                                <input type="radio" name="q6" value="a">
                                <span class="option-text">a) Mutual exclusion, hold and wait, no preemption, circular wait</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q6" value="b">
                                <span class="option-text">b) Mutual exclusion only</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q6" value="c">
                                <span class="option-text">c) Circular wait only</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q6" value="d">
                                <span class="option-text">d) No preemption only</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- Question 7 -->
                    <div class="question">
                        <div class="question-header">
                            <span class="question-number">Question 7 <span class="past-exam-tag">Past Exam</span></span>
                            <span class="question-marks">2 Marks</span>
                        </div>
                        <div class="question-text">
                            What does a semaphore initialized to 1 typically represent?
                        </div>
                        <div class="options">
                            <label class="option">
                                <input type="radio" name="q7" value="a">
                                <span class="option-text">a) A mutex lock</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q7" value="b">
                                <span class="option-text">b) A counting semaphore</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q7" value="c">
                                <span class="option-text">c) A deadlock state</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q7" value="d">
                                <span class="option-text">d) An unlocked state</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- Question 8 -->
                    <div class="question">
                        <div class="question-header">
                            <span class="question-number">Question 8 <span class="past-exam-tag">Past Exam</span></span>
                            <span class="question-marks">2 Marks</span>
                        </div>
                        <div class="question-text">
                            What is mutual exclusion?
                        </div>
                        <div class="options">
                            <label class="option">
                                <input type="radio" name="q8" value="a">
                                <span class="option-text">a) Allowing multiple processes to access a resource simultaneously</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q8" value="b">
                                <span class="option-text">b) Ensuring only one process accesses a critical section at a time</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q8" value="c">
                                <span class="option-text">c) Fair CPU allocation</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q8" value="d">
                                <span class="option-text">d) Avoiding deadlocks</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- Question 9 -->
                    <div class="question">
                        <div class="question-header">
                            <span class="question-number">Question 9 <span class="past-exam-tag">Past Exam</span></span>
                            <span class="question-marks">2 Marks</span>
                        </div>
                        <div class="question-text">
                            Which is NOT a condition necessary for deadlock?
                        </div>
                        <div class="options">
                            <label class="option">
                                <input type="radio" name="q9" value="a">
                                <span class="option-text">a) Mutual exclusion</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q9" value="b">
                                <span class="option-text">b) Circular wait</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q9" value="c">
                                <span class="option-text">c) Resource preemption</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q9" value="d">
                                <span class="option-text">d) Hold and wait</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- Question 10 -->
                    <div class="question">
                        <div class="question-header">
                            <span class="question-number">Question 10 <span class="past-exam-tag">Past Exam</span></span>
                            <span class="question-marks">2 Marks</span>
                        </div>
                        <div class="question-text">
                            In the context of process synchronization, what is busy waiting?
                        </div>
                        <div class="options">
                            <label class="option">
                                <input type="radio" name="q10" value="a">
                                <span class="option-text">a) Waiting by continuously checking a condition without releasing CPU</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q10" value="b">
                                <span class="option-text">b) Waiting by blocking the process</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q10" value="c">
                                <span class="option-text">c) Waiting with a timeout</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q10" value="d">
                                <span class="option-text">d) Waiting by yielding the CPU</span>
                            </label>
                        </div>
                    </div>
                </div>
                
                <!-- Section 2: Short Answer Questions -->
                <div class="section">
                    <div class="section-header">Section 2: Short Answer Questions (18 Marks)</div>
                    
                    <!-- Question 11 -->
                    <div class="question">
                        <div class="question-header">
                            <span class="question-number">Question 11 <span class="past-exam-tag">Past Exam</span></span>
                            <span class="question-marks">4 Marks</span>
                        </div>
                        <div class="question-text">
                            What does it mean for a solution to the critical section problem to satisfy the condition of mutual exclusion for two processes P1 and P2? Also, explain why disabling interrupts cannot be a general solution to the critical section problem (give two reasons).
                        </div>
                        <textarea class="answer-input" name="q11" placeholder="Enter your answer here..."></textarea>
                    </div>
                    
                    <!-- Question 12 -->
                    <div class="question">
                        <div class="question-header">
                            <span class="question-number">Question 12 <span class="past-exam-tag">Past Exam</span></span>
                            <span class="question-marks">5 Marks</span>
                        </div>
                        <div class="question-text">
                            What is the producer-consumer problem? Describe how semaphores can be used to solve this problem. Include the semaphores needed and their initial values.
                        </div>
                        <textarea class="answer-input" name="q12" placeholder="Enter your answer here..."></textarea>
                    </div>
                    
                    <!-- Question 13 -->
                    <div class="question">
                        <div class="question-header">
                            <span class="question-number">Question 13</span>
                            <span class="question-marks">5 Marks</span>
                        </div>
                        <div class="question-text">
                            Explain the three requirements that any solution to the critical section problem must satisfy: Mutual Exclusion, Progress, and Bounded Waiting.
                        </div>
                        <textarea class="answer-input" name="q13" placeholder="Enter your answer here..."></textarea>
                    </div>
                    
                    <!-- Question 14 -->
                    <div class="question">
                        <div class="question-header">
                            <span class="question-number">Question 14</span>
                            <span class="question-marks">4 Marks</span>
                        </div>
                        <div class="question-text">
                            What is a monitor in concurrent programming? How does it differ from semaphores in terms of ease of use and error prevention?
                        </div>
                        <textarea class="answer-input" name="q14" placeholder="Enter your answer here..."></textarea>
                    </div>
                </div>
                
                <!-- Section 3: Code Analysis -->
                <div class="section">
                    <div class="section-header">Section 3: Code Analysis (12 Marks)</div>
                    
                    <!-- Question 15 -->
                    <div class="question">
                        <div class="question-header">
                            <span class="question-number">Question 15 <span class="past-exam-tag">Past Exam</span></span>
                            <span class="question-marks">12 Marks</span>
                        </div>
                        <div class="question-text">
                            <p>Consider two processes P1 and P2 executing concurrently and sharing a semaphore S, which is initialized to 0. The semaphore operations in the processes appear as shown below:</p>
                            <div class="code-block">Process P1          Process P2
-                   -
-                   -
S1                  S2
wait(S)             signal(S)
-                   -
-                   -</div>
                            <p><strong>a)</strong> Which one of the following is true? (4 marks)</p>
                            <ul style="margin-left: 30px; line-height: 2;">
                                <li>(i) S1 and S2 will execute in any order</li>
                                <li>(ii) S1 will always execute before S2</li>
                                <li>(iii) S1 will always execute after S2</li>
                                <li>(iv) P1 and P2 will be deadlocked</li>
                            </ul>
                            <p><strong>b)</strong> Explain your answer with reasoning. (4 marks)</p>
                            <p><strong>c)</strong> What would happen if S was initialized to 1 instead of 0? (4 marks)</p>
                        </div>
                        <textarea class="answer-input" name="q15" placeholder="Enter your answer here..." rows="10"></textarea>
                    </div>
                </div>
                
                <button type="submit" class="submit-btn">Submit Exam</button>
            </form>
            
            <div id="results" class="results"></div>
        </div>
    </div>

    <script>
        const correctAnswers = {
            q1: 'd',
            q2: 'a',
            q3: 'c',
            q4: 'd',
            q5: 'a',
            q6: 'a',
            q7: 'a',
            q8: 'b',
            q9: 'c',
            q10: 'a'
        };

        const explanations = {
            q1: "Peterson's solution is designed to ensure the orderly execution of processes in their critical sections. It provides mutual exclusion for two processes without requiring special hardware instructions.",
            q2: "Counting semaphores are initialized to the number of available resources. The wait() operation decrements the count (consuming a resource), and signal() increments it (releasing a resource).",
            q3: "Using semaphores and carefully managing the order in which philosophers pick up forks prevents deadlock. Solutions include: allowing only n-1 philosophers to sit, picking up both forks atomically, or using asymmetric solutions where odd philosophers pick left first and even pick right first.",
            q4: "Race conditions can be mitigated by implementing mutual exclusion mechanisms such as locks or semaphores. These ensure that only one process can access the critical section at a time, preventing inconsistent data.",
            q5: "A semaphore is a variable or abstract data type used to control access to a common resource by multiple processes. It provides synchronization in concurrent programming environments.",
            q6: "For deadlock to occur, ALL four conditions must be met: (1) Mutual exclusion - resources cannot be shared, (2) Hold and wait - processes hold resources while waiting for others, (3) No preemption - resources cannot be forcibly taken, (4) Circular wait - circular chain of processes waiting for resources.",
            q7: "A semaphore initialized to 1 typically represents a mutex (mutual exclusion) lock. It's a binary semaphore used to ensure that only one process can enter the critical section at a time.",
            q8: "Mutual exclusion means ensuring that only one process accesses a critical section at a time. When one process is executing in its critical section, no other process should be allowed to execute in its critical section.",
            q9: "Resource preemption is NOT a necessary condition for deadlock. In fact, 'No Preemption' is one of the four necessary conditions. The four conditions are: mutual exclusion, hold and wait, no preemption, and circular wait.",
            q10: "Busy waiting (also called spinlock) is when a process continuously checks a condition in a loop without releasing the CPU. This wastes CPU cycles and is inefficient, though it avoids the overhead of context switching."
        };

        const writtenQuestionKeywords = {
            q11: {
                keywords: ['mutual', 'exclusion', 'one', 'process', 'critical', 'section', 'interrupts', 'lost', 'responsiveness', 'security', 'multiprocessor'],
                keyPhrases: ['only one process', 'at a time', 'critical section', 'disabling interrupts', 'important interrupts'],
                minKeywords: 6,
                mockAnswer: "Mutual exclusion means that if process P1 is executing in its critical section, then P2 cannot execute in its critical section (and vice versa). Only one process can be in the critical section at a time.\n\nDisabling interrupts cannot be a general solution because:\n1. Important interrupts may be lost during the disabled period, causing system problems\n2. It decreases system responsiveness as the system cannot respond to urgent events\n3. In multiprocessor systems, disabling interrupts on one processor doesn't prevent other processors from accessing shared resources\n4. Allowing user programs to disable interrupts poses security risks"
            },
            q12: {
                keywords: ['producer', 'consumer', 'buffer', 'semaphore', 'mutex', 'empty', 'full', 'synchronization', 'shared'],
                keyPhrases: ['producer-consumer', 'bounded buffer', 'empty semaphore', 'full semaphore', 'mutex semaphore'],
                minKeywords: 6,
                mockAnswer: "The producer-consumer problem involves two types of processes: producers that generate data and consumers that use the data. They share a common fixed-size buffer.\n\nSemaphore Solution:\n1. mutex = 1 (for mutual exclusion when accessing the buffer)\n2. empty = n (number of empty slots, initially n)\n3. full = 0 (number of full slots, initially 0)\n\nProducer:\nwait(empty);  // wait for empty slot\nwait(mutex);  // enter critical section\n// add item to buffer\nsignal(mutex);  // exit critical section\nsignal(full);  // signal that slot is full\n\nConsumer:\nwait(full);  // wait for full slot\nwait(mutex);  // enter critical section\n// remove item from buffer\nsignal(mutex);  // exit critical section\nsignal(empty);  // signal that slot is empty"
            },
            q13: {
                keywords: ['mutual', 'exclusion', 'progress', 'bounded', 'waiting', 'critical', 'section', 'deadlock', 'starvation'],
                keyPhrases: ['mutual exclusion', 'bounded waiting', 'no process', 'indefinitely'],
                minKeywords: 6,
                mockAnswer: "The three requirements for solving the critical section problem are:\n\n1. Mutual Exclusion: If a process is executing in its critical section, then no other process can execute in its critical section. Only one process at a time can be in the critical section.\n\n2. Progress: If no process is executing in its critical section and some processes wish to enter their critical sections, then only those processes that are not executing in their remainder sections can participate in deciding which will enter next. This selection cannot be postponed indefinitely. This prevents deadlock.\n\n3. Bounded Waiting: There exists a bound on the number of times other processes are allowed to enter their critical sections after a process has made a request to enter its critical section and before that request is granted. This prevents starvation and ensures fairness."
            },
            q14: {
                keywords: ['monitor', 'synchronization', 'construct', 'mutual', 'exclusion', 'condition', 'variables', 'automatic', 'semaphore'],
                keyPhrases: ['synchronization construct', 'mutual exclusion', 'condition variables', 'easier to use', 'automatic synchronization'],
                minKeywords: 5,
                mockAnswer: "A monitor is a high-level synchronization construct that provides a convenient and effective mechanism for process synchronization. It is a collection of procedures, variables, and data structures grouped together in a module or package.\n\nKey differences from semaphores:\n1. Ease of Use: Monitors are easier to use because mutual exclusion is automatic - only one process can be active within the monitor at any time. With semaphores, programmers must explicitly call wait() and signal().\n\n2. Error Prevention: Monitors are less error-prone because the synchronization code is centralized within the monitor. With semaphores, wait() and signal() are scattered throughout the code, making it easy to forget them or use them incorrectly.\n\n3. Condition Variables: Monitors use condition variables with wait() and signal() operations that are safer than semaphores.\n\n4. Compiler Support: Monitors can be implemented and enforced by the compiler, while semaphores rely on programmer discipline."
            }
        };

        document.getElementById('examForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            let totalScore = 0;
            let maxScore = 50;
            let resultsHTML = '<div class="score-display">Calculating your score...</div>';
            
            // Grade MCQs (20 marks total)
            let mcqScore = 0;
            for (let i = 1; i <= 10; i++) {
                const questionName = `q${i}`;
                const selectedAnswer = document.querySelector(`input[name="${questionName}"]:checked`);
                
                if (selectedAnswer) {
                    if (selectedAnswer.value === correctAnswers[questionName]) {
                        mcqScore += 2;
                        resultsHTML += `
                            <div class="question">
                                <div class="question-header">
                                    <span class="question-number">Question ${i}</span>
                                    <span class="question-marks">2/2 Marks ‚úì</span>
                                </div>
                                <div class="feedback correct">
                                    <div class="feedback-title">‚úì Correct!</div>
                                    <p>${explanations[questionName]}</p>
                                </div>
                            </div>
                        `;
                    } else {
                        resultsHTML += `
                            <div class="question">
                                <div class="question-header">
                                    <span class="question-number">Question ${i}</span>
                                    <span class="question-marks">0/2 Marks ‚úó</span>
                                </div>
                                <div class="feedback incorrect">
                                    <div class="feedback-title">‚úó Incorrect</div>
                                    <p><strong>Your answer:</strong> ${selectedAnswer.value.toUpperCase()}</p>
                                    <p><strong>Correct answer:</strong> ${correctAnswers[questionName].toUpperCase()}</p>
                                    <p><strong>Explanation:</strong> ${explanations[questionName]}</p>
                                </div>
                            </div>
                        `;
                    }
                } else {
                    resultsHTML += `
                        <div class="question">
                            <div class="question-header">
                                <span class="question-number">Question ${i}</span>
                                <span class="question-marks">0/2 Marks</span>
                            </div>
                            <div class="feedback incorrect">
                                <div class="feedback-title">No answer provided</div>
                                <p><strong>Correct answer:</strong> ${correctAnswers[questionName].toUpperCase()}</p>
                                <p>${explanations[questionName]}</p>
                            </div>
                        </div>
                    `;
                }
            }
            
            totalScore += mcqScore;
            
            // Grade Written Questions (18 marks total)
            let writtenScore = 0;
            
            // Question 11 (4 marks)
            const q11Answer = document.querySelector('textarea[name="q11"]').value.toLowerCase();
            const q11Data = writtenQuestionKeywords.q11;
            let q11Keywords = 0;
            let q11Found = [];
            let q11Missing = [];
            
            q11Data.keywords.forEach(keyword => {
                if (q11Answer.includes(keyword.toLowerCase())) {
                    q11Keywords++;
                    q11Found.push(keyword);
                } else {
                    q11Missing.push(keyword);
                }
            });
            
            q11Data.keyPhrases.forEach(phrase => {
                if (q11Answer.includes(phrase.toLowerCase())) {
                    q11Keywords += 0.5;
                }
            });
            
            const q11Score = Math.min(4, Math.round((q11Keywords / q11Data.keywords.length) * 4));
            writtenScore += q11Score;
            
            resultsHTML += `
                <div class="question">
                    <div class="question-header">
                        <span class="question-number">Question 11</span>
                        <span class="question-marks">${q11Score}/4 Marks</span>
                    </div>
                    <div class="feedback ${q11Score === 4 ? 'correct' : q11Score > 0 ? 'partial' : 'incorrect'}">
                        <div class="feedback-title">${q11Score === 4 ? '‚úì Excellent!' : q11Score > 0 ? '‚ö† Partial Credit' : '‚úó Needs Improvement'}</div>
                        <p><strong>Your Answer:</strong> ${document.querySelector('textarea[name="q11"]').value || 'No answer provided'}</p>
                        <p><strong>Keywords Found:</strong> <span class="keywords-found">${q11Found.join(', ') || 'None'}</span></p>
                        <p><strong>Keywords Missing:</strong> <span class="keywords-missing">${q11Missing.join(', ') || 'None'}</span></p>
                        <p><strong>Model Answer:</strong> ${q11Data.mockAnswer}</p>
                    </div>
                </div>
            `;
            
            // Question 12 (5 marks)
            const q12Answer = document.querySelector('textarea[name="q12"]').value.toLowerCase();
            const q12Data = writtenQuestionKeywords.q12;
            let q12Keywords = 0;
            let q12Found = [];
            let q12Missing = [];
            
            q12Data.keywords.forEach(keyword => {
                if (q12Answer.includes(keyword.toLowerCase())) {
                    q12Keywords++;
                    q12Found.push(keyword);
                } else {
                    q12Missing.push(keyword);
                }
            });
            
            const q12Score = Math.min(5, Math.round((q12Keywords / q12Data.keywords.length) * 5));
            writtenScore += q12Score;
            
            resultsHTML += `
                <div class="question">
                    <div class="question-header">
                        <span class="question-number">Question 12</span>
                        <span class="question-marks">${q12Score}/5 Marks</span>
                    </div>
                    <div class="feedback ${q12Score === 5 ? 'correct' : q12Score > 0 ? 'partial' : 'incorrect'}">
                        <div class="feedback-title">${q12Score === 5 ? '‚úì Excellent!' : q12Score > 0 ? '‚ö† Partial Credit' : '‚úó Needs Improvement'}</div>
                        <p><strong>Your Answer:</strong> ${document.querySelector('textarea[name="q12"]').value || 'No answer provided'}</p>
                        <p><strong>Keywords Found:</strong> <span class="keywords-found">${q12Found.join(', ') || 'None'}</span></p>
                        <p><strong>Keywords Missing:</strong> <span class="keywords-missing">${q12Missing.join(', ') || 'None'}</span></p>
                        <p><strong>Model Answer:</strong> ${q12Data.mockAnswer}</p>
                    </div>
                </div>
            `;
            
            // Question 13 (5 marks)
            const q13Answer = document.querySelector('textarea[name="q13"]').value.toLowerCase();
            const q13Data = writtenQuestionKeywords.q13;
            let q13Keywords = 0;
            let q13Found = [];
            let q13Missing = [];
            
            q13Data.keywords.forEach(keyword => {
                if (q13Answer.includes(keyword.toLowerCase())) {
                    q13Keywords++;
                    q13Found.push(keyword);
                } else {
                    q13Missing.push(keyword);
                }
            });
            
            const q13Score = Math.min(5, Math.round((q13Keywords / q13Data.keywords.length) * 5));
            writtenScore += q13Score;
            
            resultsHTML += `
                <div class="question">
                    <div class="question-header">
                        <span class="question-number">Question 13</span>
                        <span class="question-marks">${q13Score}/5 Marks</span>
                    </div>
                    <div class="feedback ${q13Score === 5 ? 'correct' : q13Score > 0 ? 'partial' : 'incorrect'}">
                        <div class="feedback-title">${q13Score === 5 ? '‚úì Excellent!' : q13Score > 0 ? '‚ö† Partial Credit' : '‚úó Needs Improvement'}</div>
                        <p><strong>Your Answer:</strong> ${document.querySelector('textarea[name="q13"]').value || 'No answer provided'}</p>
                        <p><strong>Keywords Found:</strong> <span class="keywords-found">${q13Found.join(', ') || 'None'}</span></p>
                        <p><strong>Keywords Missing:</strong> <span class="keywords-missing">${q13Missing.join(', ') || 'None'}</span></p>
                        <p><strong>Model Answer:</strong> ${q13Data.mockAnswer}</p>
                    </div>
                </div>
            `;
            
            // Question 14 (4 marks)
            const q14Answer = document.querySelector('textarea[name="q14"]').value.toLowerCase();
            const q14Data = writtenQuestionKeywords.q14;
            let q14Keywords = 0;
            let q14Found = [];
            let q14Missing = [];
            
            q14Data.keywords.forEach(keyword => {
                if (q14Answer.includes(keyword.toLowerCase())) {
                    q14Keywords++;
                    q14Found.push(keyword);
                } else {
                    q14Missing.push(keyword);
                }
            });
            
            const q14Score = Math.min(4, Math.round((q14Keywords / q14Data.keywords.length) * 4));
            writtenScore += q14Score;
            
            resultsHTML += `
                <div class="question">
                    <div class="question-header">
                        <span class="question-number">Question 14</span>
                        <span class="question-marks">${q14Score}/4 Marks</span>
                    </div>
                    <div class="feedback ${q14Score === 4 ? 'correct' : q14Score > 0 ? 'partial' : 'incorrect'}">
                        <div class="feedback-title">${q14Score === 4 ? '‚úì Excellent!' : q14Score > 0 ? '‚ö† Partial Credit' : '‚úó Needs Improvement'}</div>
                        <p><strong>Your Answer:</strong> ${document.querySelector('textarea[name="q14"]').value || 'No answer provided'}</p>
                        <p><strong>Keywords Found:</strong> <span class="keywords-found">${q14Found.join(', ') || 'None'}</span></p>
                        <p><strong>Keywords Missing:</strong> <span class="keywords-missing">${q14Missing.join(', ') || 'None'}</span></p>
                        <p><strong>Model Answer:</strong> ${q14Data.mockAnswer}</p>
                    </div>
                </div>
            `;
            
            totalScore += writtenScore;
            
            // Question 15 - Code Analysis (12 marks)
            const q15Answer = document.querySelector('textarea[name="q15"]').value.toLowerCase();
            let q15Score = 0;
            let q15Feedback = '';
            
            // Check for key concepts in the answer
            if (q15Answer.includes('iii') || q15Answer.includes('after') || q15Answer.includes('s2 before s1')) {
                q15Score += 4;
                q15Feedback += '<p>‚úì Part (a): Correct - S1 will always execute after S2</p>';
            } else {
                q15Feedback += '<p>‚úó Part (a): Incorrect - The correct answer is (iii)</p>';
            }
            
            if (q15Answer.includes('block') || q15Answer.includes('wait') && q15Answer.includes('signal')) {
                q15Score += 3;
                q15Feedback += '<p>‚úì Part (b): Good explanation about wait() blocking and signal() unblocking</p>';
            } else {
                q15Score += 1;
                q15Feedback += '<p>‚ö† Part (b): Incomplete explanation</p>';
            }
            
            if (q15Answer.includes('any order') || q15Answer.includes('either')) {
                q15Score += 3;
                q15Feedback += '<p>‚úì Part (c): Correct understanding of S initialized to 1</p>';
            } else {
                q15Feedback += '<p>‚úó Part (c): Missing explanation</p>';
            }
            
            totalScore += q15Score;
            
            resultsHTML += `
                <div class="question">
                    <div class="question-header">
                        <span class="question-number">Question 15 (Code Analysis)</span>
                        <span class="question-marks">${q15Score}/12 Marks</span>
                    </div>
                    <div class="feedback ${q15Score >= 10 ? 'correct' : q15Score >= 6 ? 'partial' : 'incorrect'}">
                        <div class="feedback-title">${q15Score >= 10 ? '‚úì Excellent!' : q15Score >= 6 ? '‚ö† Partial Credit' : '‚úó Needs Improvement'}</div>
                        <p><strong>Your Answer:</strong> ${document.querySelector('textarea[name="q15"]').value || 'No answer provided'}</p>
                        ${q15Feedback}
                        <p><strong>Model Answer:</strong></p>
                        <p><strong>a)</strong> (iii) S1 will always execute after S2</p>
                        <p><strong>b)</strong> Since S is initialized to 0, when P1 executes wait(S), it will block (S becomes -1). P1 cannot proceed until P2 executes signal(S), which increments S to 0 and unblocks P1. Therefore, S2 must execute before S1.</p>
                        <p><strong>c)</strong> If S was initialized to 1: P1 could execute wait(S) successfully (S becomes 0) and proceed to S1 without blocking. S1 and S2 could execute in any order. P2's signal(S) would increment S to 1.</p>
                    </div>
                </div>
            `;
            
            // Display final score
            const percentage = ((totalScore / maxScore) * 100).toFixed(1);
            let grade = '';
            if (percentage >= 90) grade = 'A';
            else if (percentage >= 80) grade = 'B';
            else if (percentage >= 70) grade = 'C';
            else if (percentage >= 60) grade = 'D';
            else grade = 'F';
            
            resultsHTML = `
                <div class="score-display">
                    <div>Your Final Score</div>
                    <div class="score">${totalScore} / ${maxScore}</div>
                    <div style="font-size: 0.6em; margin-top: 10px;">
                        Percentage: ${percentage}% | Grade: ${grade}
                    </div>
                    <div style="font-size: 0.5em; margin-top: 10px; color: #666;">
                        MCQs: ${mcqScore}/20 | Written: ${writtenScore}/18 | Code Analysis: ${q15Score}/12
                    </div>
                </div>
            ` + resultsHTML;
            
            document.getElementById('results').innerHTML = resultsHTML;
            document.getElementById('results').classList.add('show');
            document.getElementById('results').scrollIntoView({ behavior: 'smooth' });
        });
    </script>
</body>
</html>