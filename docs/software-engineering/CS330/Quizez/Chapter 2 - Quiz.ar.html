<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OS Chapter 2 - Comprehensive Exam</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }
        
        .header p {
            font-size: 1.1em;
            opacity: 0.95;
        }
        
        .exam-info {
            background: #f8f9fa;
            padding: 20px 30px;
            border-bottom: 3px solid #667eea;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .info-item {
            display: flex;
            flex-direction: column;
        }
        
        .info-label {
            font-weight: bold;
            color: #667eea;
            font-size: 0.9em;
            margin-bottom: 5px;
        }
        
        .info-value {
            font-size: 1.1em;
            color: #333;
        }
        
        .content {
            padding: 30px;
        }
        
        .section {
            margin-bottom: 40px;
        }
        
        .section-title {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            font-size: 1.3em;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .question {
            background: #f8f9fa;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 10px;
            border-left: 4px solid #667eea;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .question:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.2);
        }
        
        .question-number {
            display: inline-block;
            background: #667eea;
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 0.9em;
        }
        
        .question-text {
            font-size: 1.05em;
            line-height: 1.6;
            color: #333;
            margin-bottom: 15px;
        }
        
        .question-marks {
            display: inline-block;
            background: #28a745;
            color: white;
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 0.85em;
            margin-left: 10px;
        }
        
        .options {
            list-style: none;
            margin-top: 15px;
        }
        
        .options li {
            padding: 12px;
            margin: 8px 0;
            background: white;
            border-radius: 6px;
            border: 2px solid #e0e0e0;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
        }
        
        .options li:hover {
            border-color: #667eea;
            background: #f0f3ff;
        }
        
        .options input[type="radio"] {
            margin-right: 10px;
        }
        
        .answer-textarea {
            width: 100%;
            min-height: 100px;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-size: 1em;
            font-family: inherit;
            resize: vertical;
            transition: border-color 0.2s;
        }
        
        .answer-textarea:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .fill-blank-input {
            border: none;
            border-bottom: 2px solid #667eea;
            padding: 5px 10px;
            font-size: 1em;
            min-width: 200px;
            background: white;
        }
        
        .fill-blank-input:focus {
            outline: none;
            border-bottom: 2px solid #764ba2;
        }
        
        .submit-container {
            text-align: center;
            margin: 30px 0;
        }
        
        .submit-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 40px;
            border: none;
            border-radius: 30px;
            font-size: 1.2em;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }
        
        .submit-btn:active {
            transform: translateY(0);
        }
        
        .results-container {
            display: none;
            background: #f8f9fa;
            padding: 30px;
            border-radius: 10px;
            margin: 20px 0;
        }
        
        .results-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .score-display {
            font-size: 3em;
            font-weight: bold;
            color: #667eea;
        }
        
        .feedback {
            margin-top: 15px;
            padding: 15px;
            border-radius: 8px;
            display: none;
        }
        
        .feedback.correct {
            background: #d4edda;
            border: 2px solid #28a745;
            color: #155724;
        }
        
        .feedback.incorrect {
            background: #f8d7da;
            border: 2px solid #dc3545;
            color: #721c24;
        }
        
        .feedback.partial {
            background: #fff3cd;
            border: 2px solid #ffc107;
            color: #856404;
        }
        
        .feedback-icon {
            font-size: 1.2em;
            margin-right: 10px;
        }
        
        .model-answer {
            background: #e7f3ff;
            padding: 15px;
            border-radius: 6px;
            margin-top: 10px;
            border-left: 4px solid #2196F3;
        }
        
        .model-answer-title {
            font-weight: bold;
            color: #1976D2;
            margin-bottom: 10px;
        }
        
        .explanation {
            background: #fff9e6;
            padding: 15px;
            border-radius: 6px;
            margin-top: 10px;
            border-left: 4px solid #ff9800;
        }
        
        .explanation-title {
            font-weight: bold;
            color: #f57c00;
            margin-bottom: 10px;
        }
        
        .question.graded.correct {
            border-left-color: #28a745;
        }
        
        .question.graded.incorrect {
            border-left-color: #dc3545;
        }
        
        .question.graded.partial {
            border-left-color: #ffc107;
        }
        
        .footer {
            background: #2d3748;
            color: white;
            text-align: center;
            padding: 20px;
            font-size: 0.95em;
        }
        
        .footer-name {
            font-size: 1.2em;
            font-weight: bold;
            color: #667eea;
            margin-top: 5px;
        }
        
        @media print {
            body {
                background: white;
                padding: 0;
            }
            
            .container {
                box-shadow: none;
            }
            
            .submit-container {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìö Operating Systems</h1>
            <p>Chapter 2: Operating-System Structures</p>
            <p>Comprehensive Examination</p>
        </div>
        
        <div class="exam-info">
            <div class="info-item">
                <span class="info-label">Course Code</span>
                <span class="info-value">CS 330</span>
            </div>
            <div class="info-item">
                <span class="info-label">Duration</span>
                <span class="info-value">120 Minutes</span>
            </div>
            <div class="info-item">
                <span class="info-label">Total Marks</span>
                <span class="info-value">70 Marks</span>
            </div>
            <div class="info-item">
                <span class="info-label">Total Questions</span>
                <span class="info-value">45 Questions</span>
            </div>
        </div>
        
        <div class="content">
            <form id="examForm">
                <!-- Section 1: Operating System Services -->
                <div class="section">
                    <div class="section-title">Section 1: Operating System Services (12 marks)</div>
                    
                    <div class="question" data-question="1" data-type="mcq" data-marks="1" data-answer="c">
                        <span class="question-number">Q1</span>
                        <span class="question-marks">[1 mark]</span>
                        <div class="question-text">
                            Which of the following is NOT an operating system service that helps users?
                            <ul class="options">
                                <li><input type="radio" name="q1" value="a"> a) User Interface (CLI, GUI)</li>
                                <li><input type="radio" name="q1" value="b"> b) Program Execution</li>
                                <li><input type="radio" name="q1" value="c"> c) Resource Allocation</li>
                                <li><input type="radio" name="q1" value="d"> d) File-system Manipulation</li>
                            </ul>
                        </div>
                        <div class="feedback"></div>
                    </div>
                    
                    <div class="question" data-question="2" data-type="mcq" data-marks="1" data-answer="c">
                        <span class="question-number">Q2</span>
                        <span class="question-marks">[1 mark]</span>
                        <div class="question-text">
                            _____________ is one of the operating system services; it keeps track of which users use how much and what kinds of computer resources for billing and statistics purposes.
                            <ul class="options">
                                <li><input type="radio" name="q2" value="a"> a) Access control</li>
                                <li><input type="radio" name="q2" value="b"> b) Resource allocation</li>
                                <li><input type="radio" name="q2" value="c"> c) Accounting</li>
                                <li><input type="radio" name="q2" value="d"> d) Protection and security</li>
                            </ul>
                        </div>
                        <div class="feedback"></div>
                    </div>
                    
                    <div class="question" data-question="3" data-type="essay" data-marks="2">
                        <span class="question-number">Q3</span>
                        <span class="question-marks">[2 marks]</span>
                        <div class="question-text">
                            Explain the difference between "Protection" and "Security" as operating system services.
                            <textarea class="answer-textarea" name="q3" placeholder="Write your answer here..."></textarea>
                        </div>
                        <div class="feedback"></div>
                    </div>
                    
                    <div class="question" data-question="4" data-type="essay" data-marks="2">
                        <span class="question-number">Q4</span>
                        <span class="question-marks">[2 marks]</span>
                        <div class="question-text">
                            List TWO operating system services that help ensure efficient system operation rather than helping users directly.
                            <textarea class="answer-textarea" name="q4" placeholder="Write your answer here..."></textarea>
                        </div>
                        <div class="feedback"></div>
                    </div>
                    
                    <div class="question" data-question="5" data-type="essay" data-marks="2">
                        <span class="question-number">Q5</span>
                        <span class="question-marks">[2 marks]</span>
                        <div class="question-text">
                            What does the "Error Detection" service do in an operating system? Give an example of where errors might be detected.
                            <textarea class="answer-textarea" name="q5" placeholder="Write your answer here..."></textarea>
                        </div>
                        <div class="feedback"></div>
                    </div>
                    
                    <div class="question" data-question="6" data-type="essay" data-marks="2">
                        <span class="question-number">Q6</span>
                        <span class="question-marks">[2 marks]</span>
                        <div class="question-text">
                            Explain why the "Communications" service is important. What are the two methods of implementing communications between processes?
                            <textarea class="answer-textarea" name="q6" placeholder="Write your answer here..."></textarea>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question" data-question="7" data-type="mcq" data-marks="1" data-answer="b">
                        <span class="question-number">Q7</span>
                        <span class="question-marks">[1 mark]</span>
                        <div class="question-text">
                            Which service allows programs to read, write, create, and delete files?
                            <ul class="options">
                                <li><input type="radio" name="q7" value="a"> a) I/O Operations</li>
                                <li><input type="radio" name="q7" value="b"> b) File-system Manipulation</li>
                                <li><input type="radio" name="q7" value="c"> c) Program Execution</li>
                                <li><input type="radio" name="q7" value="d"> d) Communications</li>
                            </ul>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question" data-question="8" data-type="mcq" data-marks="1" data-answer="d">
                        <span class="question-number">Q8</span>
                        <span class="question-marks">[1 mark]</span>
                        <div class="question-text">
                            The I/O operations service is needed because:
                            <ul class="options">
                                <li><input type="radio" name="q8" value="a"> a) Users prefer graphical interfaces</li>
                                <li><input type="radio" name="q8" value="b"> b) Files need to be manipulated</li>
                                <li><input type="radio" name="q8" value="c"> c) Programs need to communicate</li>
                                <li><input type="radio" name="q8" value="d"> d) User programs cannot execute I/O operations directly</li>
                            </ul>
                        </div>
                        <div class="feedback"></div>
                    </div>
                </div>
                
                <!-- Section 2: User Interfaces -->
                <div class="section">
                    <div class="section-title">Section 2: User Interfaces (8 marks)</div>
                    
                    <div class="question" data-question="9" data-type="mcq" data-marks="1" data-answer="b">
                        <span class="question-number">Q9</span>
                        <span class="question-marks">[1 mark]</span>
                        <div class="question-text">
                            In a Command-Line Interface (CLI), the interpreters are sometimes known as:
                            <ul class="options">
                                <li><input type="radio" name="q9" value="a"> a) Kernels</li>
                                <li><input type="radio" name="q9" value="b"> b) Shells</li>
                                <li><input type="radio" name="q9" value="c"> c) APIs</li>
                                <li><input type="radio" name="q9" value="d"> d) System calls</li>
                            </ul>
                        </div>
                        <div class="feedback"></div>
                    </div>
                    
                    <div class="question" data-question="10" data-type="essay" data-marks="2">
                        <span class="question-number">Q10</span>
                        <span class="question-marks">[2 marks]</span>
                        <div class="question-text">
                            What are the advantages and disadvantages of CLI compared to GUI?
                            <textarea class="answer-textarea" name="q10" placeholder="Write your answer here..."></textarea>
                        </div>
                        <div class="feedback"></div>
                    </div>
                    
                    <div class="question" data-question="11" data-type="mcq" data-marks="1" data-answer="b">
                        <span class="question-number">Q11</span>
                        <span class="question-marks">[1 mark]</span>
                        <div class="question-text">
                            Touchscreen interfaces require new types of interactions. What are gestures used for in touchscreen interfaces?
                            <ul class="options">
                                <li><input type="radio" name="q11" value="a"> a) Only for scrolling</li>
                                <li><input type="radio" name="q11" value="b"> b) For actions and selection</li>
                                <li><input type="radio" name="q11" value="c"> c) Only for text entry</li>
                                <li><input type="radio" name="q11" value="d"> d) For voice commands</li>
                            </ul>
                        </div>
                        <div class="feedback"></div>
                    </div>
                    
                    <div class="question" data-question="12" data-type="essay" data-marks="2">
                        <span class="question-number">Q12</span>
                        <span class="question-marks">[2 marks]</span>
                        <div class="question-text">
                            Describe the difference between a command interpreter that has built-in commands versus one where commands are just names of programs.
                            <textarea class="answer-textarea" name="q12" placeholder="Write your answer here..."></textarea>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question" data-question="13" data-type="mcq" data-marks="1" data-answer="c">
                        <span class="question-number">Q13</span>
                        <span class="question-marks">[1 mark]</span>
                        <div class="question-text">
                            Which operating system was the first to use GUI extensively?
                            <ul class="options">
                                <li><input type="radio" name="q13" value="a"> a) MS-DOS</li>
                                <li><input type="radio" name="q13" value="b"> b) UNIX</li>
                                <li><input type="radio" name="q13" value="c"> c) Xerox PARC</li>
                                <li><input type="radio" name="q13" value="d"> d) Linux</li>
                            </ul>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question" data-question="14" data-type="mcq" data-marks="1" data-answer="d">
                        <span class="question-number">Q14</span>
                        <span class="question-marks">[1 mark]</span>
                        <div class="question-text">
                            Modern operating systems typically include:
                            <ul class="options">
                                <li><input type="radio" name="q14" value="a"> a) Only CLI</li>
                                <li><input type="radio" name="q14" value="b"> b) Only GUI</li>
                                <li><input type="radio" name="q14" value="c"> c) Either CLI or GUI but not both</li>
                                <li><input type="radio" name="q14" value="d"> d) Both CLI and GUI interfaces</li>
                            </ul>
                        </div>
                        <div class="feedback"></div>
                    </div>
                </div>
                
                <!-- Section 3: System Calls -->
                <div class="section">
                    <div class="section-title">Section 3: System Calls (15 marks)</div>
                    
                    <div class="question" data-question="15" data-type="mcq" data-marks="1" data-answer="b">
                        <span class="question-number">Q15</span>
                        <span class="question-marks">[1 mark]</span>
                        <div class="question-text">
                            To access the services of the operating system, the interface is provided by:
                            <ul class="options">
                                <li><input type="radio" name="q15" value="a"> a) Library</li>
                                <li><input type="radio" name="q15" value="b"> b) System calls</li>
                                <li><input type="radio" name="q15" value="c"> c) Assembly instructions</li>
                                <li><input type="radio" name="q15" value="d"> d) API</li>
                            </ul>
                        </div>
                        <div class="feedback"></div>
                    </div>
                    
                    <div class="question" data-question="16" data-type="essay" data-marks="2">
                        <span class="question-number">Q16</span>
                        <span class="question-marks">[2 marks]</span>
                        <div class="question-text">
                            What intercepts function calls in the API and invokes the necessary system calls within the operating system?
                            <textarea class="answer-textarea" name="q16" placeholder="Write your answer here..."></textarea>
                        </div>
                        <div class="feedback"></div>
                    </div>
                    
                    <div class="question" data-question="17" data-type="essay" data-marks="2">
                        <span class="question-number">Q17</span>
                        <span class="question-marks">[2 marks]</span>
                        <div class="question-text">
                            System calls are made available through an API. What are the advantages of using an API instead of calling system calls directly?
                            <textarea class="answer-textarea" name="q17" placeholder="Write your answer here..."></textarea>
                        </div>
                        <div class="feedback"></div>
                    </div>
                    
                    <div class="question" data-question="18" data-type="essay" data-marks="2">
                        <span class="question-number">Q18</span>
                        <span class="question-marks">[2 marks]</span>
                        <div class="question-text">
                            Name THREE common APIs mentioned in the chapter.
                            <textarea class="answer-textarea" name="q18" placeholder="Write your answer here..."></textarea>
                        </div>
                        <div class="feedback"></div>
                    </div>
                    
                    <div class="question" data-question="19" data-type="essay" data-marks="3">
                        <span class="question-number">Q19</span>
                        <span class="question-marks">[3 marks]</span>
                        <div class="question-text">
                            What are the three general methods used to pass parameters to the operating system during a system call?
                            <textarea class="answer-textarea" name="q19" placeholder="Write your answer here..."></textarea>
                        </div>
                        <div class="feedback"></div>
                    </div>
                    
                    <div class="question" data-question="20" data-type="essay" data-marks="2">
                        <span class="question-number">Q20</span>
                        <span class="question-marks">[2 marks]</span>
                        <div class="question-text">
                            Why do the block and stack methods of parameter passing NOT limit the number or length of parameters being passed, but the register method does?
                            <textarea class="answer-textarea" name="q20" placeholder="Write your answer here..."></textarea>
                        </div>
                        <div class="feedback"></div>
                    </div>
                    
                    <div class="question" data-question="21" data-type="essay" data-marks="3">
                        <span class="question-number">Q21</span>
                        <span class="question-marks">[3 marks]</span>
                        <div class="question-text">
                            List the SIX categories of system calls and give one example of each.
                            <textarea class="answer-textarea" name="q21" placeholder="Write your answer here..."></textarea>
                        </div>
                        <div class="feedback"></div>
                    </div>
                </div>
                
                <!-- Section 4: Operating System Structure -->
                <div class="section">
                    <div class="section-title">Section 4: Operating System Structure (15 marks)</div>
                    
                    <div class="question" data-question="22" data-type="mcq" data-marks="1" data-answer="c">
                        <span class="question-number">Q22</span>
                        <span class="question-marks">[1 mark]</span>
                        <div class="question-text">
                            Which operating system structure(s) allow(s) direct communication among all operating system services?
                            <ul class="options">
                                <li><input type="radio" name="q22" value="a"> a) Layered approach</li>
                                <li><input type="radio" name="q22" value="b"> b) Microkernel approach</li>
                                <li><input type="radio" name="q22" value="c"> c) Modular approach</li>
                                <li><input type="radio" name="q22" value="d"> d) All of the above</li>
                            </ul>
                        </div>
                        <div class="feedback"></div>
                    </div>
                    
                    <div class="question" data-question="23" data-type="essay" data-marks="2">
                        <span class="question-number">Q23</span>
                        <span class="question-marks">[2 marks]</span>
                        <div class="question-text">
                            In the layered approach to OS design, what is the main principle regarding how layers interact?
                            <textarea class="answer-textarea" name="q23" placeholder="Write your answer here..."></textarea>
                        </div>
                        <div class="feedback"></div>
                    </div>
                    
                    <div class="question" data-question="24" data-type="mcq" data-marks="1" data-answer="d">
                        <span class="question-number">Q24</span>
                        <span class="question-marks">[1 mark]</span>
                        <div class="question-text">
                            A microkernel is a kernel that:
                            <ul class="options">
                                <li><input type="radio" name="q24" value="a"> a) Contains many components that are optimized to reduce resident memory size</li>
                                <li><input type="radio" name="q24" value="b"> b) Is compressed before loading to reduce resident memory size</li>
                                <li><input type="radio" name="q24" value="c"> c) Is compiled to produce the smallest size possible when stored to disk</li>
                                <li><input type="radio" name="q24" value="d"> d) Is stripped of all nonessential components</li>
                            </ul>
                        </div>
                        <div class="feedback"></div>
                    </div>
                    
                    <div class="question" data-question="25" data-type="essay" data-marks="3">
                        <span class="question-number">Q25</span>
                        <span class="question-marks">[3 marks]</span>
                        <div class="question-text">
                            What are THREE benefits of the microkernel approach?
                            <textarea class="answer-textarea" name="q25" placeholder="Write your answer here..."></textarea>
                        </div>
                        <div class="feedback"></div>
                    </div>
                    
                    <div class="question" data-question="26" data-type="essay" data-marks="2">
                        <span class="question-number">Q26</span>
                        <span class="question-marks">[2 marks]</span>
                        <div class="question-text">
                            How does the modular approach differ from the layered approach? What makes it more flexible?
                            <textarea class="answer-textarea" name="q26" placeholder="Write your answer here..."></textarea>
                        </div>
                        <div class="feedback"></div>
                    </div>
                    
                    <div class="question" data-question="27" data-type="mcq" data-marks="1" data-answer="c">
                        <span class="question-number">Q27</span>
                        <span class="question-marks">[1 mark]</span>
                        <div class="question-text">
                            Linux uses which type of kernel structure?
                            <ul class="options">
                                <li><input type="radio" name="q27" value="a"> a) Pure microkernel</li>
                                <li><input type="radio" name="q27" value="b"> b) Pure layered</li>
                                <li><input type="radio" name="q27" value="c"> c) Monolithic plus modular</li>
                                <li><input type="radio" name="q27" value="d"> d) Simple structure</li>
                            </ul>
                        </div>
                        <div class="feedback"></div>
                    </div>
                    
                    <div class="question" data-question="28" data-type="essay" data-marks="2">
                        <span class="question-number">Q28</span>
                        <span class="question-marks">[2 marks]</span>
                        <div class="question-text">
                            Why are most modern operating systems considered "hybrid" systems?
                            <textarea class="answer-textarea" name="q28" placeholder="Write your answer here..."></textarea>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question" data-question="29" data-type="mcq" data-marks="1" data-answer="b">
                        <span class="question-number">Q29</span>
                        <span class="question-marks">[1 mark]</span>
                        <div class="question-text">
                            In microkernel systems, how do client programs communicate with services?
                            <ul class="options">
                                <li><input type="radio" name="q29" value="a"> a) Direct function calls</li>
                                <li><input type="radio" name="q29" value="b"> b) Message passing</li>
                                <li><input type="radio" name="q29" value="c"> c) Shared memory only</li>
                                <li><input type="radio" name="q29" value="d"> d) Hardware interrupts</li>
                            </ul>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question" data-question="30" data-type="essay" data-marks="2">
                        <span class="question-number">Q30</span>
                        <span class="question-marks">[2 marks]</span>
                        <div class="question-text">
                            What are the disadvantages of the layered approach?
                            <textarea class="answer-textarea" name="q30" placeholder="Write your answer here..."></textarea>
                        </div>
                        <div class="feedback"></div>
                    </div>
                </div>
                
                <!-- Section 5: System Programs and Debugging -->
                <div class="section">
                    <div class="section-title">Section 5: System Programs and Debugging (7 marks)</div>
                    
                    <div class="question" data-question="31" data-type="mcq" data-marks="1" data-answer="c">
                        <span class="question-number">Q31</span>
                        <span class="question-marks">[1 mark]</span>
                        <div class="question-text">
                            System programs are:
                            <ul class="options">
                                <li><input type="radio" name="q31" value="a"> a) Part of the kernel</li>
                                <li><input type="radio" name="q31" value="b"> b) Application programs</li>
                                <li><input type="radio" name="q31" value="c"> c) Programs that ship with the OS but are not part of the kernel</li>
                                <li><input type="radio" name="q31" value="d"> d) Hardware controllers</li>
                            </ul>
                        </div>
                        <div class="feedback"></div>
                    </div>
                    
                    <div class="question" data-question="32" data-type="essay" data-marks="2">
                        <span class="question-number">Q32</span>
                        <span class="question-marks">[2 marks]</span>
                        <div class="question-text">
                            What is the difference between a "core dump" and a "crash dump"?
                            <textarea class="answer-textarea" name="q32" placeholder="Write your answer here..."></textarea>
                        </div>
                        <div class="feedback"></div>
                    </div>
                    
                    <div class="question" data-question="33" data-type="essay" data-marks="2">
                        <span class="question-number">Q33</span>
                        <span class="question-marks">[2 marks]</span>
                        <div class="question-text">
                            Explain the difference between "profiling" and "trace listings" in OS debugging.
                            <textarea class="answer-textarea" name="q33" placeholder="Write your answer here..."></textarea>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question" data-question="34" data-type="mcq" data-marks="1" data-answer="a">
                        <span class="question-number">Q34</span>
                        <span class="question-marks">[1 mark]</span>
                        <div class="question-text">
                            When an application fails, what file is generated?
                            <ul class="options">
                                <li><input type="radio" name="q34" value="a"> a) Core dump file</li>
                                <li><input type="radio" name="q34" value="b"> b) Crash dump file</li>
                                <li><input type="radio" name="q34" value="c"> c) Log file</li>
                                <li><input type="radio" name="q34" value="d"> d) Trace file</li>
                            </ul>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question" data-question="35" data-type="mcq" data-marks="1" data-answer="b">
                        <span class="question-number">Q35</span>
                        <span class="question-marks">[1 mark]</span>
                        <div class="question-text">
                            Performance tuning can optimize system performance using:
                            <ul class="options">
                                <li><input type="radio" name="q35" value="a"> a) Only crash dumps</li>
                                <li><input type="radio" name="q35" value="b"> b) Trace listings and profiling</li>
                                <li><input type="radio" name="q35" value="c"> c) Only core dumps</li>
                                <li><input type="radio" name="q35" value="d"> d) Hardware replacement</li>
                            </ul>
                        </div>
                        <div class="feedback"></div>
                    </div>
                </div>
                
                <!-- Section 6: OS Design and Implementation -->
                <div class="section">
                    <div class="section-title">Section 6: OS Design, Implementation, and Generation (8 marks)</div>
                    
                    <div class="question" data-question="36" data-type="essay" data-marks="2">
                        <span class="question-number">Q36</span>
                        <span class="question-marks">[2 marks]</span>
                        <div class="question-text">
                            What are TWO important principles to consider when designing an operating system?
                            <textarea class="answer-textarea" name="q36" placeholder="Write your answer here..."></textarea>
                        </div>
                        <div class="feedback"></div>
                    </div>
                    
                    <div class="question" data-question="37" data-type="mcq" data-marks="1" data-answer="b">
                        <span class="question-number">Q37</span>
                        <span class="question-marks">[1 mark]</span>
                        <div class="question-text">
                            What are the advantages of implementing an OS in a high-level language like C or C++?
                            <ul class="options">
                                <li><input type="radio" name="q37" value="a"> a) Faster execution</li>
                                <li><input type="radio" name="q37" value="b"> b) Easier to understand and debug, more portable</li>
                                <li><input type="radio" name="q37" value="c"> c) Smaller code size</li>
                                <li><input type="radio" name="q37" value="d"> d) Better hardware control</li>
                            </ul>
                        </div>
                        <div class="feedback"></div>
                    </div>
                    
                    <div class="question" data-question="38" data-type="essay" data-marks="2">
                        <span class="question-number">Q38</span>
                        <span class="question-marks">[2 marks]</span>
                        <div class="question-text">
                            What is SYSGEN (System Generation) and why is it necessary?
                            <textarea class="answer-textarea" name="q38" placeholder="Write your answer here..."></textarea>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question" data-question="39" data-type="essay" data-marks="2">
                        <span class="question-number">Q39</span>
                        <span class="question-marks">[2 marks]</span>
                        <div class="question-text">
                            What is the difference between mechanism and policy in OS design?
                            <textarea class="answer-textarea" name="q39" placeholder="Write your answer here..."></textarea>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question" data-question="40" data-type="mcq" data-marks="1" data-answer="a">
                        <span class="question-number">Q40</span>
                        <span class="question-marks">[1 mark]</span>
                        <div class="question-text">
                            Most operating systems are written in:
                            <ul class="options">
                                <li><input type="radio" name="q40" value="a"> a) A combination of assembly and high-level languages</li>
                                <li><input type="radio" name="q40" value="b"> b) Pure assembly language</li>
                                <li><input type="radio" name="q40" value="c"> c) Pure C</li>
                                <li><input type="radio" name="q40" value="d"> d) Java</li>
                            </ul>
                        </div>
                        <div class="feedback"></div>
                    </div>
                </div>
                
                <!-- Section 7: System Boot -->
                <div class="section">
                    <div class="section-title">Section 7: System Boot (5 marks)</div>
                    
                    <div class="question" data-question="41" data-type="mcq" data-marks="1" data-answer="c">
                        <span class="question-number">Q41</span>
                        <span class="question-marks">[1 mark]</span>
                        <div class="question-text">
                            The bootstrap program is typically stored in:
                            <ul class="options">
                                <li><input type="radio" name="q41" value="a"> a) RAM</li>
                                <li><input type="radio" name="q41" value="b"> b) Hard disk</li>
                                <li><input type="radio" name="q41" value="c"> c) ROM or EPROM (firmware)</li>
                                <li><input type="radio" name="q41" value="d"> d) Cache memory</li>
                            </ul>
                        </div>
                        <div class="feedback"></div>
                    </div>
                    
                    <div class="question" data-question="42" data-type="essay" data-marks="2">
                        <span class="question-number">Q42</span>
                        <span class="question-marks">[2 marks]</span>
                        <div class="question-text">
                            Describe the boot process from power-on to OS running.
                            <textarea class="answer-textarea" name="q42" placeholder="Write your answer here..."></textarea>
                        </div>
                        <div class="feedback"></div>
                    </div>
                    
                    <div class="question" data-question="43" data-type="essay" data-marks="2">
                        <span class="question-number">Q43</span>
                        <span class="question-marks">[2 marks]</span>
                        <div class="question-text">
                            What is the purpose of a boot loader?
                            <textarea class="answer-textarea" name="q43" placeholder="Write your answer here..."></textarea>
                        </div>
                        <div class="feedback"></div>
                    </div>
                </div>

                <div class="submit-container">
                    <button type="submit" class="submit-btn">üìù Submit Exam</button>
                </div>

                <div class="results-container" id="results">
                    <div class="results-header">
                        <h2>Exam Results</h2>
                        <div class="score-display" id="scoreDisplay"></div>
                        <p id="scoreText"></p>
                    </div>
                </div>
            </form>
        </div>
        
        <div class="footer">
            <p>Prince Sultan University - College of Computer and Information Sciences</p>
            <p>Operating Systems (CS 330) - Chapter 2 Examination</p>
            <p class="footer-name">Prepared by: Shoug Alomran</p>
        </div>
    </div>

    <script>
        const modelAnswers = {
            q3: {
                keywords: ['protection', 'mechanism', 'controlling access', 'security', 'defense', 'attacks', 'authentication'],
                model: "Protection involves ensuring that all access to system resources is controlled - it's a mechanism for controlling access of processes or users to resources. Security is the defense of the system against internal and external attacks, including denial-of-service, worms, viruses, identity theft, and theft of service. Protection is about controlling who can access what, while security is about defending against malicious attempts to breach the system.",
                explanation: "Protection is internal (within the OS) while Security is external (defending against threats). Protection uses access control mechanisms, while Security uses authentication and encryption."
            },
            q4: {
                keywords: ['resource allocation', 'accounting', 'protection', 'security'],
                model: "Two services for efficient system operation are: 1) Resource allocation - allocating resources to multiple users or jobs running concurrently. 2) Accounting - keeping track of which users use how much and what kinds of computer resources for account billing or accumulating usage statistics.",
                explanation: "These services help the OS itself operate efficiently, not directly helping users. Other valid answers include Protection and Security services."
            },
            q5: {
                keywords: ['error detection', 'ensure correct computing', 'cpu', 'memory', 'i/o', 'hardware', 'user programs'],
                model: "Error detection ensures correct computing by detecting errors in the CPU and memory hardware, in I/O devices, or in user programs. Examples include: detecting memory errors (parity errors), CPU errors, I/O device failures (printer out of paper), and user program errors (division by zero, illegal memory access).",
                explanation: "The OS must constantly monitor for hardware and software errors to maintain system stability."
            },
            q6: {
                keywords: ['communications', 'exchange', 'information', 'shared memory', 'message passing', 'processes'],
                model: "Communications allows exchange of information between processes executing either on the same computer or on different systems tied together by a network. The two methods are: 1) Shared memory - processes share a region of memory. 2) Message passing - packets of information are moved by the OS between processes.",
                explanation: "Shared memory is faster but requires synchronization. Message passing is easier to implement but has more overhead."
            },
            q10: {
                keywords: ['cli', 'gui', 'faster', 'expert', 'user-friendly', 'mouse', 'commands', 'memory'],
                model: "CLI advantages: Faster for expert users, requires less memory, can automate tasks with scripts, direct and powerful. CLI disadvantages: Difficult for beginners, requires memorizing commands. GUI advantages: User-friendly, intuitive, easy to learn, visual feedback. GUI disadvantages: Requires more memory and processing power, slower for experienced users.",
                explanation: "CLI is preferred by system administrators and developers for its power and efficiency, while GUI is better for casual users."
            },
            q12: {
                keywords: ['built-in', 'commands', 'interpreter', 'programs', 'shell', 'modification', 'features'],
                model: "Built-in commands: The command interpreter itself contains the code to execute commands. Adding new features requires modifying the shell. Commands as program names: The interpreter uses the command to identify a file to load and execute. Adding new features doesn't require shell modification - just add new program files.",
                explanation: "The second approach (commands as programs) is more flexible and allows easier system extension without modifying the shell."
            },
            q16: {
                keywords: ['system call interface', 'api', 'intercepts'],
                model: "The system-call interface intercepts function calls in the API and invokes the necessary system calls within the operating system. It acts as a bridge between the API and the actual OS system calls.",
                explanation: "This interface maintains a table indexed by system call numbers and handles the translation from API calls to actual system calls."
            },
            q17: {
                keywords: ['portability', 'programs', 'easier', 'operating systems', 'system calls', 'different'],
                model: "Advantages of using an API: 1) Program portability - programs written using an API can work on any system that supports that API, even if the underlying system calls are different. 2) Easier to use - APIs provide a simpler, higher-level interface than raw system calls. 3) The programmer doesn't need to know the details of system call implementation.",
                explanation: "APIs abstract away OS-specific details. For example, a program using POSIX API will work on Linux, Mac OS X, and other POSIX-compliant systems without modification."
            },
            q18: {
                keywords: ['win32', 'posix', 'java', 'api'],
                model: "Three common APIs are: 1) Win32 API for Windows. 2) POSIX API for POSIX-based systems (including virtually all versions of UNIX, Linux, and Mac OS X). 3) Java API for the Java virtual machine (JVM).",
                explanation: "These are the three most common APIs mentioned in the textbook. Each provides a standard interface for applications."
            },
            q19: {
                keywords: ['registers', 'block', 'table', 'memory', 'stack', 'parameters'],
                model: "Three methods to pass parameters: 1) Pass parameters in registers - simplest but limited by number of registers. 2) Parameters stored in a block or table in memory, and address of block passed as parameter in a register - used by Linux and Solaris. 3) Parameters placed (pushed) onto the stack by the program and popped off the stack by the OS.",
                explanation: "The choice depends on the number and complexity of parameters. Registers are fastest but limited, while block and stack methods can handle unlimited parameters."
            },
            q20: {
                keywords: ['registers', 'limited', 'block', 'stack', 'memory', 'unlimited', 'number'],
                model: "Registers are limited in number (typically 8-16 general-purpose registers in modern CPUs). If there are more parameters than available registers, this method cannot be used. Block and stack methods store parameters in memory, which has much larger capacity, so they can accommodate any number and length of parameters.",
                explanation: "This is why Linux and Solaris use the block/table method - it's more flexible and can handle complex system calls with many parameters."
            },
            q21: {
                keywords: ['process control', 'file management', 'device management', 'information maintenance', 'communications', 'protection'],
                model: "Six categories: 1) Process control - create/terminate process, load, execute (e.g., fork(), exit()). 2) File management - create/delete file, open, close, read, write (e.g., open(), read()). 3) Device management - request/release device, read, write (e.g., ioctl()). 4) Information maintenance - get/set time or date, get/set system data (e.g., getpid(), time()). 5) Communications - create/delete connection, send/receive messages (e.g., pipe(), shmget()). 6) Protection - control access to resources, get/set permissions (e.g., chmod(), umask()).",
                explanation: "These six categories cover all major OS functionality that user programs need to access through system calls."
            },
            q23: {
                keywords: ['layer', 'uses', 'functions', 'services', 'lower-level', 'below'],
                model: "In the layered approach, each layer uses functions and services of only lower-level layers. Layer N can only call functions from layers N-1, N-2, etc., never from higher layers. The bottom layer (layer 0) is the hardware, and the highest layer (layer N) is the user interface.",
                explanation: "This creates a hierarchy where each layer builds on the functionality of layers below it, making the system easier to debug and verify."
            },
            q25: {
                keywords: ['easier', 'extend', 'port', 'reliable', 'secure', 'kernel', 'user'],
                model: "Three benefits: 1) Easier to extend - adding new services doesn't require modifying the kernel, just adding user-level programs. 2) Easier to port - only the small kernel needs to be modified for different hardware. 3) More reliable and secure - most services run as user-level processes rather than in kernel mode, so their failures won't crash the system.",
                explanation: "The microkernel approach minimizes what runs in kernel mode, making the system more stable and maintainable."
            },
            q26: {
                keywords: ['modular', 'call', 'any', 'module', 'flexible', 'layered', 'lower'],
                model: "The modular approach uses an object-oriented design where each core component is separate and each can call any other module through known interfaces. This is more flexible than the layered approach because any module can call any other module, whereas in layered systems, layers can only call lower layers.",
                explanation: "Modular design combines benefits of layered (organization) and monolithic (performance) approaches. Modern systems like Linux and Solaris use this."
            },
            q28: {
                keywords: ['hybrid', 'combine', 'multiple', 'approaches', 'performance', 'security'],
                model: "Modern operating systems are hybrid because they combine multiple approaches to address performance, security, and usability needs. For example, Linux is mostly monolithic but uses loadable kernel modules. Windows is mostly monolithic but has microkernel features for certain subsystems.",
                explanation: "Pure approaches have limitations, so modern OSes mix different design principles to get the best of each approach."
            },
            q30: {
                keywords: ['difficult', 'define', 'layers', 'less efficient', 'overhead', 'performance'],
                model: "Disadvantages of layered approach: 1) Difficult to appropriately define the various layers and their functionality. 2) Less efficient than other approaches because each layer adds overhead - a user program request must pass through multiple layers before reaching hardware. 3) Performance impact from crossing multiple layers.",
                explanation: "The strict layering, while good for structure, creates performance penalties as requests must traverse many layers."
            },
            q32: {
                keywords: ['core dump', 'application', 'process', 'memory', 'crash dump', 'kernel', 'operating system'],
                model: "A core dump file captures the memory of a process when an application fails. A crash dump file contains kernel memory when the operating system itself fails. Core dumps are for application debugging, crash dumps are for OS debugging.",
                explanation: "Core dumps help developers debug application failures, while crash dumps help OS developers diagnose system crashes."
            },
            q33: {
                keywords: ['profiling', 'periodic sampling', 'statistical', 'trace', 'recorded', 'activities'],
                model: "Profiling is periodic sampling of the instruction pointer to look for statistical trends - it shows which parts of code are executed most frequently. Trace listings are recordings of activities, showing the sequence of operations that occurred. Profiling shows WHERE time is spent, traces show WHAT happened.",
                explanation: "Profiling is used for performance optimization, while traces help understand program behavior and find bugs."
            },
            q36: {
                keywords: ['mechanism', 'policy', 'separation', 'user goals', 'system goals'],
                model: "Two important principles: 1) Separation of mechanism and policy - mechanisms determine HOW to do something, policies determine WHAT will be done. 2) Consider both user goals (convenient, easy to use, reliable, safe, fast) and system goals (easy to design/implement/maintain, flexible, reliable, efficient).",
                explanation: "Separating mechanism from policy allows the system to be flexible - policies can change without changing mechanisms."
            },
            q38: {
                keywords: ['sysgen', 'system generation', 'configure', 'hardware', 'specific system'],
                model: "SYSGEN (System Generation) is the process of configuring or generating an operating system for a specific computer site. It's necessary because each computer system has different hardware configurations (amount of memory, devices present, etc.), and the OS needs to be configured to match the specific hardware it will run on.",
                explanation: "SYSGEN asks questions about the hardware configuration and creates a customized OS image for that specific system."
            },
            q39: {
                keywords: ['mechanism', 'how', 'policy', 'what', 'separation', 'flexible'],
                model: "Mechanism determines HOW to do something (implementation details). Policy determines WHAT will be done (decisions, strategies). Example: A mechanism might provide priority scheduling capabilities, while policy decides which processes get what priorities. Separating them allows flexibility - you can change policies without changing mechanisms.",
                explanation: "This separation is crucial for OS design flexibility. For example, the timer mechanism can be used for different scheduling policies."
            },
            q42: {
                keywords: ['bootstrap', 'rom', 'eprom', 'firmware', 'initialize', 'kernel', 'load', 'execute'],
                model: "Boot process: 1) Power on the computer. 2) Bootstrap program (stored in ROM/EPROM/firmware) is executed. 3) Bootstrap initializes all aspects of system (CPU registers, device controllers, memory). 4) Bootstrap loads the OS kernel from disk into memory. 5) Kernel starts executing. 6) Kernel initializes services and loads system programs. 7) System is ready for user interaction.",
                explanation: "The bootstrap is crucial because when power is first applied, there's no program in RAM to execute - it must come from non-volatile ROM."
            },
            q43: {
                keywords: ['boot loader', 'load', 'kernel', 'disk', 'memory', 'locate', 'start'],
                model: "A boot loader's purpose is to locate the operating system kernel on disk, load it into memory, and start its execution. It knows how to access the file system to find the kernel file and how to set up the initial environment for the OS to run.",
                explanation: "Boot loaders like GRUB (Linux) or Windows Boot Manager handle the transition from firmware to OS, including selecting which OS to boot in multi-boot systems."
            }
        };

        const explanations = {
            q1: "Resource Allocation is a service for efficient SYSTEM operation, not directly for users. The other three are user-helping services.",
            q2: "Accounting tracks resource usage for billing/statistics - it's explicitly mentioned in the chapter as keeping track of 'which users use how much'.",
            q7: "File-system manipulation specifically handles file operations like read, write, create, and delete.",
            q8: "User programs run in user mode and cannot directly access I/O devices - they need OS services.",
            q9: "Shells are command interpreters - examples include bash, csh, ksh on UNIX systems.",
            q11: "Gestures in touchscreen interfaces are used for actions and selection - swiping, pinching, tapping, etc.",
            q13: "Xerox PARC invented the GUI in the early 1970s, which later inspired Apple's Macintosh.",
            q14: "Modern OSes provide both interfaces - e.g., Windows has GUI with command prompt, Linux has GUI with terminal.",
            q15: "System calls are the programming interface to OS services - they're the fundamental way to access OS functionality.",
            q22: "Modular approach allows modules to call any other module. Layered only allows calling lower layers, microkernel requires message passing.",
            q24: "A microkernel removes all nonessential components from the kernel and implements them as user-level programs.",
            q27: "Linux uses a monolithic kernel structure but with loadable kernel modules for flexibility.",
            q29: "Microkernels use message passing for communication since services run as separate user-level processes.",
            q31: "System programs ship with the OS but aren't part of the kernel - examples: compilers, text editors, file management programs.",
            q34: "Core dumps are generated when an application fails and capture the process memory for debugging.",
            q35: "Performance tuning uses trace listings (recording activities) and profiling (sampling to find bottlenecks).",
            q37: "High-level languages make OS code easier to write, understand, debug, and port to different hardware.",
            q40: "Most OSes use assembly for low-level hardware access (boot code, interrupt handlers) and C/C++ for higher-level functionality.",
            q41: "Bootstrap is in ROM/EPROM (firmware) because it must be available when power is first applied (RAM is empty)."
        };

        document.getElementById('examForm').addEventListener('submit', function(e) {
            e.preventDefault();
            gradeExam();
        });

        function gradeExam() {
            let totalScore = 0;
            let maxScore = 0;

            const questions = document.querySelectorAll('.question');
            
            questions.forEach(question => {
                const qNum = question.dataset.question;
                const qType = question.dataset.type;
                const marks = parseInt(question.dataset.marks);
                maxScore += marks;

                if (qType === 'mcq') {
                    const selected = document.querySelector(`input[name="q${qNum}"]:checked`);
                    const correct = question.dataset.answer;
                    
                    const feedback = question.querySelector('.feedback');
                    feedback.style.display = 'block';
                    
                    if (selected && selected.value === correct) {
                        totalScore += marks;
                        question.classList.add('graded', 'correct');
                        feedback.className = 'feedback correct';
                        feedback.innerHTML = `
                            <span class="feedback-icon">‚úì</span>
                            <strong>Correct!</strong> You earned ${marks} mark(s).
                            <div class="explanation">
                                <div class="explanation-title">üí° Explanation:</div>
                                ${explanations[`q${qNum}`] || 'Well done!'}
                            </div>
                        `;
                    } else {
                        question.classList.add('graded', 'incorrect');
                        feedback.className = 'feedback incorrect';
                        const correctLetter = correct.toUpperCase();
                        const correctOption = question.querySelector(`input[value="${correct}"]`).parentElement.textContent.trim();
                        feedback.innerHTML = `
                            <span class="feedback-icon">‚úó</span>
                            <strong>Incorrect.</strong> You earned 0 marks.
                            <div class="model-answer">
                                <div class="model-answer-title">‚úì Correct Answer:</div>
                                ${correctOption}
                            </div>
                            <div class="explanation">
                                <div class="explanation-title">üí° Why you were wrong:</div>
                                ${explanations[`q${qNum}`] || 'Review the material for this concept.'}
                            </div>
                        `;
                    }
                } else if (qType === 'essay') {
                    const answer = document.querySelector(`[name="q${qNum}"]`).value.trim().toLowerCase();
                    const model = modelAnswers[`q${qNum}`];
                    
                    const feedback = question.querySelector('.feedback');
                    feedback.style.display = 'block';
                    
                    if (answer.length === 0) {
                        question.classList.add('graded', 'incorrect');
                        feedback.className = 'feedback incorrect';
                        feedback.innerHTML = `
                            <span class="feedback-icon">‚úó</span>
                            <strong>No Answer Provided.</strong> You earned 0 marks.
                            <div class="model-answer">
                                <div class="model-answer-title">üìù Model Answer:</div>
                                ${model.model}
                            </div>
                        `;
                    } else {
                        let score = 0;
                        let foundKeywords = [];
                        let missingKeywords = [];
                        
                        model.keywords.forEach(keyword => {
                            if (answer.includes(keyword.toLowerCase())) {
                                foundKeywords.push(keyword);
                                score++;
                            } else {
                                missingKeywords.push(keyword);
                            }
                        });
                        
                        const percentage = (foundKeywords.length / model.keywords.length) * 100;
                        let earnedMarks = 0;
                        
                        if (percentage >= 70) {
                            earnedMarks = marks;
                            question.classList.add('graded', 'correct');
                            feedback.className = 'feedback correct';
                        } else if (percentage >= 40) {
                            earnedMarks = Math.ceil(marks * (percentage / 100));
                            question.classList.add('graded', 'partial');
                            feedback.className = 'feedback partial';
                        } else {
                            question.classList.add('graded', 'incorrect');
                            feedback.className = 'feedback incorrect';
                        }
                        
                        totalScore += earnedMarks;
                        
                        let feedbackHTML = `
                            <span class="feedback-icon">${earnedMarks === marks ? '‚úì' : earnedMarks > 0 ? '‚óê' : '‚úó'}</span>
                            <strong>${earnedMarks === marks ? 'Excellent!' : earnedMarks > 0 ? 'Partial Credit' : 'Needs Improvement'}</strong> 
                            You earned ${earnedMarks} out of ${marks} mark(s). (${percentage.toFixed(0)}% keyword match)
                            <div style="margin-top: 10px;">
                                <strong>Keywords found:</strong> ${foundKeywords.length > 0 ? foundKeywords.join(', ') : 'None'}
                            </div>
                        `;
                        
                        if (missingKeywords.length > 0) {
                            feedbackHTML += `
                                <div style="margin-top: 5px; color: #d32f2f;">
                                    <strong>Missing important concepts:</strong> ${missingKeywords.join(', ')}
                                </div>
                            `;
                        }
                        
                        feedbackHTML += `
                            <div class="model-answer">
                                <div class="model-answer-title">üìù Model Answer:</div>
                                ${model.model}
                            </div>
                            <div class="explanation">
                                <div class="explanation-title">üí° Explanation:</div>
                                ${model.explanation}
                            </div>
                        `;
                        
                        feedback.innerHTML = feedbackHTML;
                    }
                }
            });

            const percentage = (totalScore / maxScore * 100).toFixed(1);
            const resultsDiv = document.getElementById('results');
            const scoreDisplay = document.getElementById('scoreDisplay');
            const scoreText = document.getElementById('scoreText');
            
            let grade, message, color;
            if (percentage >= 90) {
                grade = 'A+';
                message = 'Outstanding Performance! üåü';
                color = '#2e7d32';
            } else if (percentage >= 85) {
                grade = 'A';
                message = 'Excellent Work! üéâ';
                color = '#388e3c';
            } else if (percentage >= 80) {
                grade = 'B+';
                message = 'Very Good! üëè';
                color = '#689f38';
            } else if (percentage >= 75) {
                grade = 'B';
                message = 'Good Job! üëç';
                color = '#afb42b';
            } else if (percentage >= 70) {
                grade = 'C+';
                message = 'Satisfactory üìö';
                color = '#fbc02d';
            } else if (percentage >= 60) {
                grade = 'C';
                message = 'Pass - Keep Studying üìñ';
                color = '#ff9800';
            } else {
                grade = 'F';
                message = 'Needs More Study üìù';
                color = '#d32f2f';
            }
            
            scoreDisplay.textContent = `${totalScore}/${maxScore}`;
            scoreDisplay.style.color = color;
            scoreText.innerHTML = `
                <strong style="font-size: 1.5em; color: ${color};">Grade: ${grade}</strong><br>
                <span style="font-size: 1.2em;">${percentage}%</span><br>
                <em>${message}</em>
            `;
            
            resultsDiv.style.display = 'block';
            resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }
    </script>
</body>
</html>