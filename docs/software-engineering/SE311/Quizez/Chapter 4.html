<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SE311 - Chapter 4: Requirements Elicitation - Exam</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #f5f5f5;
            --text-primary: #1a1a1a;
            --text-secondary: #666666;
            --border-color: #dddddd;
            --accent-color: #2563eb;
            --success-color: #10b981;
            --error-color: #ef4444;
            --warning-color: #f59e0b;
            --shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        [data-theme="dark"] {
            --bg-primary: #1a1a1a;
            --bg-secondary: #2d2d2d;
            --text-primary: #f5f5f5;
            --text-secondary: #a0a0a0;
            --border-color: #404040;
            --accent-color: #3b82f6;
            --success-color: #10b981;
            --error-color: #ef4444;
            --warning-color: #f59e0b;
            --shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background-color: var(--bg-secondary);
            color: var(--text-primary);
            line-height: 1.6;
            padding: 20px;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background-color: var(--bg-primary);
            padding: 40px;
            border-radius: 12px;
            box-shadow: var(--shadow);
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            border-bottom: 3px solid var(--accent-color);
            padding-bottom: 20px;
        }

        .header h1 {
            font-size: 2em;
            margin-bottom: 10px;
            color: var(--accent-color);
        }

        .header p {
            color: var(--text-secondary);
            font-size: 1.1em;
        }

        .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .student-info {
            flex: 1;
            min-width: 250px;
        }

        .student-info input {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border-color);
            border-radius: 6px;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            font-size: 1em;
            margin-bottom: 10px;
            transition: border-color 0.3s ease;
        }

        .student-info input:focus {
            outline: none;
            border-color: var(--accent-color);
        }

        .toggle-buttons {
            display: flex;
            gap: 10px;
        }

        button {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .lang-toggle {
            background-color: var(--accent-color);
            color: white;
        }

        .lang-toggle:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }

        .question {
            background-color: var(--bg-secondary);
            padding: 25px;
            margin-bottom: 25px;
            border-radius: 8px;
            border-left: 4px solid var(--accent-color);
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .question-number {
            font-size: 1.2em;
            font-weight: bold;
            color: var(--accent-color);
        }

        .question-type {
            background-color: var(--accent-color);
            color: white;
            padding: 4px 12px;
            border-radius: 4px;
            font-size: 0.85em;
        }

        .question-text {
            margin-bottom: 20px;
            font-size: 1.05em;
            line-height: 1.7;
        }

        .options {
            margin-left: 20px;
        }

        .option {
            margin-bottom: 12px;
            display: flex;
            align-items: flex-start;
        }

        .option input[type="radio"],
        .option input[type="checkbox"] {
            margin-right: 10px;
            margin-top: 4px;
            cursor: pointer;
        }

        .option label {
            cursor: pointer;
            flex: 1;
        }

        textarea {
            width: 100%;
            min-height: 120px;
            padding: 12px;
            border: 2px solid var(--border-color);
            border-radius: 6px;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            font-size: 1em;
            font-family: inherit;
            resize: vertical;
            transition: border-color 0.3s ease;
        }

        textarea:focus {
            outline: none;
            border-color: var(--accent-color);
        }

        .feedback {
            margin-top: 15px;
            padding: 15px;
            border-radius: 6px;
            display: none;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .feedback.correct {
            background-color: rgba(16, 185, 129, 0.1);
            border: 2px solid var(--success-color);
            display: block;
        }

        .feedback.incorrect {
            background-color: rgba(239, 68, 68, 0.1);
            border: 2px solid var(--error-color);
            display: block;
        }

        .feedback.partial {
            background-color: rgba(245, 158, 11, 0.1);
            border: 2px solid var(--warning-color);
            display: block;
        }

        .feedback-header {
            font-weight: bold;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .feedback-icon {
            font-size: 1.2em;
        }

        .submit-btn {
            background-color: var(--success-color);
            color: white;
            width: 100%;
            padding: 15px;
            font-size: 1.1em;
            margin-top: 30px;
        }

        .submit-btn:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }

        .submit-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .score-display {
            background: linear-gradient(135deg, var(--accent-color), var(--success-color));
            color: white;
            padding: 25px;
            border-radius: 8px;
            text-align: center;
            margin-top: 30px;
            display: none;
        }

        .score-display.show {
            display: block;
            animation: slideIn 0.5s ease;
        }

        .score-display h2 {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .score-display p {
            font-size: 1.2em;
        }

        .model-answer {
            margin-top: 10px;
            padding: 12px;
            background-color: var(--bg-primary);
            border-radius: 6px;
            border-left: 3px solid var(--success-color);
        }

        .model-answer-label {
            font-weight: bold;
            color: var(--success-color);
            margin-bottom: 8px;
        }

        .generated-tag {
            display: inline-block;
            background-color: var(--warning-color);
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.75em;
            margin-left: 8px;
            font-weight: 600;
        }

        .exam-tag {
            display: inline-block;
            background-color: var(--success-color);
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.75em;
            margin-left: 8px;
            font-weight: 600;
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }

            .controls {
                flex-direction: column;
            }

            .student-info {
                width: 100%;
            }
        }

        /* RTL Support */
        [dir="rtl"] .question {
            border-left: none;
            border-right: 4px solid var(--accent-color);
        }

        [dir="rtl"] .option {
            flex-direction: row-reverse;
        }

        [dir="rtl"] .option input {
            margin-right: 0;
            margin-left: 10px;
        }

        [dir="rtl"] .options {
            margin-left: 0;
            margin-right: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>
                <span class="en">SE311 - Requirements Engineering</span>
                <span class="ar" style="display:none;">هندسة المتطلبات - SE311</span>
            </h1>
            <p>
                <span class="en">Chapter 4: Requirements Elicitation - Comprehensive Exam</span>
                <span class="ar" style="display:none;">الفصل الرابع: استخلاص المتطلبات - اختبار شامل</span>
            </p>
        </div>

        <div class="controls">
            <div class="toggle-buttons">
                <button class="lang-toggle" onclick="toggleLanguage()">
                    <span class="en">العربية</span>
                    <span class="ar" style="display:none;">English</span>
                </button>
            </div>
        </div>

        <form id="examForm">
            <!-- Question 1: MCQ - Elicitation Definition (From Exams) -->
            <div class="question">
                <div class="question-header">
                    <span class="question-number">
                        <span class="en">Question 1</span>
                        <span class="ar" style="display:none;">السؤال ١</span>
                    </span>
                    <span class="question-type">
                        <span class="en">Multiple Choice (2 points)</span>
                        <span class="ar" style="display:none;">اختيار من متعدد (٢ نقطة)</span>
                        <span class="exam-tag">EXAM</span>
                    </span>
                </div>
                <div class="question-text">
                    <span class="en">What is the meaning of requirement elicitation in software engineering?</span>
                    <span class="ar" style="display:none;">ما معنى استخلاص المتطلبات في هندسة البرمجيات؟</span>
                </div>
                <div class="options">
                    <div class="option">
                        <input type="radio" id="q1a" name="q1" value="a">
                        <label for="q1a">
                            <span class="en">Gathering of requirements</span>
                            <span class="ar" style="display:none;">جمع المتطلبات</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q1b" name="q1" value="b">
                        <label for="q1b">
                            <span class="en">Understanding of requirements</span>
                            <span class="ar" style="display:none;">فهم المتطلبات</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q1c" name="q1" value="c">
                        <label for="q1c">
                            <span class="en">Getting the requirements from client</span>
                            <span class="ar" style="display:none;">الحصول على المتطلبات من العميل</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q1d" name="q1" value="d">
                        <label for="q1d">
                            <span class="en">All of the above</span>
                            <span class="ar" style="display:none;">كل ما سبق</span>
                        </label>
                    </div>
                </div>
                <div class="feedback" data-question="1"></div>
            </div>

            <!-- Question 2: MCQ - Elicitation Techniques Categories -->
            <div class="question">
                <div class="question-header">
                    <span class="question-number">
                        <span class="en">Question 2</span>
                        <span class="ar" style="display:none;">السؤال ٢</span>
                    </span>
                    <span class="question-type">
                        <span class="en">Multiple Choice (2 points)</span>
                        <span class="ar" style="display:none;">اختيار من متعدد (٢ نقطة)</span>
                        <span class="generated-tag">GENERATED</span>
                    </span>
                </div>
                <div class="question-text">
                    <span class="en">Which of the following is a facilitated elicitation technique?</span>
                    <span class="ar" style="display:none;">أي من التالي يعتبر تقنية استخلاص ميسرة (بالتفاعل مع المعنيين)؟</span>
                </div>
                <div class="options">
                    <div class="option">
                        <input type="radio" id="q2a" name="q2" value="a">
                        <label for="q2a">
                            <span class="en">Document Analysis</span>
                            <span class="ar" style="display:none;">تحليل الوثائق</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q2b" name="q2" value="b">
                        <label for="q2b">
                            <span class="en">Workshops</span>
                            <span class="ar" style="display:none;">ورش العمل</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q2c" name="q2" value="c">
                        <label for="q2c">
                            <span class="en">System Interface Analysis</span>
                            <span class="ar" style="display:none;">تحليل واجهة النظام</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q2d" name="q2" value="d">
                        <label for="q2d">
                            <span class="en">User Interface Analysis</span>
                            <span class="ar" style="display:none;">تحليل واجهة المستخدم</span>
                        </label>
                    </div>
                </div>
                <div class="feedback" data-question="2"></div>
            </div>

            <!-- Question 3: Multiple Select - Sources of Requirements -->
            <div class="question">
                <div class="question-header">
                    <span class="question-number">
                        <span class="en">Question 3</span>
                        <span class="ar" style="display:none;">السؤال ٣</span>
                    </span>
                    <span class="question-type">
                        <span class="en">Multiple Select (3 points)</span>
                        <span class="ar" style="display:none;">اختيار متعدد (٣ نقاط)</span>
                        <span class="generated-tag">GENERATED</span>
                    </span>
                </div>
                <div class="question-text">
                    <span class="en">Which of the following are valid sources of requirements? (Select all that apply)</span>
                    <span class="ar" style="display:none;">أي من التالي يعد مصدراً صالحاً للمتطلبات؟ (اختر جميع الإجابات الصحيحة)</span>
                </div>
                <div class="options">
                    <div class="option">
                        <input type="checkbox" id="q3a" name="q3" value="a">
                        <label for="q3a">
                            <span class="en">Stakeholders</span>
                            <span class="ar" style="display:none;">أصحاب المصلحة</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="checkbox" id="q3b" name="q3" value="b">
                        <label for="q3b">
                            <span class="en">Existing systems</span>
                            <span class="ar" style="display:none;">الأنظمة الموجودة</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="checkbox" id="q3c" name="q3" value="c">
                        <label for="q3c">
                            <span class="en">Marketing predictions only</span>
                            <span class="ar" style="display:none;">التوقعات التسويقية فقط</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="checkbox" id="q3d" name="q3" value="d">
                        <label for="q3d">
                            <span class="en">Standards and legislation</span>
                            <span class="ar" style="display:none;">المعايير والتشريعات</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="checkbox" id="q3e" name="q3" value="e">
                        <label for="q3e">
                            <span class="en">Competing systems</span>
                            <span class="ar" style="display:none;">الأنظمة المنافسة</span>
                        </label>
                    </div>
                </div>
                <div class="feedback" data-question="3"></div>
            </div>

            <!-- Question 4: MCQ - Interview Strengths -->
            <div class="question">
                <div class="question-header">
                    <span class="question-number">
                        <span class="en">Question 4</span>
                        <span class="ar" style="display:none;">السؤال ٤</span>
                    </span>
                    <span class="question-type">
                        <span class="en">Multiple Choice (2 points)</span>
                        <span class="ar" style="display:none;">اختيار من متعدد (٢ نقطة)</span>
                        <span class="generated-tag">GENERATED</span>
                    </span>
                </div>
                <div class="question-text">
                    <span class="en">Which of the following is NOT a strength of interviews as an elicitation technique?</span>
                    <span class="ar" style="display:none;">أي من التالي ليس ميزة للمقابلات كتقنية استخلاص؟</span>
                </div>
                <div class="options">
                    <div class="option">
                        <input type="radio" id="q4a" name="q4" value="a">
                        <label for="q4a">
                            <span class="en">Effective for getting to know the application domain quickly</span>
                            <span class="ar" style="display:none;">فعالة للتعرف على نطاق التطبيق بسرعة</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q4b" name="q4" value="b">
                        <label for="q4b">
                            <span class="en">Interviewees may be more comfortable sharing thoughts</span>
                            <span class="ar" style="display:none;">قد يكون الأشخاص أكثر راحة في مشاركة أفكارهم</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q4c" name="q4" value="c">
                        <label for="q4c">
                            <span class="en">Can reach many people with low resources</span>
                            <span class="ar" style="display:none;">يمكن الوصول لعدد كبير من الناس بموارد محدودة</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q4d" name="q4" value="d">
                        <label for="q4d">
                            <span class="en">Suitable for busy executives</span>
                            <span class="ar" style="display:none;">مناسبة للمدراء التنفيذيين المشغولين</span>
                        </label>
                    </div>
                </div>
                <div class="feedback" data-question="4"></div>
            </div>

            <!-- Question 5: MCQ - Prototyping Fidelity -->
            <div class="question">
                <div class="question-header">
                    <span class="question-number">
                        <span class="en">Question 5</span>
                        <span class="ar" style="display:none;">السؤال ٥</span>
                    </span>
                    <span class="question-type">
                        <span class="en">Multiple Choice (2 points)</span>
                        <span class="ar" style="display:none;">اختيار من متعدد (٢ نقطة)</span>
                        <span class="generated-tag">GENERATED</span>
                    </span>
                </div>
                <div class="question-text">
                    <span class="en">What does "fidelity" mean in the context of prototyping?</span>
                    <span class="ar" style="display:none;">ماذا تعني "الدقة" في سياق النماذج الأولية؟</span>
                </div>
                <div class="options">
                    <div class="option">
                        <input type="radio" id="q5a" name="q5" value="a">
                        <label for="q5a">
                            <span class="en">The cost of creating the prototype</span>
                            <span class="ar" style="display:none;">تكلفة إنشاء النموذج الأولي</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q5b" name="q5" value="b">
                        <label for="q5b">
                            <span class="en">The extent to which the prototype is real and reactive</span>
                            <span class="ar" style="display:none;">مدى واقعية وتفاعلية النموذج الأولي</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q5c" name="q5" value="c">
                        <label for="q5c">
                            <span class="en">The time required to build the prototype</span>
                            <span class="ar" style="display:none;">الوقت المطلوب لبناء النموذج الأولي</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q5d" name="q5" value="d">
                        <label for="q5d">
                            <span class="en">The number of stakeholders involved</span>
                            <span class="ar" style="display:none;">عدد المعنيين المشاركين</span>
                        </label>
                    </div>
                </div>
                <div class="feedback" data-question="5"></div>
            </div>

            <!-- Question 6: MCQ - Use Cases -->
            <div class="question">
                <div class="question-header">
                    <span class="question-number">
                        <span class="en">Question 6</span>
                        <span class="ar" style="display:none;">السؤال ٦</span>
                    </span>
                    <span class="question-type">
                        <span class="en">Multiple Choice (2 points)</span>
                        <span class="ar" style="display:none;">اختيار من متعدد (٢ نقطة)</span>
                        <span class="generated-tag">GENERATED</span>
                    </span>
                </div>
                <div class="question-text">
                    <span class="en">What is a use case?</span>
                    <span class="ar" style="display:none;">ما هي حالة الاستخدام؟</span>
                </div>
                <div class="options">
                    <div class="option">
                        <input type="radio" id="q6a" name="q6" value="a">
                        <label for="q6a">
                            <span class="en">A type of stakeholder</span>
                            <span class="ar" style="display:none;">نوع من أصحاب المصلحة</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q6b" name="q6" value="b">
                        <label for="q6b">
                            <span class="en">A sequence of interactions between a system and an external actor that results in an outcome of value</span>
                            <span class="ar" style="display:none;">سلسلة من التفاعلات بين النظام وفاعل خارجي تؤدي إلى نتيجة ذات قيمة</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q6c" name="q6" value="c">
                        <label for="q6c">
                            <span class="en">A document that lists all requirements</span>
                            <span class="ar" style="display:none;">وثيقة تسرد جميع المتطلبات</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q6d" name="q6" value="d">
                        <label for="q6d">
                            <span class="en">A testing procedure</span>
                            <span class="ar" style="display:none;">إجراء اختبار</span>
                        </label>
                    </div>
                </div>
                <div class="feedback" data-question="6"></div>
            </div>

            <!-- Question 7: MCQ - Misuse Cases -->
            <div class="question">
                <div class="question-header">
                    <span class="question-number">
                        <span class="en">Question 7</span>
                        <span class="ar" style="display:none;">السؤال ٧</span>
                    </span>
                    <span class="question-type">
                        <span class="en">Multiple Choice (2 points)</span>
                        <span class="ar" style="display:none;">اختيار من متعدد (٢ نقطة)</span>
                        <span class="generated-tag">GENERATED</span>
                    </span>
                </div>
                <div class="question-text">
                    <span class="en">What are misuse cases primarily used for?</span>
                    <span class="ar" style="display:none;">لماذا تستخدم حالات سوء الاستخدام بشكل أساسي؟</span>
                </div>
                <div class="options">
                    <div class="option">
                        <input type="radio" id="q7a" name="q7" value="a">
                        <label for="q7a">
                            <span class="en">Documenting normal user requirements</span>
                            <span class="ar" style="display:none;">توثيق متطلبات المستخدم العادية</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q7b" name="q7" value="b">
                        <label for="q7b">
                            <span class="en">Eliciting security and safety requirements</span>
                            <span class="ar" style="display:none;">استخلاص متطلبات الأمن والسلامة</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q7c" name="q7" value="c">
                        <label for="q7c">
                            <span class="en">Testing the final system</span>
                            <span class="ar" style="display:none;">اختبار النظام النهائي</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q7d" name="q7" value="d">
                        <label for="q7d">
                            <span class="en">Designing the user interface</span>
                            <span class="ar" style="display:none;">تصميم واجهة المستخدم</span>
                        </label>
                    </div>
                </div>
                <div class="feedback" data-question="7"></div>
            </div>

            <!-- Question 8: MCQ - When Elicitation is Done -->
            <div class="question">
                <div class="question-header">
                    <span class="question-number">
                        <span class="en">Question 8</span>
                        <span class="ar" style="display:none;">السؤال ٨</span>
                    </span>
                    <span class="question-type">
                        <span class="en">Multiple Choice (2 points)</span>
                        <span class="ar" style="display:none;">اختيار من متعدد (٢ نقطة)</span>
                        <span class="generated-tag">GENERATED</span>
                    </span>
                </div>
                <div class="question-text">
                    <span class="en">Which of the following indicates that you might be done with elicitation?</span>
                    <span class="ar" style="display:none;">أي من التالي يشير إلى أنك قد انتهيت من الاستخلاص؟</span>
                </div>
                <div class="options">
                    <div class="option">
                        <input type="radio" id="q8a" name="q8" value="a">
                        <label for="q8a">
                            <span class="en">Users can't think of any more use cases</span>
                            <span class="ar" style="display:none;">لا يستطيع المستخدمون التفكير بمزيد من حالات الاستخدام</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q8b" name="q8" value="b">
                        <label for="q8b">
                            <span class="en">All proposed requirements are out of scope</span>
                            <span class="ar" style="display:none;">جميع المتطلبات المقترحة خارج النطاق</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q8c" name="q8" value="c">
                        <label for="q8c">
                            <span class="en">Users keep repeating previously covered issues</span>
                            <span class="ar" style="display:none;">المستخدمون يكررون القضايا التي تم تغطيتها سابقاً</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q8d" name="q8" value="d">
                        <label for="q8d">
                            <span class="en">All of the above</span>
                            <span class="ar" style="display:none;">كل ما سبق</span>
                        </label>
                    </div>
                </div>
                <div class="feedback" data-question="8"></div>
            </div>

            <!-- Question 9: Short Answer - Elicitation from Exam -->
            <div class="question">
                <div class="question-header">
                    <span class="question-number">
                        <span class="en">Question 9</span>
                        <span class="ar" style="display:none;">السؤال ٩</span>
                    </span>
                    <span class="question-type">
                        <span class="en">Short Answer (4 points)</span>
                        <span class="ar" style="display:none;">إجابة قصيرة (٤ نقاط)</span>
                        <span class="exam-tag">EXAM</span>
                    </span>
                </div>
                <div class="question-text">
                    <span class="en">Mention three different requirements elicitation methods and for each one explain:<br>
                    i. Why it would be suitable for gathering requirements for a mobile banking app<br>
                    ii. What stakeholders it is appropriate for<br>
                    iii. How you would implement it in practice</span>
                    <span class="ar" style="display:none;">اذكر ثلاث طرق مختلفة لاستخلاص المتطلبات ولكل واحدة اشرح:<br>
                    ١. لماذا ستكون مناسبة لجمع متطلبات تطبيق الخدمات المصرفية عبر الجوال<br>
                    ٢. ما هي الجهات المعنية المناسبة لها<br>
                    ٣. كيف ستطبقها عملياً</span>
                </div>
                <textarea name="q9" rows="10" placeholder="Type your answer here / اكتب إجابتك هنا"></textarea>
                <div class="feedback" data-question="9"></div>
            </div>

            <!-- Question 10: Short Answer - Elicitation Challenges -->
            <div class="question">
                <div class="question-header">
                    <span class="question-number">
                        <span class="en">Question 10</span>
                        <span class="ar" style="display:none;">السؤال ١٠</span>
                    </span>
                    <span class="question-type">
                        <span class="en">Short Answer (3 points)</span>
                        <span class="ar" style="display:none;">إجابة قصيرة (٣ نقاط)</span>
                        <span class="generated-tag">GENERATED</span>
                    </span>
                </div>
                <div class="question-text">
                    <span class="en">Identify and explain three main challenges in requirements elicitation and suggest one mitigation strategy for each.</span>
                    <span class="ar" style="display:none;">حدد واشرح ثلاثة تحديات رئيسية في استخلاص المتطلبات واقترح استراتيجية واحدة للتخفيف من كل منها.</span>
                </div>
                <textarea name="q10" rows="8" placeholder="Type your answer here / اكتب إجابتك هنا"></textarea>
                <div class="feedback" data-question="10"></div>
            </div>

            <!-- Question 11: MCQ - Questionnaires -->
            <div class="question">
                <div class="question-header">
                    <span class="question-number">
                        <span class="en">Question 11</span>
                        <span class="ar" style="display:none;">السؤال ١١</span>
                    </span>
                    <span class="question-type">
                        <span class="en">Multiple Choice (2 points)</span>
                        <span class="ar" style="display:none;">اختيار من متعدد (٢ نقطة)</span>
                        <span class="generated-tag">GENERATED</span>
                    </span>
                </div>
                <div class="question-text">
                    <span class="en">Which of the following is a strength of using questionnaires for elicitation?</span>
                    <span class="ar" style="display:none;">أي من التالي يعد ميزة لاستخدام الاستبيانات في الاستخلاص؟</span>
                </div>
                <div class="options">
                    <div class="option">
                        <input type="radio" id="q11a" name="q11" value="a">
                        <label for="q11a">
                            <span class="en">Allows for detailed follow-up questions</span>
                            <span class="ar" style="display:none;">يسمح بأسئلة متابعة تفصيلية</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q11b" name="q11" value="b">
                        <label for="q11b">
                            <span class="en">Can reach large user populations easily</span>
                            <span class="ar" style="display:none;">يمكن الوصول لعدد كبير من المستخدمين بسهولة</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q11c" name="q11" value="c">
                        <label for="q11c">
                            <span class="en">Facilitates face-to-face interaction</span>
                            <span class="ar" style="display:none;">يسهل التفاعل وجهاً لوجه</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q11d" name="q11" value="d">
                        <label for="q11d">
                            <span class="en">Guarantees high response rates</span>
                            <span class="ar" style="display:none;">يضمن معدلات استجابة عالية</span>
                        </label>
                    </div>
                </div>
                <div class="feedback" data-question="11"></div>
            </div>

            <!-- Question 12: MCQ - Focus Groups -->
            <div class="question">
                <div class="question-header">
                    <span class="question-number">
                        <span class="en">Question 12</span>
                        <span class="ar" style="display:none;">السؤال ١٢</span>
                    </span>
                    <span class="question-type">
                        <span class="en">Multiple Choice (2 points)</span>
                        <span class="ar" style="display:none;">اختيار من متعدد (٢ نقطة)</span>
                        <span class="generated-tag">GENERATED</span>
                    </span>
                </div>
                <div class="question-text">
                    <span class="en">Focus groups are particularly valuable for:</span>
                    <span class="ar" style="display:none;">المجموعات البؤرية ذات قيمة خاصة في:</span>
                </div>
                <div class="options">
                    <div class="option">
                        <input type="radio" id="q12a" name="q12" value="a">
                        <label for="q12a">
                            <span class="en">Developing commercial products</span>
                            <span class="ar" style="display:none;">تطوير المنتجات التجارية</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q12b" name="q12" value="b">
                        <label for="q12b">
                            <span class="en">Making final decisions on requirements</span>
                            <span class="ar" style="display:none;">اتخاذ القرارات النهائية بشأن المتطلبات</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q12c" name="q12" value="c">
                        <label for="q12c">
                            <span class="en">Technical feasibility analysis</span>
                            <span class="ar" style="display:none;">تحليل الجدوى الفنية</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q12d" name="q12" value="d">
                        <label for="q12d">
                            <span class="en">System testing</span>
                            <span class="ar" style="display:none;">اختبار النظام</span>
                        </label>
                    </div>
                </div>
                <div class="feedback" data-question="12"></div>
            </div>

            <!-- Question 13: Short Answer - Elicitation Process -->
            <div class="question">
                <div class="question-header">
                    <span class="question-number">
                        <span class="en">Question 13</span>
                        <span class="ar" style="display:none;">السؤال ١٣</span>
                    </span>
                    <span class="question-type">
                        <span class="en">Short Answer (3 points)</span>
                        <span class="ar" style="display:none;">إجابة قصيرة (٣ نقاط)</span>
                        <span class="generated-tag">GENERATED</span>
                    </span>
                </div>
                <div class="question-text">
                    <span class="en">List and briefly describe the four main phases of the requirements elicitation process.</span>
                    <span class="ar" style="display:none;">اسرد ووصف بإيجاز المراحل الأربع الرئيسية لعملية استخلاص المتطلبات.</span>
                </div>
                <textarea name="q13" rows="6" placeholder="Type your answer here / اكتب إجابتك هنا"></textarea>
                <div class="feedback" data-question="13"></div>
            </div>

            <button type="button" class="submit-btn" onclick="gradeExam()">
                <span class="en">Submit Exam</span>
                <span class="ar" style="display:none;">تسليم الاختبار</span>
            </button>
        </form>

        <div class="score-display" id="scoreDisplay">
            <h2>
                <span class="en">Your Score:</span>
                <span class="ar" style="display:none;">درجتك:</span>
                <span id="finalScore"></span>
            </h2>
            <p>
                <span class="en">out of 30 points</span>
                <span class="ar" style="display:none;">من ٣٠ نقطة</span>
            </p>
        </div>
    </div>

    <script>
        // Language toggle
        let currentLang = 'en';

        function toggleLanguage() {
            currentLang = currentLang === 'en' ? 'ar' : 'en';
            const html = document.documentElement;
            
            if (currentLang === 'ar') {
                html.setAttribute('dir', 'rtl');
                html.setAttribute('lang', 'ar');
                document.querySelectorAll('.en').forEach(el => el.style.display = 'none');
                document.querySelectorAll('.ar').forEach(el => el.style.display = '');
            } else {
                html.setAttribute('dir', 'ltr');
                html.setAttribute('lang', 'en');
                document.querySelectorAll('.en').forEach(el => el.style.display = '');
                document.querySelectorAll('.ar').forEach(el => el.style.display = 'none');
            }
        }

        // Dark mode detection
        function detectColorScheme() {
            const darkModeQuery = window.matchMedia('(prefers-color-scheme: dark)');
            
            function updateTheme(e) {
                document.documentElement.setAttribute('data-theme', e.matches ? 'dark' : 'light');
            }
            
            updateTheme(darkModeQuery);
            darkModeQuery.addEventListener('change', updateTheme);
        }

        // Initialize on page load
        detectColorScheme();

        // Answer key with detailed feedback
        const answerKey = {
            q1: {
                correct: 'd',
                explanation: {
                    en: "Requirements elicitation encompasses gathering, understanding, and extracting requirements from clients - it includes all these activities together.",
                    ar: "استخلاص المتطلبات يشمل جمع وفهم واستخراج المتطلبات من العملاء - يتضمن كل هذه الأنشطة معاً."
                },
                modelAnswer: {
                    en: "All of the above - Elicitation is a collaborative and analytical process that includes activities to collect, discover, extract, and define requirements.",
                    ar: "كل ما سبق - الاستخلاص هو عملية تعاونية وتحليلية تتضمن أنشطة لجمع واكتشاف واستخراج وتحديد المتطلبات."
                }
            },
            q2: {
                correct: 'b',
                explanation: {
                    en: "Workshops are facilitated techniques where you interact with stakeholders. Document analysis, system interface analysis, and user interface analysis are independent techniques.",
                    ar: "ورش العمل هي تقنيات ميسرة حيث تتفاعل مع المعنيين. تحليل الوثائق وتحليل واجهة النظام وتحليل واجهة المستخدم هي تقنيات مستقلة."
                },
                modelAnswer: {
                    en: "Workshops - Facilitated techniques involve interaction with stakeholders (interviews, workshops, focus groups, observations, questionnaires).",
                    ar: "ورش العمل - التقنيات الميسرة تتضمن التفاعل مع المعنيين (المقابلات، ورش العمل، المجموعات البؤرية، الملاحظات، الاستبيانات)."
                }
            },
            q3: {
                correct: ['a', 'b', 'd', 'e'],
                explanation: {
                    en: "Valid sources include stakeholders, existing systems, standards/legislation, and competing systems. Marketing predictions alone are not a reliable primary source.",
                    ar: "المصادر الصالحة تشمل أصحاب المصلحة والأنظمة الموجودة والمعايير/التشريعات والأنظمة المنافسة. التوقعات التسويقية وحدها ليست مصدراً أساسياً موثوقاً."
                },
                modelAnswer: {
                    en: "Stakeholders, Existing systems, Standards and legislation, Competing systems. Also valid: existing documentation, documentation about interfacing systems.",
                    ar: "أصحاب المصلحة، الأنظمة الموجودة، المعايير والتشريعات، الأنظمة المنافسة. أيضاً صحيح: الوثائق الموجودة، وثائق الأنظمة المتصلة."
                }
            },
            q4: {
                correct: 'c',
                explanation: {
                    en: "Reaching many people with low resources is a strength of questionnaires, not interviews. Interviews are time-consuming and typically one-on-one or small groups.",
                    ar: "الوصول لعدد كبير من الناس بموارد محدودة هو ميزة للاستبيانات وليس للمقابلات. المقابلات مستهلكة للوقت وعادة تكون فردية أو بمجموعات صغيرة."
                },
                modelAnswer: {
                    en: "Can reach many people with low resources - This is a strength of questionnaires, not interviews.",
                    ar: "يمكن الوصول لعدد كبير من الناس بموارد محدودة - هذه ميزة للاستبيانات وليس للمقابلات."
                }
            },
            q5: {
                correct: 'b',
                explanation: {
                    en: "Fidelity refers to how real and reactive (functional) the prototype is. High-fidelity prototypes are fully functional; low-fidelity are static or non-functional.",
                    ar: "الدقة تشير إلى مدى واقعية وتفاعلية (وظيفية) النموذج الأولي. النماذج عالية الدقة وظيفية بالكامل؛ منخفضة الدقة ثابتة أو غير وظيفية."
                },
                modelAnswer: {
                    en: "The extent to which the prototype is real and reactive - Fidelity varies in level for throwaway prototypes.",
                    ar: "مدى واقعية وتفاعلية النموذج الأولي - تتفاوت الدقة في المستوى للنماذج الأولية القابلة للتخلص."
                }
            },
            q6: {
                correct: 'b',
                explanation: {
                    en: "A use case describes interactions between the system and external actors to achieve a goal of value. It's a user-centric technique for exploring requirements.",
                    ar: "حالة الاستخدام تصف التفاعلات بين النظام والفاعلين الخارجيين لتحقيق هدف ذي قيمة. إنها تقنية موجهة للمستخدم لاستكشاف المتطلبات."
                },
                modelAnswer: {
                    en: "A sequence of interactions between a system and an external actor that results in an outcome of value.",
                    ar: "سلسلة من التفاعلات بين النظام وفاعل خارجي تؤدي إلى نتيجة ذات قيمة."
                }
            },
            q7: {
                correct: 'b',
                explanation: {
                    en: "Misuse cases capture scenarios that the system must be protected against. They are useful for eliciting security and safety requirements and identifying threats early.",
                    ar: "حالات سوء الاستخدام تلتقط السيناريوهات التي يجب حماية النظام منها. مفيدة لاستخلاص متطلبات الأمن والسلامة وتحديد التهديدات مبكراً."
                },
                modelAnswer: {
                    en: "Eliciting security and safety requirements - They help identify threats, mitigations, and exceptions early.",
                    ar: "استخلاص متطلبات الأمن والسلامة - تساعد في تحديد التهديدات والتخفيفات والاستثناءات مبكراً."
                }
            },
            q8: {
                correct: 'd',
                explanation: {
                    en: "All these signs indicate you're reaching completion: users can't think of more use cases, new items are out of scope, users repeat themselves, and requirements are low priority.",
                    ar: "كل هذه العلامات تشير إلى اقترابك من الانتهاء: المستخدمون لا يفكرون بمزيد من حالات الاستخدام، العناصر الجديدة خارج النطاق، المستخدمون يكررون أنفسهم، والمتطلبات ذات أولوية منخفضة."
                },
                modelAnswer: {
                    en: "All of the above - These are all valid indicators that elicitation is nearing completion.",
                    ar: "كل ما سبق - هذه جميعها مؤشرات صحيحة على اقتراب الاستخلاص من الانتهاء."
                }
            },
            q9: {
                keywords: {
                    en: ['interviews', 'prototyping', 'observation', 'questionnaires', 'workshops', 'focus groups', 
                         'stakeholders', 'users', 'customers', 'developers', 'domain experts',
                         'suitable', 'appropriate', 'implement', 'practice'],
                    ar: ['مقابلات', 'نماذج', 'ملاحظة', 'استبيان', 'ورش', 'مجموعات', 
                         'معنيين', 'مستخدمين', 'عملاء', 'مطورين', 'خبراء',
                         'مناسب', 'ملائم', 'تطبيق', 'عملي']
                },
                modelAnswer: {
                    en: `Example answer structure:
1. INTERVIEWS: 
   - Suitable because: Can gather detailed requirements from bank managers and potential users about security, features, and user experience
   - Stakeholders: Bank managers, existing customers, compliance officers
   - Implementation: Conduct one-on-one interviews with 10-15 stakeholders, prepare structured questions about mobile banking needs, security concerns, and desired features

2. PROTOTYPING:
   - Suitable because: Mobile apps are visual and interactive, prototypes help validate UI/UX early
   - Stakeholders: End users (customers), UI/UX designers, developers
   - Implementation: Create low-fidelity paper prototypes or high-fidelity interactive prototypes using tools like Figma, have users test the prototype and gather feedback

3. FOCUS GROUPS:
   - Suitable because: Can explore attitudes and preferences of different customer segments (young professionals, seniors, business owners)
   - Stakeholders: Representative groups of potential users from different demographics
   - Implementation: Organize 3-4 focus group sessions with 6-8 participants each, facilitate discussions about banking habits, mobile app preferences, and security concerns`,
                    ar: `مثال لهيكل الإجابة:
١. المقابلات:
   - مناسبة لأن: يمكن جمع متطلبات تفصيلية من مدراء البنوك والمستخدمين المحتملين حول الأمان والميزات وتجربة المستخدم
   - المعنيون: مدراء البنوك، العملاء الحاليون، مسؤولو الامتثال
   - التطبيق: إجراء مقابلات فردية مع ١٠-١٥ من المعنيين، إعداد أسئلة منظمة حول احتياجات الخدمات المصرفية عبر الجوال والمخاوف الأمنية والميزات المرغوبة

٢. النماذج الأولية:
   - مناسبة لأن: تطبيقات الجوال مرئية وتفاعلية، والنماذج الأولية تساعد في التحقق من واجهة المستخدم/تجربة المستخدم مبكراً
   - المعنيون: المستخدمون النهائيون (العملاء)، مصممو واجهة المستخدم، المطورون
   - التطبيق: إنشاء نماذج أولية منخفضة الدقة أو نماذج تفاعلية عالية الدقة باستخدام أدوات مثل Figma، جعل المستخدمين يختبرون النموذج وجمع التعليقات

٣. المجموعات البؤرية:
   - مناسبة لأن: يمكن استكشاف مواقف وتفضيلات شرائح مختلفة من العملاء (الشباب المهنيون، كبار السن، أصحاب الأعمال)
   - المعنيون: مجموعات ممثلة للمستخدمين المحتملين من فئات سكانية مختلفة
   - التطبيق: تنظيم ٣-٤ جلسات مجموعة بؤرية مع ٦-٨ مشاركين في كل جلسة، تيسير المناقشات حول عادات الخدمات المصرفية وتفضيلات تطبيقات الجوال والمخاوف الأمنية`
                }
            },
            q10: {
                keywords: {
                    en: ['scope', 'requirements', 'stakeholders', 'understanding', 'availability', 'technical', 'knowledge',
                         'mitigation', 'strategy', 'challenge', 'problem', 'solution'],
                    ar: ['نطاق', 'متطلبات', 'معنيين', 'فهم', 'توفر', 'تقني', 'معرفة',
                         'تخفيف', 'استراتيجية', 'تحدي', 'مشكلة', 'حل']
                },
                modelAnswer: {
                    en: `Three main challenges and mitigations:

1. SCOPE CHALLENGES:
   - Challenge: System boundaries inadequately or incorrectly defined, difficult to maintain focus on scope
   - Mitigation: Re-check scope before each session, use "in-scope" and "out-of-scope" labels clearly, involve stakeholders in scope definition early

2. REQUIREMENTS CHALLENGES:
   - Challenge: Assumed, implied, or missing requirements; uncertainty about what is needed
   - Mitigation: Ask "What are we assuming here?", conduct thorough analysis, use multiple elicitation techniques to cross-validate

3. STAKEHOLDER CHALLENGES:
   - Challenge: Limited availability, lack of cooperation, conflicting views, insufficient technical knowledge
   - Mitigation: Develop strong BA interpersonal and communication skills, schedule meetings in advance, involve management support, provide education on system capabilities`,
                    ar: `ثلاثة تحديات رئيسية والتخفيفات:

١. تحديات النطاق:
   - التحدي: حدود النظام محددة بشكل غير كاف أو غير صحيح، صعوبة الحفاظ على التركيز على النطاق
   - التخفيف: إعادة التحقق من النطاق قبل كل جلسة، استخدام تسميات "ضمن النطاق" و"خارج النطاق" بوضوح، إشراك المعنيين في تحديد النطاق مبكراً

٢. تحديات المتطلبات:
   - التحدي: متطلبات مفترضة أو ضمنية أو مفقودة؛ عدم اليقين بشأن ما هو مطلوب
   - التخفيف: طرح سؤال "ما الذي نفترضه هنا؟"، إجراء تحليل شامل، استخدام تقنيات استخلاص متعددة للتحقق المتبادل

٣. تحديات المعنيين:
   - التحدي: توفر محدود، نقص التعاون، آراء متضاربة، معرفة تقنية غير كافية
   - التخفيف: تطوير مهارات شخصية وتواصلية قوية لمحلل الأعمال، جدولة الاجتماعات مسبقاً، إشراك دعم الإدارة، توفير التعليم حول قدرات النظام`
                }
            },
            q11: {
                correct: 'b',
                explanation: {
                    en: "Questionnaires are inexpensive and can reach large user populations easily across geographical boundaries. They don't facilitate detailed follow-up or guarantee high response rates.",
                    ar: "الاستبيانات غير مكلفة ويمكنها الوصول لعدد كبير من المستخدمين بسهولة عبر الحدود الجغرافية. لا تسهل المتابعة التفصيلية ولا تضمن معدلات استجابة عالية."
                },
                modelAnswer: {
                    en: "Can reach large user populations easily - Questionnaires are suitable for eliciting information from large user populations across geographical boundaries.",
                    ar: "يمكن الوصول لعدد كبير من المستخدمين بسهولة - الاستبيانات مناسبة لاستخلاص المعلومات من عدد كبير من المستخدمين عبر الحدود الجغرافية."
                }
            },
            q12: {
                correct: 'a',
                explanation: {
                    en: "Focus groups are particularly valuable for developing commercial products as they help explore users' attitudes, impressions, preferences, and needs. They don't make final decisions.",
                    ar: "المجموعات البؤرية ذات قيمة خاصة في تطوير المنتجات التجارية لأنها تساعد في استكشاف مواقف المستخدمين وانطباعاتهم وتفضيلاتهم واحتياجاتهم. لا تتخذ القرارات النهائية."
                },
                modelAnswer: {
                    en: "Developing commercial products - Focus groups generate subjective feedback that can be evaluated and prioritized during requirements development.",
                    ar: "تطوير المنتجات التجارية - المجموعات البؤرية تولد تعليقات ذاتية يمكن تقييمها وترتيب أولوياتها أثناء تطوير المتطلبات."
                }
            },
            q13: {
                keywords: {
                    en: ['plan', 'planning', 'prepare', 'preparation', 'perform', 'performing', 'follow-up', 'follow up',
                         'elicitation', 'activities', 'objectives', 'stakeholders', 'notes', 'review'],
                    ar: ['تخطيط', 'خطة', 'تحضير', 'إعداد', 'تنفيذ', 'أداء', 'متابعة',
                         'استخلاص', 'أنشطة', 'أهداف', 'معنيين', 'ملاحظات', 'مراجعة']
                },
                modelAnswer: {
                    en: `Four main phases of elicitation process:

1. PLANNING FOR ELICITATION: Define objectives, select strategies and techniques, schedule resources, identify independent elicitation needs, determine expected products, and assess risks

2. PREPARE FOR ELICITATION: Decide on scope and agenda, prepare resources (physical, participants, documentation), identify stakeholders and their preferences, prepare questions, and draft analysis models

3. PERFORM ELICITATION ACTIVITIES: Conduct the actual elicitation sessions (interviews, workshops, etc.), take good notes documenting attendees, decisions, actions, and key points

4. FOLLOW-UP AFTER ELICITATION: Review and update notes right after sessions, consolidate input from multiple sources, edit notes carefully while keeping originals, review with stakeholders, document open issues and gaps`,
                    ar: `المراحل الأربع الرئيسية لعملية الاستخلاص:

١. التخطيط للاستخلاص: تحديد الأهداف، اختيار الاستراتيجيات والتقنيات، جدولة الموارد، تحديد احتياجات الاستخلاص المستقلة، تحديد المنتجات المتوقعة، وتقييم المخاطر

٢. التحضير للاستخلاص: تحديد النطاق وجدول الأعمال، إعداد الموارد (مادية، مشاركين، وثائق)، تحديد المعنيين وتفضيلاتهم، إعداد الأسئلة، وصياغة نماذج التحليل

٣. تنفيذ أنشطة الاستخلاص: إجراء جلسات الاستخلاص الفعلية (مقابلات، ورش عمل، إلخ)، تدوين ملاحظات جيدة توثق الحضور والقرارات والإجراءات والنقاط الرئيسية

٤. المتابعة بعد الاستخلاص: مراجعة وتحديث الملاحظات مباشرة بعد الجلسات، دمج المدخلات من مصادر متعددة، تحرير الملاحظات بعناية مع الاحتفاظ بالنسخ الأصلية، المراجعة مع المعنيين، توثيق القضايا المفتوحة والفجوات`
                }
            }
        };

        // Grade exam function
        function gradeExam() {
     
            let totalScore = 0;
            const maxScore = 30;

            // Grade Q1
            const q1Answer = document.querySelector('input[name="q1"]:checked');
            gradeMultipleChoice('q1', q1Answer, 2);

            // Grade Q2
            const q2Answer = document.querySelector('input[name="q2"]:checked');
            gradeMultipleChoice('q2', q2Answer, 2);

            // Grade Q3
            const q3Answers = document.querySelectorAll('input[name="q3"]:checked');
            gradeMultipleSelect('q3', q3Answers, 3);

            // Grade Q4
            const q4Answer = document.querySelector('input[name="q4"]:checked');
            gradeMultipleChoice('q4', q4Answer, 2);

            // Grade Q5
            const q5Answer = document.querySelector('input[name="q5"]:checked');
            gradeMultipleChoice('q5', q5Answer, 2);

            // Grade Q6
            const q6Answer = document.querySelector('input[name="q6"]:checked');
            gradeMultipleChoice('q6', q6Answer, 2);

            // Grade Q7
            const q7Answer = document.querySelector('input[name="q7"]:checked');
            gradeMultipleChoice('q7', q7Answer, 2);

            // Grade Q8
            const q8Answer = document.querySelector('input[name="q8"]:checked');
            gradeMultipleChoice('q8', q8Answer, 2);

            // Grade Q9
            const q9Answer = document.querySelector('textarea[name="q9"]').value;
            gradeShortAnswer('q9', q9Answer, 4);

            // Grade Q10
            const q10Answer = document.querySelector('textarea[name="q10"]').value;
            gradeShortAnswer('q10', q10Answer, 3);

            // Grade Q11
            const q11Answer = document.querySelector('input[name="q11"]:checked');
            gradeMultipleChoice('q11', q11Answer, 2);

            // Grade Q12
            const q12Answer = document.querySelector('input[name="q12"]:checked');
            gradeMultipleChoice('q12', q12Answer, 2);

            // Grade Q13
            const q13Answer = document.querySelector('textarea[name="q13"]').value;
            gradeShortAnswer('q13', q13Answer, 3);

            // Calculate total score
            document.querySelectorAll('.feedback').forEach(feedback => {
                const score = parseFloat(feedback.dataset.score || 0);
                totalScore += score;
            });

            // Display score
            document.getElementById('finalScore').textContent = `${totalScore.toFixed(1)} / ${maxScore}`;
            document.getElementById('scoreDisplay').classList.add('show');

            // Scroll to score
            document.getElementById('scoreDisplay').scrollIntoView({ behavior: 'smooth' });

            // Disable submit button
            event.target.disabled = true;
        }

        function gradeMultipleChoice(questionId, answer, points) {
            const feedback = document.querySelector(`.feedback[data-question="${questionId.replace('q', '')}"]`);
            const correctAnswer = answerKey[questionId].correct;
            
            if (!answer) {
                showFeedback(feedback, 'incorrect', 0, questionId, currentLang === 'en' ? 
                    'No answer selected.' : 
                    'لم يتم تحديد إجابة.');
                return;
            }

            if (answer.value === correctAnswer) {
                showFeedback(feedback, 'correct', points, questionId, currentLang === 'en' ? 
                    '✓ Correct!' : 
                    '✓ صحيح!');
            } else {
                showFeedback(feedback, 'incorrect', 0, questionId, currentLang === 'en' ? 
                    '✗ Incorrect.' : 
                    '✗ خطأ.');
            }
        }

        function gradeMultipleSelect(questionId, answers, points) {
            const feedback = document.querySelector(`.feedback[data-question="${questionId.replace('q', '')}"]`);
            const correctAnswers = answerKey[questionId].correct;
            
            if (answers.length === 0) {
                showFeedback(feedback, 'incorrect', 0, questionId, currentLang === 'en' ? 
                    'No answers selected.' : 
                    'لم يتم تحديد أي إجابات.');
                return;
            }

            const selectedValues = Array.from(answers).map(a => a.value).sort();
            const correctValues = correctAnswers.sort();

            if (JSON.stringify(selectedValues) === JSON.stringify(correctValues)) {
                showFeedback(feedback, 'correct', points, questionId, currentLang === 'en' ? 
                    '✓ All correct!' : 
                    '✓ جميع الإجابات صحيحة!');
            } else {
                const correctCount = selectedValues.filter(v => correctValues.includes(v)).length;
                const incorrectCount = selectedValues.filter(v => !correctValues.includes(v)).length;
                const missedCount = correctValues.filter(v => !selectedValues.includes(v)).length;
                
                const partialScore = Math.max(0, (correctCount - incorrectCount) / correctValues.length * points);
                
                if (partialScore > 0) {
                    showFeedback(feedback, 'partial', partialScore, questionId, currentLang === 'en' ? 
                        `⚠ Partial credit: ${correctCount} correct, ${incorrectCount} incorrect, ${missedCount} missed.` :
                        `⚠ درجة جزئية: ${correctCount} صحيحة، ${incorrectCount} خاطئة، ${missedCount} مفقودة.`);
                } else {
                    showFeedback(feedback, 'incorrect', 0, questionId, currentLang === 'en' ? 
                        '✗ Incorrect selections.' : 
                        '✗ اختيارات خاطئة.');
                }
            }
        }

        function gradeShortAnswer(questionId, answer, points) {
            const feedback = document.querySelector(`.feedback[data-question="${questionId.replace('q', '')}"]`);
            
            if (!answer.trim()) {
                showFeedback(feedback, 'incorrect', 0, questionId, currentLang === 'en' ? 
                    'No answer provided.' : 
                    'لم يتم تقديم إجابة.');
                return;
            }

            const keywords = answerKey[questionId].keywords[currentLang];
            const answerLower = answer.toLowerCase();
            const matchedKeywords = keywords.filter(keyword => 
                answerLower.includes(keyword.toLowerCase())
            );

            const score = Math.min(points, (matchedKeywords.length / keywords.length) * points);
            
            if (score >= points * 0.8) {
                showFeedback(feedback, 'correct', score, questionId, currentLang === 'en' ? 
                    `✓ Excellent answer! Covered ${matchedKeywords.length} key concepts.` :
                    `✓ إجابة ممتازة! غطت ${matchedKeywords.length} من المفاهيم الرئيسية.`);
            } else if (score >= points * 0.5) {
                showFeedback(feedback, 'partial', score, questionId, currentLang === 'en' ? 
                    `⚠ Good effort! Covered ${matchedKeywords.length} key concepts. Review model answer for missing points.` :
                    `⚠ جهد جيد! غطت ${matchedKeywords.length} من المفاهيم الرئيسية. راجع الإجابة النموذجية للنقاط المفقودة.`);
            } else {
                showFeedback(feedback, 'partial', score, questionId, currentLang === 'en' ? 
                    `⚠ Needs improvement. Covered ${matchedKeywords.length} key concepts. Please review model answer.` :
                    `⚠ يحتاج إلى تحسين. غطت ${matchedKeywords.length} من المفاهيم الرئيسية. يرجى مراجعة الإجابة النموذجية.`);
            }
        }

        function showFeedback(feedbackElement, type, score, questionId, message) {
            feedbackElement.className = `feedback ${type}`;
            feedbackElement.dataset.score = score;
            
            const explanation = answerKey[questionId].explanation[currentLang];
            const modelAnswer = answerKey[questionId].modelAnswer[currentLang];
            
            feedbackElement.innerHTML = `
                <div class="feedback-header">
                    <span class="feedback-icon">${type === 'correct' ? '✓' : type === 'partial' ? '⚠' : '✗'}</span>
                    <span>${message} (${currentLang === 'en' ? 'Score' : 'الدرجة'}: ${score})</span>
                </div>
                <div style="margin-top: 8px;">${explanation}</div>
                <div class="model-answer">
                    <div class="model-answer-label">
                        ${currentLang === 'en' ? '📝 Model Answer:' : '📝 الإجابة النموذجية:'}
                    </div>
                    <div style="white-space: pre-line;">${modelAnswer}</div>
                </div>
            `;
        }
    </script>
</body>
</html>