<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CS340 Database Systems - Exam</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #3b82f6;
            --primary-dark: #2563eb;
            --primary-light: #60a5fa;
            --success: #10b981;
            --success-dark: #059669;
            --danger: #ef4444;
            --danger-dark: #dc2626;
            --warning: #f59e0b;
            --warning-dark: #d97706;
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --bg-tertiary: #f1f5f9;
            --text-primary: #0f172a;
            --text-secondary: #475569;
            --text-tertiary: #94a3b8;
            --border: #e2e8f0;
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            --radius-sm: 6px;
            --radius: 10px;
            --radius-lg: 16px;
        }

        .dark-mode {
            --primary: #60a5fa;
            --primary-dark: #3b82f6;
            --primary-light: #93c5fd;
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --bg-tertiary: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #cbd5e1;
            --text-tertiary: #94a3b8;
            --border: #334155;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--bg-secondary);
            color: var(--text-primary);
            line-height: 1.6;
            transition: background 0.3s, color 0.3s;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header Styles */
        header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            padding: 48px 40px;
            border-radius: var(--radius-lg);
            margin-bottom: 32px;
            box-shadow: var(--shadow-xl);
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg width="100" height="100" xmlns="http://www.w3.org/2000/svg"><defs><pattern id="grid" width="40" height="40" patternUnits="userSpaceOnUse"><path d="M 40 0 L 0 0 0 40" fill="none" stroke="rgba(255,255,255,0.05)" stroke-width="1"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
            opacity: 0.5;
        }

        header .content {
            position: relative;
            z-index: 1;
        }

        h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 8px;
            letter-spacing: -0.025em;
        }

        .subtitle {
            font-size: 1.125rem;
            opacity: 0.9;
            font-weight: 400;
        }

        .header-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 16px;
            margin-top: 32px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            padding: 20px;
            border-radius: var(--radius);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .stat-label {
            font-size: 0.875rem;
            opacity: 0.8;
            margin-bottom: 4px;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
        }

        /* Control Bar */
        .control-bar {
            background: var(--bg-primary);
            padding: 20px;
            border-radius: var(--radius-lg);
            margin-bottom: 24px;
            box-shadow: var(--shadow);
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 20px;
            z-index: 100;
        }

        .controls-left, .controls-right {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        /* Buttons */
        button {
            padding: 12px 24px;
            border: none;
            border-radius: var(--radius);
            font-size: 0.9375rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-family: inherit;
            white-space: nowrap;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-success:hover {
            background: var(--success-dark);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .btn-outline {
            background: transparent;
            color: var(--text-primary);
            border: 2px solid var(--border);
        }

        .btn-outline:hover {
            background: var(--bg-tertiary);
            border-color: var(--primary);
            color: var(--primary);
        }

        /* Progress Bar */
        .progress-container {
            background: var(--bg-primary);
            padding: 24px;
            border-radius: var(--radius-lg);
            margin-bottom: 24px;
            box-shadow: var(--shadow);
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .progress-label {
            font-weight: 600;
            font-size: 0.9375rem;
        }

        .progress-stat {
            color: var(--text-secondary);
            font-size: 0.875rem;
        }

        .progress-bar {
            height: 12px;
            background: var(--bg-tertiary);
            border-radius: 100px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--success), var(--primary));
            border-radius: 100px;
            transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        /* Section Styles */
        .section {
            background: var(--bg-primary);
            border-radius: var(--radius-lg);
            margin-bottom: 24px;
            box-shadow: var(--shadow);
            overflow: hidden;
            transition: all 0.3s;
        }

        .section-header {
            padding: 24px 32px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--border);
            user-select: none;
            transition: all 0.2s;
        }

        .section-header:hover {
            background: var(--bg-secondary);
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .section-badge {
            background: var(--primary);
            color: white;
            padding: 4px 12px;
            border-radius: 100px;
            font-size: 0.875rem;
            font-weight: 600;
        }

        .toggle-icon {
            font-size: 1.25rem;
            transition: transform 0.3s;
            color: var(--text-tertiary);
        }

        .section.collapsed .toggle-icon {
            transform: rotate(-90deg);
        }

        .section.collapsed .section-content {
            display: none;
        }

        .section-content {
            padding: 32px;
        }

        /* Question Styles */
        .question {
            margin-bottom: 32px;
            padding: 28px;
            background: var(--bg-secondary);
            border-radius: var(--radius-lg);
            border: 1px solid var(--border);
            transition: all 0.3s;
        }

        .question:hover {
            box-shadow: var(--shadow-lg);
            border-color: var(--primary-light);
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            gap: 16px;
            flex-wrap: wrap;
        }

        .question-number {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            padding: 8px 20px;
            border-radius: 100px;
            font-weight: 700;
            font-size: 0.9375rem;
            letter-spacing: 0.025em;
        }

        .question-points {
            color: var(--text-tertiary);
            font-size: 0.875rem;
            font-weight: 600;
            background: var(--bg-tertiary);
            padding: 6px 16px;
            border-radius: 100px;
        }

        .question-text {
            font-size: 1.0625rem;
            margin-bottom: 24px;
            line-height: 1.7;
            color: var(--text-primary);
        }

        .question-text ol, .question-text ul {
            margin-left: 24px;
            margin-top: 12px;
        }

        .question-text li {
            margin: 8px 0;
        }

        /* Option Styles */
        .options {
            margin: 20px 0;
        }

        .option {
            margin: 10px 0;
            padding: 16px 20px;
            border-radius: var(--radius);
            cursor: pointer;
            transition: all 0.2s;
            border: 2px solid var(--border);
            background: var(--bg-primary);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .option:hover {
            border-color: var(--primary);
            background: var(--bg-secondary);
            transform: translateX(4px);
        }

        .option input[type="radio"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
            accent-color: var(--primary);
        }

        .option label {
            cursor: pointer;
            flex: 1;
            font-size: 0.9375rem;
        }

        /* Textarea */
        textarea {
            width: 100%;
            min-height: 180px;
            padding: 20px;
            border: 2px solid var(--border);
            border-radius: var(--radius-lg);
            font-family: inherit;
            font-size: 0.9375rem;
            background: var(--bg-primary);
            color: var(--text-primary);
            resize: vertical;
            transition: all 0.2s;
            line-height: 1.6;
        }

        textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1);
        }

        /* Code Block */
        .code-block {
            background: #1e293b;
            color: #e2e8f0;
            padding: 24px;
            border-radius: var(--radius-lg);
            overflow-x: auto;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.875rem;
            line-height: 1.7;
            border: 1px solid #334155;
        }

        /* Feedback Styles */
        .feedback {
            margin-top: 20px;
            padding: 0;
            border-radius: var(--radius-lg);
            display: none;
            overflow: hidden;
        }

        .feedback.show {
            display: block;
            animation: slideDown 0.3s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .feedback.correct {
            background: linear-gradient(to right, #d1fae5, #a7f3d0);
            border: 2px solid var(--success);
        }

        .feedback.incorrect {
            background: linear-gradient(to right, #fee2e2, #fecaca);
            border: 2px solid var(--danger);
        }

        .feedback.partial {
            background: linear-gradient(to right, #fef3c7, #fde68a);
            border: 2px solid var(--warning);
        }

        .model-answer {
            padding: 24px;
        }

        .model-answer-title {
            font-weight: 700;
            font-size: 1.0625rem;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .feedback.correct .model-answer-title {
            color: #065f46;
        }

        .feedback.incorrect .model-answer-title {
            color: #991b1b;
        }

        .feedback.partial .model-answer-title {
            color: #92400e;
        }

        .explanation {
            background: rgba(59, 130, 246, 0.1);
            padding: 20px;
            border-radius: var(--radius);
            margin-top: 16px;
            border-left: 4px solid var(--primary);
        }

        /* Keywords */
        .keywords {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 16px;
        }

        .keyword {
            padding: 6px 14px;
            border-radius: 100px;
            font-size: 0.875rem;
            font-weight: 600;
        }

        .keyword.found {
            background: #d1fae5;
            color: #065f46;
            border: 1px solid #10b981;
        }

        .keyword.missing {
            background: #fee2e2;
            color: #991b1b;
            border: 1px solid #ef4444;
        }

        /* Score Card */
        .score-card {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            padding: 48px;
            border-radius: var(--radius-lg);
            text-align: center;
            margin-top: 48px;
            display: none;
            box-shadow: var(--shadow-xl);
        }

        .score-card.show {
            display: block;
            animation: popIn 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        @keyframes popIn {
            0% {
                opacity: 0;
                transform: scale(0.8);
            }
            100% {
                opacity: 1;
                transform: scale(1);
            }
        }

        .score-card h2 {
            font-size: 2rem;
            margin-bottom: 24px;
        }

        .score-number {
            font-size: 5rem;
            font-weight: 800;
            margin: 32px 0;
            line-height: 1;
            text-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .score-breakdown {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 32px;
        }

        .score-item {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            padding: 24px;
            border-radius: var(--radius-lg);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .score-item-label {
            font-size: 0.875rem;
            opacity: 0.9;
            margin-bottom: 8px;
        }

        .score-item-value {
            font-size: 1.75rem;
            font-weight: 700;
        }

        /* Table */
        table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            margin: 20px 0;
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
        }

        th, td {
            padding: 16px;
            text-align: left;
        }

        th {
            background: var(--primary);
            color: white;
            font-weight: 600;
            font-size: 0.9375rem;
        }

        td {
            border-bottom: 1px solid var(--border);
        }

        tr:last-child td {
            border-bottom: none;
        }

        tr:hover td {
            background: var(--bg-secondary);
        }

        /* Timer */
        .timer {
            background: var(--bg-primary);
            padding: 12px 24px;
            border-radius: 100px;
            box-shadow: var(--shadow-lg);
            font-size: 1rem;
            font-weight: 700;
            border: 2px solid var(--border);
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 12px;
            }

            header {
                padding: 32px 24px;
            }

            h1 {
                font-size: 1.875rem;
            }

            .section-content {
                padding: 20px;
            }

            .question {
                padding: 20px;
            }

            .control-bar {
                position: static;
                flex-direction: column;
            }

            .controls-left, .controls-right {
                width: 100%;
            }

            button {
                width: 100%;
                justify-content: center;
            }

            .score-number {
                font-size: 3.5rem;
            }
        }

        @media print {
            .control-bar, .timer {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="content">
                <h1>üéì CS340 Database Systems</h1>
                <p class="subtitle">Comprehensive Final Examination</p>
                <div class="header-stats">
                    <div class="stat-card">
                        <div class="stat-label">Course Code</div>
                        <div class="stat-value">CS340</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Total Points</div>
                        <div class="stat-value" id="totalPoints">100</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Total Questions</div>
                        <div class="stat-value">30</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Duration</div>
                        <div class="stat-value">180 min</div>
                    </div>
                </div>
            </div>
        </header>

        <div class="control-bar">
            <div class="controls-left">
                <button class="btn-outline" onclick="toggleDarkMode()">
                    <span id="modeIcon">üåô</span> <span id="modeText">Dark Mode</span>
                </button>
                <div class="timer" id="timer">
                    ‚è±Ô∏è <span>00:00:00</span>
                </div>
            </div>
            <div class="controls-right">
                <button class="btn-success" onclick="showAllAnswers()">
                    üëÅÔ∏è Show Answers
                </button>
                <button class="btn-primary" onclick="submitAll()">
                    üìä Submit Exam
                </button>
            </div>
        </div>

        <div class="progress-container">
            <div class="progress-header">
                <span class="progress-label">Your Progress</span>
                <span class="progress-stat" id="progressText">0/30 answered</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 0%"></div>
            </div>
        </div>

        <!-- Section 1: Multiple Choice -->
        <div class="section" id="section1">
            <div class="section-header" onclick="toggleSection('section1')">
                <div class="section-title">
                    üìã Multiple Choice Questions
                    <span class="section-badge">25 marks</span>
                </div>
                <span class="toggle-icon">‚ñº</span>
            </div>
            <div class="section-content">
                <!-- Question 1 -->
                <div class="question" data-type="mcq" data-answer="b" data-points="2.5">
                    <div class="question-header">
                        <span class="question-number">Q1</span>
                        <span class="question-points">2.5 marks</span>
                    </div>
                    <div class="question-text">
                        Choose the steps for designing and implementing a database in the correct order:
                        <ol>
                            <li>Create your own application</li>
                            <li>Decide how to query</li>
                            <li>Logical modeling</li>
                            <li>Conceptual modeling</li>
                            <li>Optimize the design</li>
                        </ol>
                    </div>
                    <div class="options">
                        <div class="option">
                            <input type="radio" name="q1" value="a" id="q1a">
                            <label for="q1a">III, IV, II, V, I</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q1" value="b" id="q1b">
                            <label for="q1b">IV, III, V, II, I</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q1" value="c" id="q1c">
                            <label for="q1c">V, III, IV, II, I</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q1" value="d" id="q1d">
                            <label for="q1d">III, IV, V, II, I</label>
                        </div>
                    </div>
                    <button class="btn-primary" onclick="checkMCQ('q1')">Check Answer</button>
                    <div class="feedback" id="feedback-q1">
                        <div class="model-answer">
                            <div class="model-answer-title">‚úì Correct Answer: B</div>
                            <p>The proper database design sequence is: Conceptual modeling (ER diagrams) ‚Üí Logical modeling (relational schema) ‚Üí Optimize (normalization) ‚Üí Query design (SQL) ‚Üí Application development.</p>
                        </div>
                        <div class="explanation">
                            <strong>Why this order?</strong> Database design follows a top-down approach, starting from abstract concepts and moving to concrete implementation.
                        </div>
                    </div>
                </div>

                <!-- Question 2 -->
                <div class="question" data-type="mcq" data-answer="b" data-points="2.5">
                    <div class="question-header">
                        <span class="question-number">Q2</span>
                        <span class="question-points">2.5 marks</span>
                    </div>
                    <div class="question-text">
                        Storing the same data in many places is called:
                    </div>
                    <div class="options">
                        <div class="option">
                            <input type="radio" name="q2" value="a" id="q2a">
                            <label for="q2a">Iteration</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q2" value="b" id="q2b">
                            <label for="q2b">Redundancy</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q2" value="c" id="q2c">
                            <label for="q2c">Concurrency</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q2" value="d" id="q2d">
                            <label for="q2d">Multiplication</label>
                        </div>
                    </div>
                    <button class="btn-primary" onclick="checkMCQ('q2')">Check Answer</button>
                    <div class="feedback" id="feedback-q2">
                        <div class="model-answer">
                            <div class="model-answer-title">‚úì Correct Answer: B - Redundancy</div>
                            <p>Redundancy leads to data inconsistency and wastes storage.</p>
                        </div>
                    </div>
                </div>

                <!-- Question 3 -->
                <div class="question" data-type="mcq" data-answer="a" data-points="2.5">
                    <div class="question-header">
                        <span class="question-number">Q3</span>
                        <span class="question-points">2.5 marks</span>
                    </div>
                    <div class="question-text">
                        Which enables users to modify data structures without affecting existing programs?
                    </div>
                    <div class="options">
                        <div class="option">
                            <input type="radio" name="q3" value="a" id="q3a">
                            <label for="q3a">Data independence</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q3" value="b" id="q3b">
                            <label for="q3b">Data dependence</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q3" value="c" id="q3c">
                            <label for="q3c">Data relationships</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q3" value="d" id="q3d">
                            <label for="q3d">Data Integration</label>
                        </div>
                    </div>
                    <button class="btn-primary" onclick="checkMCQ('q3')">Check Answer</button>
                    <div class="feedback" id="feedback-q3">
                        <div class="model-answer">
                            <div class="model-answer-title">‚úì Correct Answer: A - Data Independence</div>
                            <p>Allows schema changes at one level without affecting higher levels.</p>
                        </div>
                    </div>
                </div>

                <!-- Question 4 -->
                <div class="question" data-type="mcq" data-answer="d" data-points="2.5">
                    <div class="question-header">
                        <span class="question-number">Q4</span>
                        <span class="question-points">2.5 marks</span>
                    </div>
                    <div class="question-text">
                        What is TRUE about the Conceptual level?
                    </div>
                    <div class="options">
                        <div class="option">
                            <input type="radio" name="q4" value="a" id="q4a">
                            <label for="q4a">Describes database structure conceptually</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q4" value="b" id="q4b">
                            <label for="q4b">Describes what data is stored and relationships</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q4" value="c" id="q4c">
                            <label for="q4c">Hides implementation details</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q4" value="d" id="q4d">
                            <label for="q4d">All of the above</label>
                        </div>
                    </div>
                    <button class="btn-primary" onclick="checkMCQ('q4')">Check Answer</button>
                    <div class="feedback" id="feedback-q4">
                        <div class="model-answer">
                            <div class="model-answer-title">‚úì Correct Answer: D - All of the above</div>
                            <p>The conceptual level provides a complete abstract view of the database.</p>
                        </div>
                    </div>
                </div>

                <!-- Question 5 -->
                <div class="question" data-type="mcq" data-answer="c" data-points="2.5">
                    <div class="question-header">
                        <span class="question-number">Q5</span>
                        <span class="question-points">2.5 marks</span>
                    </div>
                    <div class="question-text">
                        Which architecture is common for web applications?
                    </div>
                    <div class="options">
                        <div class="option">
                            <input type="radio" name="q5" value="a" id="q5a">
                            <label for="q5a">One tier</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q5" value="b" id="q5b">
                            <label for="q5b">Two tiers</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q5" value="c" id="q5c">
                            <label for="q5c">Three tiers</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q5" value="d" id="q5d">
                            <label for="q5d">Centralized</label>
                        </div>
                    </div>
                    <button class="btn-primary" onclick="checkMCQ('q5')">Check Answer</button>
                    <div class="feedback" id="feedback-q5">
                        <div class="model-answer">
                            <div class="model-answer-title">‚úì Correct Answer: C - Three tiers</div>
                            <p>Presentation ‚Üí Business Logic ‚Üí Data layers.</p>
                        </div>
                    </div>
                </div>

                <!-- Question 6 -->
                <div class="question" data-type="mcq" data-answer="d" data-points="2.5">
                    <div class="question-header">
                        <span class="question-number">Q6</span>
                        <span class="question-points">2.5 marks</span>
                    </div>
                    <div class="question-text">
                        Which ACID property ensures committed changes persist despite failures?
                    </div>
                    <div class="options">
                        <div class="option">
                            <input type="radio" name="q6" value="a" id="q6a">
                            <label for="q6a">Atomicity</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q6" value="b" id="q6b">
                            <label for="q6b">Consistency</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q6" value="c" id="q6c">
                            <label for="q6c">Isolation</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q6" value="d" id="q6d">
                            <label for="q6d">Durability</label>
                        </div>
                    </div>
                    <button class="btn-primary" onclick="checkMCQ('q6')">Check Answer</button>
                    <div class="feedback" id="feedback-q6">
                        <div class="model-answer">
                            <div class="model-answer-title">‚úì Correct Answer: D - Durability</div>
                            <p>Ensures permanent storage of committed transactions.</p>
                        </div>
                    </div>
                </div>

                <!-- Question 7 -->
                <div class="question" data-type="mcq" data-answer="b" data-points="2.5">
                    <div class="question-header">
                        <span class="question-number">Q7</span>
                        <span class="question-points">2.5 marks</span>
                    </div>
                    <div class="question-text">
                        A weak entity type always has _______ participation with its identifying relationship.
                    </div>
                    <div class="options">
                        <div class="option">
                            <input type="radio" name="q7" value="a" id="q7a">
                            <label for="q7a">Partial</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q7" value="b" id="q7b">
                            <label for="q7b">Total</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q7" value="c" id="q7c">
                            <label for="q7c">Overlap</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q7" value="d" id="q7d">
                            <label for="q7d">Disjoint</label>
                        </div>
                    </div>
                    <button class="btn-primary" onclick="checkMCQ('q7')">Check Answer</button>
                    <div class="feedback" id="feedback-q7">
                        <div class="model-answer">
                            <div class="model-answer-title">‚úì Correct Answer: B - Total</div>
                            <p>Weak entities cannot exist without their owner.</p>
                        </div>
                    </div>
                </div>

                <!-- Question 8 -->
                <div class="question" data-type="mcq" data-answer="d" data-points="2.5">
                    <div class="question-header">
                        <span class="question-number">Q8</span>
                        <span class="question-points">2.5 marks</span>
                    </div>
                    <div class="question-text">
                        Which offers the ability to query and manipulate data?
                    </div>
                    <div class="options">
                        <div class="option">
                            <input type="radio" name="q8" value="a" id="q8a">
                            <label for="q8a">TCL</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q8" value="b" id="q8b">
                            <label for="q8b">DCL</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q8" value="c" id="q8c">
                            <label for="q8c">DDL</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q8" value="d" id="q8d">
                            <label for="q8d">DML</label>
                        </div>
                    </div>
                    <button class="btn-primary" onclick="checkMCQ('q8')">Check Answer</button>
                    <div class="feedback" id="feedback-q8">
                        <div class="model-answer">
                            <div class="model-answer-title">‚úì Correct Answer: D - DML</div>
                            <p>SELECT, INSERT, UPDATE, DELETE are DML commands.</p>
                        </div>
                    </div>
                </div>

                <!-- Question 9 -->
                <div class="question" data-type="mcq" data-answer="d" data-points="2.5">
                    <div class="question-header">
                        <span class="question-number">Q9</span>
                        <span class="question-points">2.5 marks</span>
                    </div>
                    <div class="question-text">
                        What is the primary function of a foreign key?
                    </div>
                    <div class="options">
                        <div class="option">
                            <input type="radio" name="q9" value="a" id="q9a">
                            <label for="q9a">Uniquely identify a tuple</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q9" value="b" id="q9b">
                            <label for="q9b">Enforce domain constraints</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q9" value="c" id="q9c">
                            <label for="q9c">Prevent null values</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q9" value="d" id="q9d">
                            <label for="q9d">Link tuples between relations</label>
                        </div>
                    </div>
                    <button class="btn-primary" onclick="checkMCQ('q9')">Check Answer</button>
                    <div class="feedback" id="feedback-q9">
                        <div class="model-answer">
                            <div class="model-answer-title">‚úì Correct Answer: D</div>
                            <p>Foreign keys establish relationships and maintain referential integrity.</p>
                        </div>
                    </div>
                </div>

                <!-- Question 10 -->
                <div class="question" data-type="mcq" data-answer="b" data-points="2.5">
                    <div class="question-header">
                        <span class="question-number">Q10</span>
                        <span class="question-points">2.5 marks</span>
                    </div>
                    <div class="question-text">
                        If every non-key attribute is functionally dependent on the primary key, the relation is in:
                    </div>
                    <div class="options">
                        <div class="option">
                            <input type="radio" name="q10" value="a" id="q10a">
                            <label for="q10a">Fourth normal form</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q10" value="b" id="q10b">
                            <label for="q10b">Third normal form</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q10" value="c" id="q10c">
                            <label for="q10c">First normal form</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q10" value="d" id="q10d">
                            <label for="q10d">Second normal form</label>
                        </div>
                    </div>
                    <button class="btn-primary" onclick="checkMCQ('q10')">Check Answer</button>
                    <div class="feedback" id="feedback-q10">
                        <div class="model-answer">
                            <div class="model-answer-title">‚úì Correct Answer: B - Third Normal Form</div>
                            <p>3NF eliminates transitive dependencies.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Section 2: Written Questions -->
        <div class="section" id="section2">
            <div class="section-header" onclick="toggleSection('section2')">
                <div class="section-title">
                    ‚úçÔ∏è Written Questions
                    <span class="section-badge">40 marks</span>
                </div>
                <span class="toggle-icon">‚ñº</span>
            </div>
            <div class="section-content">
                <!-- Question 11 -->
                <div class="question" data-type="written" data-points="10" 
                     data-keywords='["foreign key", "customer_id", "restaurant_id", "referential integrity", "references"]'>
                    <div class="question-header">
                        <span class="question-number">Q11</span>
                        <span class="question-points">10 marks</span>
                    </div>
                    <div class="question-text">
                        Given the following schema, identify all foreign keys and explain their role in maintaining referential integrity:
                        <br><br>
                        Restaurant (restaurantId, restaurantName, restaurantAddress, restaurantCity)<br>
                        Customer (customerId, customerName, customerAddress, customerCity)<br>
                        Reservation (customer_id, restaurant_id, reservationDate, noOfPersons)
                    </div>
                    <textarea id="answer-q11" placeholder="Write your answer here..."></textarea>
                    <button class="btn-primary" onclick="checkWritten('q11')">Check Answer</button>
                    <div class="feedback" id="feedback-q11">
                        <div class="model-answer">
                            <div class="model-answer-title">‚úì Model Answer</div>
                            <p><strong>Foreign Keys:</strong></p>
                            <ul>
                                <li>customer_id in Reservation ‚Üí references Customer.customerId</li>
                                <li>restaurant_id in Reservation ‚Üí references Restaurant.restaurantId</li>
                            </ul>
                            <p><strong>Role in Referential Integrity:</strong> Ensures every reservation links to valid customers and restaurants, prevents orphaned records, enforces relationships, and enables cascade operations.</p>
                        </div>
                        <div class="explanation">
                            <strong>Keywords Found:</strong>
                            <div class="keywords" id="keywords-q11"></div>
                        </div>
                    </div>
                </div>

                <!-- Question 12 -->
                <div class="question" data-type="written" data-points="10" 
                     data-keywords='["1NF", "atomic", "multivalued", "composite", "repeating groups"]'>
                    <div class="question-header">
                        <span class="question-number">Q12</span>
                        <span class="question-points">10 marks</span>
                    </div>
                    <div class="question-text">
                        Explain First Normal Form (1NF) and describe violations that prevent a relation from being in 1NF.
                    </div>
                    <textarea id="answer-q12" placeholder="Write your answer here..."></textarea>
                    <button class="btn-primary" onclick="checkWritten('q12')">Check Answer</button>
                    <div class="feedback" id="feedback-q12">
                        <div class="model-answer">
                            <div class="model-answer-title">‚úì Model Answer</div>
                            <p>A relation is in 1NF if all attributes contain only atomic (indivisible) values.</p>
                            <p><strong>Violations:</strong> Multivalued attributes, composite attributes, repeating groups, nested relations.</p>
                        </div>
                        <div class="explanation">
                            <strong>Keywords Found:</strong>
                            <div class="keywords" id="keywords-q12"></div>
                        </div>
                    </div>
                </div>

                <!-- Question 13 -->
                <div class="question" data-type="written" data-points="10" 
                     data-keywords='["partial dependency", "2NF", "prime attribute", "composite key", "full dependency"]'>
                    <div class="question-header">
                        <span class="question-number">Q13</span>
                        <span class="question-points">10 marks</span>
                    </div>
                    <div class="question-text">
                        Explain Second Normal Form (2NF) and the type of functional dependency that must be eliminated.
                    </div>
                    <textarea id="answer-q13" placeholder="Write your answer here..."></textarea>
                    <button class="btn-primary" onclick="checkWritten('q13')">Check Answer</button>
                    <div class="feedback" id="feedback-q13">
                        <div class="model-answer">
                            <div class="model-answer-title">‚úì Model Answer</div>
                            <p>A relation is in 2NF if it's in 1NF and every non-prime attribute is fully functionally dependent on the entire primary key.</p>
                            <p><strong>Must eliminate:</strong> Partial dependencies (non-prime attributes depending on part of a composite key).</p>
                        </div>
                        <div class="explanation">
                            <strong>Keywords Found:</strong>
                            <div class="keywords" id="keywords-q13"></div>
                        </div>
                    </div>
                </div>

                <!-- Question 14 -->
                <div class="question" data-type="written" data-points="10" 
                     data-keywords='["transitive dependency", "3NF", "non-prime", "superkey"]'>
                    <div class="question-header">
                        <span class="question-number">Q14</span>
                        <span class="question-points">10 marks</span>
                    </div>
                    <div class="question-text">
                        Explain Third Normal Form (3NF) and what must be eliminated to achieve it.
                    </div>
                    <textarea id="answer-q14" placeholder="Write your answer here..."></textarea>
                    <button class="btn-primary" onclick="checkWritten('q14')">Check Answer</button>
                    <div class="feedback" id="feedback-q14">
                        <div class="model-answer">
                            <div class="model-answer-title">‚úì Model Answer</div>
                            <p>A relation is in 3NF if it's in 2NF and no non-prime attribute is transitively dependent on the primary key.</p>
                            <p><strong>Must eliminate:</strong> Transitive dependencies (A ‚Üí B ‚Üí C where B is non-prime).</p>
                        </div>
                        <div class="explanation">
                            <strong>Keywords Found:</strong>
                            <div class="keywords" id="keywords-q14"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Section 3: SQL Questions -->
        <div class="section" id="section3">
            <div class="section-header" onclick="toggleSection('section3')">
                <div class="section-title">
                    üíª SQL Queries
                    <span class="section-badge">20 marks</span>
                </div>
                <span class="toggle-icon">‚ñº</span>
            </div>
            <div class="section-content">
                <!-- Question 15 -->
                <div class="question" data-type="written" data-points="10" 
                     data-keywords='["SELECT", "SUM", "JOIN", "GROUP BY", "HAVING"]'>
                    <div class="question-header">
                        <span class="question-number">Q15</span>
                        <span class="question-points">10 marks</span>
                    </div>
                    <div class="question-text">
                        Write a SQL query to find customers who have placed orders totaling more than $500.<br>
                        Schema: Customers (CustomerID, Name), Orders (OrderID, CustomerID, TotalAmount)
                    </div>
                    <textarea id="answer-q15" placeholder="Write your SQL query..."></textarea>
                    <button class="btn-primary" onclick="checkWritten('q15')">Check Answer</button>
                    <div class="feedback" id="feedback-q15">
                        <div class="model-answer">
                            <div class="model-answer-title">‚úì Model Answer</div>
                            <div class="code-block">SELECT C.Name, SUM(O.TotalAmount) AS Total
FROM Customers C
JOIN Orders O ON C.CustomerID = O.CustomerID
GROUP BY C.CustomerID, C.Name
HAVING SUM(O.TotalAmount) > 500;</div>
                        </div>
                        <div class="explanation">
                            <strong>Keywords Found:</strong>
                            <div class="keywords" id="keywords-q15"></div>
                        </div>
                    </div>
                </div>

                <!-- Question 16 -->
                <div class="question" data-type="written" data-points="10" 
                     data-keywords='["DISTINCT", "WHERE", "ORDER BY", "INSERT", "UPDATE"]'>
                    <div class="question-header">
                        <span class="question-number">Q16</span>
                        <span class="question-points">10 marks</span>
                    </div>
                    <div class="question-text">
                        Write SQL queries to:<br>
                        1. List all unique cities where customers live<br>
                        2. Insert a new customer<br>
                        3. Update a customer's address
                    </div>
                    <textarea id="answer-q16" placeholder="Write your SQL queries..."></textarea>
                    <button class="btn-primary" onclick="checkWritten('q16')">Check Answer</button>
                    <div class="feedback" id="feedback-q16">
                        <div class="model-answer">
                            <div class="model-answer-title">‚úì Model Answer</div>
                            <div class="code-block">-- 1. Unique cities
SELECT DISTINCT City FROM Customers;

-- 2. Insert customer
INSERT INTO Customers (CustomerID, Name, City) 
VALUES (101, 'John Doe', 'Riyadh');

-- 3. Update address
UPDATE Customers 
SET Address = '123 Main St' 
WHERE CustomerID = 101;</div>
                        </div>
                        <div class="explanation">
                            <strong>Keywords Found:</strong>
                            <div class="keywords" id="keywords-q16"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Section 4: Normalization -->
        <div class="section" id="section4">
            <div class="section-header" onclick="toggleSection('section4')">
                <div class="section-title">
                    üìê Normalization Problems
                    <span class="section-badge">15 marks</span>
                </div>
                <span class="toggle-icon">‚ñº</span>
            </div>
            <div class="section-content">
                <!-- Question 17 -->
                <div class="question" data-type="written" data-points="15" 
                     data-keywords='["2NF", "3NF", "decompose", "partial", "transitive", "functional dependency"]'>
                    <div class="question-header">
                        <span class="question-number">Q17</span>
                        <span class="question-points">15 marks</span>
                    </div>
                    <div class="question-text">
                        Normalize the LIBRARY relation to 3NF:
                        <br><br>
                        LIBRARY (Branch#, Branch_Addr, ISBN, Title, Author, Pub_ID, Pub_Name, Pub_Address, Num_copies)
                        <br><br>
                        FD1: Branch# ‚Üí Branch_Addr<br>
                        FD2: ISBN ‚Üí Title, Author, Pub_ID<br>
                        FD3: Pub_ID ‚Üí Pub_Name, Pub_Address<br>
                        FD4: (ISBN, Branch#) ‚Üí Num_copies
                        <br><br>
                        Show all steps and final relations.
                    </div>
                    <textarea id="answer-q17" placeholder="Show normalization steps..."></textarea>
                    <button class="btn-primary" onclick="checkWritten('q17')">Check Answer</button>
                    <div class="feedback" id="feedback-q17">
                        <div class="model-answer">
                            <div class="model-answer-title">‚úì Model Answer</div>
                            <p><strong>2NF Decomposition (eliminate partial dependencies):</strong></p>
                            <ul>
                                <li>BRANCH (Branch#, Branch_Addr)</li>
                                <li>BOOK (ISBN, Title, Author, Pub_ID, Pub_Name, Pub_Address)</li>
                                <li>INVENTORY (ISBN, Branch#, Num_copies)</li>
                            </ul>
                            <p><strong>3NF Decomposition (eliminate transitive dependencies):</strong></p>
                            <ul>
                                <li>BRANCH (Branch#, Branch_Addr)</li>
                                <li>PUBLISHER (Pub_ID, Pub_Name, Pub_Address)</li>
                                <li>BOOK (ISBN, Title, Author, Pub_ID) FK: Pub_ID</li>
                                <li>INVENTORY (ISBN, Branch#, Num_copies) FK: ISBN, Branch#</li>
                            </ul>
                        </div>
                        <div class="explanation">
                            <strong>Keywords Found:</strong>
                            <div class="keywords" id="keywords-q17"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Score Card -->
        <div class="score-card" id="scoreCard">
            <h2>üéâ Your Exam Results</h2>
            <div class="score-number" id="finalScore">0/100</div>
            <div class="score-breakdown">
                <div class="score-item">
                    <div class="score-item-label">Multiple Choice</div>
                    <div class="score-item-value" id="mcqScore">0/25</div>
                </div>
                <div class="score-item">
                    <div class="score-item-label">Written Questions</div>
                    <div class="score-item-value" id="writtenScore">0/40</div>
                </div>
                <div class="score-item">
                    <div class="score-item-label">SQL Queries</div>
                    <div class="score-item-value" id="sqlScore">0/20</div>
                </div>
                <div class="score-item">
                    <div class="score-item-label">Percentage</div>
                    <div class="score-item-value" id="percentage">0%</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Timer
        let startTime = Date.now();
        function updateTimer() {
            const elapsed = Date.now() - startTime;
            const hours = Math.floor(elapsed / 3600000);
            const minutes = Math.floor((elapsed % 3600000) / 60000);
            const seconds = Math.floor((elapsed % 60000) / 1000);
            document.querySelector('#timer span').textContent = 
                `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
        }
        setInterval(updateTimer, 1000);

        // Dark mode
        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
            const isDark = document.body.classList.contains('dark-mode');
            document.getElementById('modeIcon').textContent = isDark ? '‚òÄÔ∏è' : 'üåô';
            document.getElementById('modeText').textContent = isDark ? 'Light Mode' : 'Dark Mode';
        }

        // Toggle section
        function toggleSection(id) {
            document.getElementById(id).classList.toggle('collapsed');
        }

        // Check MCQ
        function checkMCQ(qId) {
            const selected = document.querySelector(`input[name="${qId}"]:checked`);
            if (!selected) {
                alert('Please select an answer!');
                return;
            }
            const question = selected.closest('.question');
            const correct = question.dataset.answer;
            const feedback = document.getElementById(`feedback-${qId}`);
            
            feedback.className = selected.value === correct ? 'feedback correct show' : 'feedback incorrect show';
            updateProgress();
        }

        // Check written with keywords
        function checkWritten(qId) {
            const answer = document.getElementById(`answer-${qId}`).value.toLowerCase();
            const question = document.getElementById(`answer-${qId}`).closest('.question');
            const keywords = JSON.parse(question.dataset.keywords);
            const feedback = document.getElementById(`feedback-${qId}`);
            
            if (!answer.trim()) {
                alert('Please write an answer!');
                return;
            }

            let found = [], missing = [];
            keywords.forEach(kw => {
                (answer.includes(kw.toLowerCase()) ? found : missing).push(kw);
            });

            const score = (found.length / keywords.length) * 100;
            const keywordsDiv = document.getElementById(`keywords-${qId}`);
            keywordsDiv.innerHTML = found.map(k => `<span class="keyword found">‚úì ${k}</span>`).join('') +
                                   missing.map(k => `<span class="keyword missing">‚úó ${k}</span>`).join('');

            feedback.className = `feedback ${score === 100 ? 'correct' : score >= 50 ? 'partial' : 'incorrect'} show`;
            updateProgress();
        }

        // Update progress
        function updateProgress() {
            const total = document.querySelectorAll('.question').length;
            const answered = document.querySelectorAll('.feedback.show').length;
            const pct = (answered / total) * 100;
            document.getElementById('progressFill').style.width = pct + '%';
            document.getElementById('progressText').textContent = `${answered}/${total} answered`;
        }

        // Submit all
        function submitAll() {
            let totalScore = 0, maxScore = 100;
            let mcq = 0, written = 0, sql = 0;

            document.querySelectorAll('.question').forEach(q => {
                const pts = parseFloat(q.dataset.points);
                if (q.dataset.type === 'mcq') {
                    const qId = q.querySelector('input').name;
                    const sel = document.querySelector(`input[name="${qId}"]:checked`);
                    if (sel && sel.value === q.dataset.answer) {
                        mcq += pts;
                        totalScore += pts;
                    }
                } else {
                    const textarea = q.querySelector('textarea');
                    if (textarea && textarea.value.trim()) {
                        const ans = textarea.value.toLowerCase();
                        const kws = JSON.parse(q.dataset.keywords);
                        const found = kws.filter(k => ans.includes(k.toLowerCase())).length;
                        const score = (found / kws.length) * pts;
                        if (textarea.id.includes('q15') || textarea.id.includes('q16')) {
                            sql += score;
                        } else {
                            written += score;
                        }
                        totalScore += score;
                    }
                }
            });

            document.getElementById('finalScore').textContent = `${totalScore.toFixed(1)}/${maxScore}`;
            document.getElementById('mcqScore').textContent = `${mcq.toFixed(1)}/25`;
            document.getElementById('writtenScore').textContent = `${written.toFixed(1)}/40`;
            document.getElementById('sqlScore').textContent = `${sql.toFixed(1)}/20`;
            document.getElementById('percentage').textContent = `${((totalScore/maxScore)*100).toFixed(1)}%`;
            
            document.getElementById('scoreCard').classList.add('show');
            document.getElementById('scoreCard').scrollIntoView({behavior: 'smooth'});
        }

        // Show all answers
        function showAllAnswers() {
            document.querySelectorAll('.feedback').forEach(f => f.classList.add('show'));
        }

        // Auto-save
        document.querySelectorAll('textarea').forEach(t => {
            t.addEventListener('input', e => localStorage.setItem(`cs340_${e.target.id}`, e.target.value));
            const saved = localStorage.getItem(`cs340_${t.id}`);
            if (saved) t.value = saved;
        });
    </script>
</body>
</html>