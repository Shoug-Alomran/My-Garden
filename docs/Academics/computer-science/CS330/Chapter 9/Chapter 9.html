<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 9: Virtual Memory - CS330</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f4f4f4;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: white;
        }

        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            margin-bottom: 30px;
            text-align: center;
            border-radius: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        h2 {
            color: #5e35b1;
            font-size: 1.8em;
            margin: 35px 0 20px 0;
            padding-bottom: 10px;
            border-bottom: 3px solid #7e57c2;
        }

        h3 {
            color: #7e57c2;
            font-size: 1.4em;
            margin: 25px 0 15px 0;
        }

        /* Page Fault Visualization */
        .page-fault-visual {
            display: flex;
            justify-content: space-around;
            align-items: center;
            margin: 30px 0;
            flex-wrap: wrap;
            background: #f5f3ff;
            padding: 30px;
            border-radius: 10px;
        }

        .pf-component {
            text-align: center;
            margin: 10px;
        }

        .pf-box {
            width: 120px;
            height: 120px;
            border: 2px solid #7e57c2;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: white;
            font-weight: bold;
        }

        .pf-memory {
            background: #e3f2fd;
        }

        .pf-disk {
            background: #fff3e0;
            border-radius: 50%;
        }

        .pf-arrow {
            font-size: 30px;
            color: #7e57c2;
            margin: 0 20px;
        }

        /* Page Replacement Algorithm Visualization */
        .algorithm-visual {
            background: #f8f9ff;
            border: 2px solid #7e57c2;
            border-radius: 10px;
            padding: 20px;
            margin: 30px 0;
        }

        .reference-string {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .ref-num {
            width: 40px;
            height: 40px;
            border: 1px solid #7e57c2;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 2px;
            background: #fff;
            font-weight: bold;
        }

        .frames-container {
            display: flex;
            justify-content: center;
            margin: 20px 0;
        }

        .frame-column {
            margin: 0 5px;
            text-align: center;
        }

        .frame-slot {
            width: 50px;
            height: 40px;
            border: 1px solid #7e57c2;
            margin: 2px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            background: white;
        }

        .page-hit {
            background: #c8e6c9 !important;
        }

        .page-fault-slot {
            background: #ffcdd2 !important;
        }

        /* Valid/Invalid Bit Visualization */
        .valid-bit-table {
            margin: 20px auto;
            border-collapse: collapse;
        }

        .valid-bit-table td, .valid-bit-table th {
            border: 1px solid #7e57c2;
            padding: 10px;
            text-align: center;
        }

        .valid-bit-table th {
            background: #7e57c2;
            color: white;
        }

        .valid {
            background: #c8e6c9;
            font-weight: bold;
        }

        .invalid {
            background: #ffcdd2;
            font-weight: bold;
        }

        /* Demand Paging Steps */
        .demand-paging-steps {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .step-card {
            background: white;
            border: 2px solid #7e57c2;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }

        .step-card:hover {
            transform: translateY(-5px);
        }

        .step-number {
            background: #7e57c2;
            color: white;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-bottom: 10px;
        }

        /* Algorithm Comparison Table */
        .algorithm-comparison {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .algorithm-comparison th {
            background: #7e57c2;
            color: white;
            padding: 15px;
            text-align: left;
        }

        .algorithm-comparison td {
            padding: 12px 15px;
            border: 1px solid #ddd;
        }

        .algorithm-comparison tr:nth-child(even) {
            background: #f8f9ff;
        }

        /* Thrashing Visualization */
        .thrashing-visual {
            background: #fff3e0;
            border: 2px solid #ff9800;
            border-radius: 10px;
            padding: 25px;
            margin: 30px 0;
        }

        .thrashing-graph {
            display: flex;
            align-items: flex-end;
            justify-content: space-around;
            height: 200px;
            margin: 20px 0;
            border-left: 2px solid #333;
            border-bottom: 2px solid #333;
            padding: 10px;
        }

        .graph-bar {
            width: 40px;
            background: linear-gradient(to top, #ff9800, #ffc107);
            margin: 0 5px;
            display: flex;
            align-items: flex-end;
            justify-content: center;
            color: white;
            font-weight: bold;
            padding-bottom: 5px;
        }

        /* Working Set Model */
        .working-set-visual {
            background: #e8f5e9;
            border: 2px solid #4caf50;
            border-radius: 10px;
            padding: 20px;
            margin: 30px 0;
        }

        .ws-window {
            display: flex;
            justify-content: center;
            margin: 20px 0;
        }

        .ws-page {
            width: 50px;
            height: 50px;
            border: 2px solid #4caf50;
            margin: 0 2px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: white;
        }

        .ws-active {
            background: #a5d6a7;
        }

        /* Performance Calculation */
        .performance-calc {
            background: #f5f5f5;
            border: 2px solid #7e57c2;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }

        .formula-box {
            background: white;
            padding: 15px;
            margin: 15px 0;
            border-left: 4px solid #7e57c2;
            font-family: 'Courier New', monospace;
        }

        .formula {
            font-size: 1.2em;
            color: #5e35b1;
            text-align: center;
            margin: 10px 0;
        }

        /* Code blocks */
        .code-block {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
        }

        .code-comment {
            color: #95a5a6;
        }

        .code-keyword {
            color: #9b59b6;
        }

        /* Concept boxes */
        .concept-box {
            background: #e8eaf6;
            border-left: 4px solid #5e35b1;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .warning-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 20px 0;
        }

        .info-box {
            background: #e3f2fd;
            border: 2px solid #2196f3;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }

        /* Example Box */
        .example-box {
            background: #f3e5f5;
            border: 2px solid #9c27b0;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }

        /* Page Replacement Trace */
        .trace-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
        }

        .trace-table th, .trace-table td {
            border: 1px solid #7e57c2;
            padding: 8px;
            text-align: center;
            min-width: 30px;
        }

        .trace-table th {
            background: #7e57c2;
            color: white;
        }

        .fault-marker {
            color: red;
            font-weight: bold;
        }

        .hit-marker {
            color: green;
            font-weight: bold;
        }

        /* Locality Visualization */
        .locality-visual {
            display: flex;
            justify-content: space-around;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        .locality-type {
            flex: 1;
            margin: 10px;
            padding: 20px;
            background: white;
            border: 2px solid #7e57c2;
            border-radius: 10px;
            min-width: 250px;
        }

        .locality-type h4 {
            color: #5e35b1;
            margin-bottom: 10px;
        }

        /* Belady's Anomaly */
        .belady-anomaly {
            background: #ffebee;
            border: 2px solid #f44336;
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
        }

        /* Exam Section */
        .exam-section {
            background: #fff8dc;
            border: 2px solid #ffd700;
            padding: 25px;
            margin: 30px 0;
            border-radius: 10px;
        }

        .exam-question {
            background: white;
            padding: 20px;
            margin: 15px 0;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        /* Frame Allocation Strategies */
        .allocation-strategies {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .strategy-card {
            background: linear-gradient(135deg, #667eea15, #764ba215);
            border: 2px solid #7e57c2;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
        }

        .strategy-card h4 {
            color: #5e35b1;
            margin-bottom: 10px;
        }

        /* Image Placeholder */
        .image-placeholder {
            background: #95a5a6;
            color: white;
            padding: 60px 20px;
            text-align: center;
            border-radius: 10px;
            margin: 20px 0;
            border: 2px dashed #7f8c8d;
        }

        .highlight {
            background: #ffd700;
            padding: 2px 6px;
            border-radius: 3px;
            font-weight: bold;
        }

        /* Key Terms */
        .key-terms {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .term-card {
            background: #f8f9ff;
            border-left: 3px solid #7e57c2;
            padding: 15px;
        }

        .term-card strong {
            color: #5e35b1;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .page-fault-visual,
            .demand-paging-steps,
            .allocation-strategies {
                flex-direction: column;
            }
            
            .pf-arrow {
                transform: rotate(90deg);
                margin: 20px 0;
            }
        }

        footer {
            background: #5e35b1;
            color: white;
            text-align: center;
            padding: 25px;
            margin-top: 40px;
            border-radius: 10px;
        }
    </style>
  <script src="/javascripts/standalone-theme.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>Chapter 9: Virtual Memory</h1>
            <p style="font-size: 1.2em;">CS330 - Operating Systems</p>
            <p>Demand Paging, Page Replacement, Thrashing & Working Set Model</p>
        </header>

        <!-- Section 1: Background -->
        <section>
            <h2>9.1 Background</h2>
            
            <div class="concept-box">
                <h3>What is Virtual Memory?</h3>
                <p><strong>Virtual memory</strong> is a technique that allows the execution of processes that are not completely in memory.</p>
                <ul style="margin-left: 40px;">
                    <li>Separation of user logical memory from physical memory</li>
                    <li>Only part of program needs to be in memory for execution</li>
                    <li>Logical address space can be much larger than physical address space</li>
                    <li>Allows more programs to run concurrently</li>
                    <li>Less I/O needed to load or swap processes</li>
                </ul>
            </div>

            <h3>Virtual Memory Benefits</h3>
            <div class="info-box">
                <ul>
                    <li>‚úì Programs can be larger than physical memory</li>
                    <li>‚úì More programs can run at the same time</li>
                    <li>‚úì Less I/O needed (load only needed pages)</li>
                    <li>‚úì Faster program startup</li>
                    <li>‚úì Shared pages between processes</li>
                    <li>‚úì More efficient memory utilization</li>
                </ul>
            </div>

            <h3>Virtual Memory Implementation</h3>
            <p>Virtual memory can be implemented via:</p>
            <ul style="margin-left: 40px;">
                <li><strong>Demand Paging</strong> (most common)</li>
                <li><strong>Demand Segmentation</strong> (more complex, less common)</li>
            </ul>
        </section>

        <!-- Section 2: Demand Paging -->
        <section>
            <h2>9.2 Demand Paging</h2>
            
            <p>Bring a page into memory only when it is needed</p>
            
            <h3>Valid-Invalid Bit</h3>
            <p>With each page table entry, a valid-invalid bit is associated:</p>
            
            <table class="valid-bit-table">
                <tr>
                    <th>Page</th>
                    <th>Frame</th>
                    <th>Valid Bit</th>
                    <th>Meaning</th>
                </tr>
                <tr>
                    <td>0</td>
                    <td>4</td>
                    <td class="valid">v</td>
                    <td>In memory</td>
                </tr>
                <tr>
                    <td>1</td>
                    <td>6</td>
                    <td class="valid">v</td>
                    <td>In memory</td>
                </tr>
                <tr>
                    <td>2</td>
                    <td>-</td>
                    <td class="invalid">i</td>
                    <td>Not in memory</td>
                </tr>
                <tr>
                    <td>3</td>
                    <td>9</td>
                    <td class="valid">v</td>
                    <td>In memory</td>
                </tr>
                <tr>
                    <td>4</td>
                    <td>-</td>
                    <td class="invalid">i</td>
                    <td>Not in memory</td>
                </tr>
            </table>

            <h3>Page Fault Handling Steps</h3>
            <div class="page-fault-visual">
                <div class="pf-component">
                    <div class="step-number">1</div>
                    <div class="pf-box">
                        Reference<br>Page
                    </div>
                    <p>CPU references page</p>
                </div>
                
                <span class="pf-arrow">‚Üí</span>
                
                <div class="pf-component">
                    <div class="step-number">2</div>
                    <div class="pf-box">
                        Check<br>Valid Bit
                    </div>
                    <p>Invalid bit set</p>
                </div>
                
                <span class="pf-arrow">‚Üí</span>
                
                <div class="pf-component">
                    <div class="step-number">3</div>
                    <div class="pf-box pf-disk">
                        Backing<br>Store
                    </div>
                    <p>Find page on disk</p>
                </div>
                
                <span class="pf-arrow">‚Üí</span>
                
                <div class="pf-component">
                    <div class="step-number">4</div>
                    <div class="pf-box pf-memory">
                        Load into<br>Memory
                    </div>
                    <p>Bring page to frame</p>
                </div>
                
                <span class="pf-arrow">‚Üí</span>
                
                <div class="pf-component">
                    <div class="step-number">5</div>
                    <div class="pf-box">
                        Update<br>Page Table
                    </div>
                    <p>Set valid bit</p>
                </div>
                
                <span class="pf-arrow">‚Üí</span>
                
                <div class="pf-component">
                    <div class="step-number">6</div>
                    <div class="pf-box">
                        Restart<br>Instruction
                    </div>
                    <p>Continue execution</p>
                </div>
            </div>

            <div class="demand-paging-steps">
                <div class="step-card">
                    <div class="step-number">1</div>
                    <h4>Trap to OS</h4>
                    <p>Page table entry has invalid bit set, causing page fault trap</p>
                </div>
                
                <div class="step-card">
                    <div class="step-number">2</div>
                    <h4>Check Reference</h4>
                    <p>OS checks internal table to verify if reference is valid</p>
                </div>
                
                <div class="step-card">
                    <div class="step-number">3</div>
                    <h4>Get Empty Frame</h4>
                    <p>Find free frame from free-frame list</p>
                </div>
                
                <div class="step-card">
                    <div class="step-number">4</div>
                    <h4>Swap Page In</h4>
                    <p>Read page from backing store into frame</p>
                </div>
                
                <div class="step-card">
                    <div class="step-number">5</div>
                    <h4>Update Tables</h4>
                    <p>Set page table entry, valid bit = v</p>
                </div>
                
                <div class="step-card">
                    <div class="step-number">6</div>
                    <h4>Restart Process</h4>
                    <p>Restart instruction that caused page fault</p>
                </div>
            </div>
        </section>

        <!-- Section 3: Performance -->
        <section>
            <h2>9.3 Performance of Demand Paging</h2>
            
            <div class="performance-calc">
                <h3>Effective Access Time (EAT)</h3>
                
                <div class="formula-box">
                    <p class="formula">EAT = (1 - p) √ó ma + p √ó page_fault_time</p>
                    <p>Where:</p>
                    <ul>
                        <li>p = page fault rate (0 ‚â§ p ‚â§ 1)</li>
                        <li>ma = memory access time</li>
                        <li>page_fault_time = time to service page fault</li>
                    </ul>
                </div>

                <h4>Page Fault Service Time Components:</h4>
                <ol style="margin-left: 40px;">
                    <li>Page fault overhead (1-100 Œºs)</li>
                    <li>Swap page out (if needed)</li>
                    <li>Swap page in (8-20 ms)</li>
                    <li>Restart overhead (1-100 Œºs)</li>
                </ol>
            </div>

            <div class="example-box">
                <h4>Example Calculation:</h4>
                <p>Memory access time = 200 nanoseconds</p>
                <p>Page fault service time = 8 milliseconds</p>
                <p>Page fault rate (p) = 0.001</p>
                
                <div class="formula-box">
                    <p>EAT = (1 - 0.001) √ó 200 + 0.001 √ó 8,000,000</p>
                    <p>EAT = 0.999 √ó 200 + 0.001 √ó 8,000,000</p>
                    <p>EAT = 199.8 + 8,000</p>
                    <p><strong>EAT = 8,199.8 nanoseconds</strong></p>
                </div>
                
                <p>This is about <span class="highlight">40 times slower</span> than no page faults!</p>
            </div>

            <div class="warning-box">
                <h4>‚ö†Ô∏è Performance Goal:</h4>
                <p>For acceptable performance, page fault rate must be very low (< 0.0001)</p>
                <p>Even 1 page fault per 1,000 accesses causes significant slowdown</p>
            </div>
        </section>

        <!-- Section 4: Page Replacement -->
        <section>
            <h2>9.4 Page Replacement</h2>
            
            <p>When no free frame is available, we must replace a page</p>
            
            <h3>Basic Page Replacement Steps:</h3>
            <ol style="margin-left: 40px;">
                <li>Find location of desired page on disk</li>
                <li>Find a free frame:
                    <ul>
                        <li>If there is a free frame, use it</li>
                        <li>If not, use page replacement algorithm to select victim frame</li>
                    </ul>
                </li>
                <li>If victim page is modified (dirty bit set), write to disk</li>
                <li>Bring desired page into newly freed frame</li>
                <li>Update page and frame tables</li>
                <li>Restart process</li>
            </ol>

            <div class="concept-box">
                <h4>Page Replacement Goal:</h4>
                <p>Want lowest page-fault rate</p>
                <p>Evaluate algorithm by running on reference string and computing number of page faults</p>
            </div>
        </section>

        <!-- Section 5: Page Replacement Algorithms -->
        <section>
            <h2>9.5 Page Replacement Algorithms</h2>
            
            <h3>Reference String Example:</h3>
            <div class="reference-string">
                <div class="ref-num">7</div>
                <div class="ref-num">0</div>
                <div class="ref-num">1</div>
                <div class="ref-num">2</div>
                <div class="ref-num">0</div>
                <div class="ref-num">3</div>
                <div class="ref-num">0</div>
                <div class="ref-num">4</div>
                <div class="ref-num">2</div>
                <div class="ref-num">3</div>
                <div class="ref-num">0</div>
                <div class="ref-num">3</div>
                <div class="ref-num">2</div>
                <div class="ref-num">1</div>
                <div class="ref-num">2</div>
                <div class="ref-num">0</div>
                <div class="ref-num">1</div>
                <div class="ref-num">7</div>
                <div class="ref-num">0</div>
                <div class="ref-num">1</div>
            </div>
            <p style="text-align: center;">Using 3 frames</p>

            <!-- FIFO Algorithm -->
            <div class="algorithm-visual">
                <h3>First-In-First-Out (FIFO) Algorithm</h3>
                <p>Replace the oldest page in memory</p>
                
                <table class="trace-table">
                    <tr>
                        <th>Reference</th>
                        <th>7</th><th>0</th><th>1</th><th>2</th><th>0</th><th>3</th><th>0</th><th>4</th><th>2</th><th>3</th><th>0</th><th>3</th><th>2</th><th>1</th><th>2</th><th>0</th><th>1</th><th>7</th><th>0</th><th>1</th>
                    </tr>
                    <tr>
                        <td>Frame 0</td>
                        <td>7</td><td>7</td><td>7</td><td>2</td><td>2</td><td>2</td><td>2</td><td>4</td><td>4</td><td>4</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>7</td><td>7</td><td>7</td>
                    </tr>
                    <tr>
                        <td>Frame 1</td>
                        <td></td><td>0</td><td>0</td><td>0</td><td>0</td><td>3</td><td>3</td><td>3</td><td>2</td><td>2</td><td>2</td><td>2</td><td>2</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>0</td><td>0</td>
                    </tr>
                    <tr>
                        <td>Frame 2</td>
                        <td></td><td></td><td>1</td><td>1</td><td>1</td><td>1</td><td>0</td><td>0</td><td>0</td><td>3</td><td>3</td><td>3</td><td>3</td><td>3</td><td>2</td><td>2</td><td>2</td><td>2</td><td>2</td><td>1</td>
                    </tr>
                    <tr>
                        <td>Fault?</td>
                        <td class="fault-marker">F</td><td class="fault-marker">F</td><td class="fault-marker">F</td><td class="fault-marker">F</td><td class="hit-marker">-</td><td class="fault-marker">F</td><td class="fault-marker">F</td><td class="fault-marker">F</td><td class="fault-marker">F</td><td class="fault-marker">F</td><td class="fault-marker">F</td><td class="hit-marker">-</td><td class="hit-marker">-</td><td class="fault-marker">F</td><td class="fault-marker">F</td><td class="hit-marker">-</td><td class="hit-marker">-</td><td class="fault-marker">F</td><td class="fault-marker">F</td><td class="fault-marker">F</td>
                    </tr>
                </table>
                <p><strong>Total Page Faults: 15</strong></p>
            </div>

            <!-- Optimal Algorithm -->
            <div class="algorithm-visual">
                <h3>Optimal Page Replacement</h3>
                <p>Replace page that will not be used for longest period of time</p>
                
                <table class="trace-table">
                    <tr>
                        <th>Reference</th>
                        <th>7</th><th>0</th><th>1</th><th>2</th><th>0</th><th>3</th><th>0</th><th>4</th><th>2</th><th>3</th><th>0</th><th>3</th><th>2</th><th>1</th><th>2</th><th>0</th><th>1</th><th>7</th><th>0</th><th>1</th>
                    </tr>
                    <tr>
                        <td>Frame 0</td>
                        <td>7</td><td>7</td><td>7</td><td>2</td><td>2</td><td>2</td><td>2</td><td>2</td><td>2</td><td>2</td><td>2</td><td>2</td><td>2</td><td>2</td><td>2</td><td>2</td><td>2</td><td>7</td><td>7</td><td>7</td>
                    </tr>
                    <tr>
                        <td>Frame 1</td>
                        <td></td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>4</td><td>4</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td>
                    </tr>
                    <tr>
                        <td>Frame 2</td>
                        <td></td><td></td><td>1</td><td>1</td><td>1</td><td>3</td><td>3</td><td>3</td><td>3</td><td>3</td><td>3</td><td>3</td><td>3</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td>
                    </tr>
                    <tr>
                        <td>Fault?</td>
                        <td class="fault-marker">F</td><td class="fault-marker">F</td><td class="fault-marker">F</td><td class="fault-marker">F</td><td class="hit-marker">-</td><td class="fault-marker">F</td><td class="hit-marker">-</td><td class="fault-marker">F</td><td class="hit-marker">-</td><td class="fault-marker">F</td><td class="hit-marker">-</td><td class="hit-marker">-</td><td class="hit-marker">-</td><td class="fault-marker">F</td><td class="hit-marker">-</td><td class="hit-marker">-</td><td class="hit-marker">-</td><td class="fault-marker">F</td><td class="hit-marker">-</td><td class="hit-marker">-</td>
                    </tr>
                </table>
                <p><strong>Total Page Faults: 9</strong> (Optimal but requires future knowledge)</p>
            </div>

            <!-- LRU Algorithm -->
            <div class="algorithm-visual">
                <h3>Least Recently Used (LRU) Algorithm</h3>
                <p>Replace the page that has not been used for the longest time</p>
                
                <table class="trace-table">
                    <tr>
                        <th>Reference</th>
                        <th>7</th><th>0</th><th>1</th><th>2</th><th>0</th><th>3</th><th>0</th><th>4</th><th>2</th><th>3</th><th>0</th><th>3</th><th>2</th><th>1</th><th>2</th><th>0</th><th>1</th><th>7</th><th>0</th><th>1</th>
                    </tr>
                    <tr>
                        <td>Frame 0</td>
                        <td>7</td><td>7</td><td>7</td><td>2</td><td>2</td><td>2</td><td>2</td><td>4</td><td>4</td><td>4</td><td>0</td><td>0</td><td>0</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td>
                    </tr>
                    <tr>
                        <td>Frame 1</td>
                        <td></td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>3</td><td>3</td><td>3</td><td>3</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td>
                    </tr>
                    <tr>
                        <td>Frame 2</td>
                        <td></td><td></td><td>1</td><td>1</td><td>1</td><td>3</td><td>3</td><td>3</td><td>2</td><td>3</td><td>3</td><td>3</td><td>2</td><td>2</td><td>2</td><td>2</td><td>2</td><td>7</td><td>7</td><td>7</td>
                    </tr>
                    <tr>
                        <td>Fault?</td>
                        <td class="fault-marker">F</td><td class="fault-marker">F</td><td class="fault-marker">F</td><td class="fault-marker">F</td><td class="hit-marker">-</td><td class="fault-marker">F</td><td class="hit-marker">-</td><td class="fault-marker">F</td><td class="fault-marker">F</td><td class="hit-marker">-</td><td class="fault-marker">F</td><td class="hit-marker">-</td><td class="fault-marker">F</td><td class="fault-marker">F</td><td class="hit-marker">-</td><td class="fault-marker">F</td><td class="hit-marker">-</td><td class="fault-marker">F</td><td class="hit-marker">-</td><td class="hit-marker">-</td>
                    </tr>
                </table>
                <p><strong>Total Page Faults: 12</strong></p>
            </div>

            <h3>Algorithm Comparison</h3>
            <table class="algorithm-comparison">
                <tr>
                    <th>Algorithm</th>
                    <th>Description</th>
                    <th>Page Faults</th>
                    <th>Advantages</th>
                    <th>Disadvantages</th>
                </tr>
                <tr>
                    <td><strong>FIFO</strong></td>
                    <td>Replace oldest page</td>
                    <td>15</td>
                    <td>Simple to implement</td>
                    <td>Poor performance, Belady's anomaly</td>
                </tr>
                <tr>
                    <td><strong>Optimal</strong></td>
                    <td>Replace page not used for longest time in future</td>
                    <td>9</td>
                    <td>Minimum page faults</td>
                    <td>Requires future knowledge (impossible)</td>
                </tr>
                <tr>
                    <td><strong>LRU</strong></td>
                    <td>Replace least recently used page</td>
                    <td>12</td>
                    <td>Good performance, approximates optimal</td>
                    <td>Expensive to implement exactly</td>
                </tr>
                <tr>
                    <td><strong>Clock</strong></td>
                    <td>Approximation of LRU using reference bit</td>
                    <td>~13</td>
                    <td>Efficient implementation</td>
                    <td>Not as good as true LRU</td>
                </tr>
                <tr>
                    <td><strong>LFU</strong></td>
                    <td>Replace least frequently used</td>
                    <td>Varies</td>
                    <td>Considers usage frequency</td>
                    <td>Pages used heavily initially stay</td>
                </tr>
            </table>

            <div class="belady-anomaly">
                <h3>üö® Belady's Anomaly</h3>
                <p>For some page replacement algorithms (like FIFO), <strong>more frames can cause MORE page faults!</strong></p>
                <p><strong>Example:</strong> Reference string: 1, 2, 3, 4, 1, 2, 5, 1, 2, 3, 4, 5</p>
                <ul>
                    <li>With 3 frames: 9 page faults</li>
                    <li>With 4 frames: 10 page faults (MORE!)</li>
                </ul>
            </div>
        </section>

        <!-- Section 6: Thrashing -->
        <section>
            <h2>9.6 Thrashing</h2>
            
            <div class="thrashing-visual">
                <h3>What is Thrashing?</h3>
                <p>A process is <span class="highlight">thrashing</span> if it is spending more time paging than executing</p>
                
                <div class="concept-box">
                    <h4>Thrashing Scenario:</h4>
                    <ol>
                        <li>Low CPU utilization ‚Üí OS increases multiprogramming</li>
                        <li>More processes ‚Üí Less memory per process</li>
                        <li>Processes start page faulting frequently</li>
                        <li>I/O queue grows, CPU utilization drops further</li>
                        <li>OS adds more processes (thinking CPU is idle)</li>
                        <li>System enters thrashing state</li>
                    </ol>
                </div>

                <h4>CPU Utilization vs Degree of Multiprogramming</h4>
                <div class="thrashing-graph">
                    <div class="graph-bar" style="height: 40%;">Low</div>
                    <div class="graph-bar" style="height: 60%;">‚Üë</div>
                    <div class="graph-bar" style="height: 80%;">Good</div>
                    <div class="graph-bar" style="height: 90%;">Optimal</div>
                    <div class="graph-bar" style="height: 70%;">‚Üì</div>
                    <div class="graph-bar" style="height: 30%;">Thrashing</div>
                    <div class="graph-bar" style="height: 10%;">Severe</div>
                </div>
                <p style="text-align: center;">Degree of Multiprogramming ‚Üí</p>
            </div>

            <div class="warning-box">
                <h4>‚ö†Ô∏è Thrashing Prevention:</h4>
                <ul>
                    <li>Provide process with as many frames as it needs</li>
                    <li>Use working-set model to estimate needs</li>
                    <li>Monitor page-fault frequency</li>
                    <li>Suspend processes if thrashing detected</li>
                </ul>
            </div>
        </section>

        <!-- Section 7: Working-Set Model -->
        <section>
            <h2>9.7 Working-Set Model</h2>
            
            <div class="working-set-visual">
                <h3>Locality of Reference</h3>
                
                <div class="locality-visual">
                    <div class="locality-type">
                        <h4>Temporal Locality</h4>
                        <p>If a memory location is referenced, it will tend to be referenced again soon</p>
                        <p><strong>Example:</strong> Loop counters, frequently used variables</p>
                    </div>
                    
                    <div class="locality-type">
                        <h4>Spatial Locality</h4>
                        <p>If a memory location is referenced, nearby locations will tend to be referenced soon</p>
                        <p><strong>Example:</strong> Array elements, sequential code</p>
                    </div>
                </div>

                <h3>Working Set Definition</h3>
                <p>Working set W(t, Œî) = set of pages referenced in last Œî time units</p>
                
                <div class="ws-window">
                    <div style="text-align: center;">
                        <p>Working Set Window (Œî = 10)</p>
                        <div style="display: flex; justify-content: center; margin: 10px 0;">
                            <div class="ws-page">2</div>
                            <div class="ws-page ws-active">6</div>
                            <div class="ws-page ws-active">1</div>
                            <div class="ws-page ws-active">5</div>
                            <div class="ws-page ws-active">7</div>
                            <div class="ws-page ws-active">5</div>
                            <div class="ws-page ws-active">1</div>
                            <div class="ws-page ws-active">6</div>
                            <div class="ws-page ws-active">2</div>
                            <div class="ws-page ws-active">3</div>
                        </div>
                        <p>Working Set = {1, 2, 3, 5, 6, 7}</p>
                        <p>Working Set Size (WSS) = 6</p>
                    </div>
                </div>

                <div class="concept-box">
                    <h4>Working Set Strategy:</h4>
                    <p>If Total WSS > Available memory ‚Üí Thrashing</p>
                    <p>If D = Œ£ WSS·µ¢ > m (available frames)</p>
                    <p>Then suspend one or more processes</p>
                </div>
            </div>
        </section>

        <!-- Section 8: Page-Fault Frequency -->
        <section>
            <h2>9.8 Page-Fault Frequency (PFF)</h2>
            
            <div class="info-box">
                <h3>PFF Scheme</h3>
                <p>Establish acceptable page-fault frequency range</p>
                <ul>
                    <li>If PFF too high ‚Üí allocate more frames to process</li>
                    <li>If PFF too low ‚Üí reduce frames allocated</li>
                    <li>If no free frames available ‚Üí suspend process</li>
                </ul>
                
                <div style="text-align: center; margin: 20px 0;">
                    <div style="display: inline-block; padding: 10px 20px; background: #ffcdd2; border: 2px solid red;">
                        Upper Bound<br>(increase frames)
                    </div>
                    <div style="display: inline-block; padding: 10px 20px; background: #c8e6c9; margin: 0 20px;">
                        Desired Range
                    </div>
                    <div style="display: inline-block; padding: 10px 20px; background: #ffcdd2; border: 2px solid red;">
                        Lower Bound<br>(decrease frames)
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 9: Frame Allocation -->
        <section>
            <h2>9.9 Allocation of Frames</h2>
            
            <div class="allocation-strategies">
                <div class="strategy-card">
                    <h4>Equal Allocation</h4>
                    <p>Each process gets equal share</p>
                    <p>m frames, n processes</p>
                    <p>Each gets m/n frames</p>
                </div>
                
                <div class="strategy-card">
                    <h4>Proportional Allocation</h4>
                    <p>Allocate according to size</p>
                    <p>s·µ¢ = size of process i</p>
                    <p>S = Œ£s·µ¢</p>
                    <p>a·µ¢ = (s·µ¢/S) √ó m</p>
                </div>
                
                <div class="strategy-card">
                    <h4>Priority Allocation</h4>
                    <p>Based on process priority</p>
                    <p>Higher priority = more frames</p>
                </div>
            </div>

            <div class="concept-box">
                <h4>Global vs Local Replacement:</h4>
                <ul>
                    <li><strong>Global replacement:</strong> Process can select replacement frame from all frames (even those of other processes)</li>
                    <li><strong>Local replacement:</strong> Process can only select from its own allocated frames</li>
                </ul>
            </div>
        </section>

        <!-- Section 10: Practice Problems -->
        <section>
            <h2>9.10 Practice Problems</h2>
            
            <div class="exam-section">
                <h3>Problem 1: Page Replacement</h3>
                <div class="exam-question">
                    <p><strong>Reference String:</strong> 1, 2, 3, 4, 2, 1, 5, 6, 2, 1, 2, 3, 7, 6, 3, 2, 1, 2, 3, 6</p>
                    <p><strong>Frames:</strong> 3</p>
                    <p>Calculate page faults for FIFO, LRU, and Optimal algorithms</p>
                    
                    <div class="example-box">
                        <h4>Solution:</h4>
                        <p><strong>FIFO:</strong> 16 page faults</p>
                        <p><strong>LRU:</strong> 15 page faults</p>
                        <p><strong>Optimal:</strong> 11 page faults</p>
                    </div>
                </div>

                <h3>Problem 2: Effective Access Time</h3>
                <div class="exam-question">
                    <p>Memory access time = 100 ns</p>
                    <p>Page fault service time = 25 ms</p>
                    <p>Page fault rate = 0.0001</p>
                    <p>Calculate EAT</p>
                    
                    <div class="example-box">
                        <h4>Solution:</h4>
                        <div class="formula-box">
                            <p>EAT = (1 - 0.0001) √ó 100 + 0.0001 √ó 25,000,000</p>
                            <p>EAT = 99.99 + 2,500</p>
                            <p><strong>EAT = 2,599.99 ns</strong></p>
                        </div>
                    </div>
                </div>

                <h3>Problem 3: Working Set</h3>
                <div class="exam-question">
                    <p>Reference string: 2, 3, 2, 4, 5, 3, 6, 3, 4, 5, 3</p>
                    <p>Window size Œî = 4</p>
                    <p>Find working set at t = 7</p>
                    
                    <div class="example-box">
                        <h4>Solution:</h4>
                        <p>Look at last 4 references: 5, 3, 6, 3</p>
                        <p><strong>Working Set = {3, 5, 6}</strong></p>
                        <p><strong>WSS = 3</strong></p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 11: CS330 Exam Questions -->
        <section>
            <h2>9.11 CS330 Exam Practice</h2>
            
            <div class="exam-section">
                <h3>Multiple Choice Questions</h3>
                
                <div class="exam-question">
                    <p><strong>Q1.</strong> Which page replacement algorithm suffers from Belady's anomaly?</p>
                    <p><strong>Answer:</strong> FIFO</p>
                </div>

                <div class="exam-question">
                    <p><strong>Q2.</strong> A system is thrashing when:</p>
                    <p><strong>Answer:</strong> Processes spend more time paging than executing</p>
                </div>

                <div class="exam-question">
                    <p><strong>Q3.</strong> The working set model is based on:</p>
                    <p><strong>Answer:</strong> Locality of reference</p>
                </div>

                <div class="exam-question">
                    <p><strong>Q4.</strong> Valid-invalid bit in page table indicates:</p>
                    <p><strong>Answer:</strong> Whether page is in memory (v) or on disk (i)</p>
                </div>

                <h3>Short Answer Questions</h3>
                
                <div class="exam-question">
                    <p><strong>Q5.</strong> List two ways to improve system performance when thrashing occurs.</p>
                    <div class="concept-box">
                        <p><strong>Answer:</strong></p>
                        <ol>
                            <li>Decrease degree of multiprogramming</li>
                            <li>Increase size of main memory (RAM)</li>
                            <li>Use better page replacement algorithm</li>
                            <li>Improve locality of programs</li>
                        </ol>
                    </div>
                </div>

                <div class="exam-question">
                    <p><strong>Q6.</strong> Why is the optimal page replacement algorithm not implementable?</p>
                    <div class="concept-box">
                        <p><strong>Answer:</strong> It requires future knowledge of the reference string, which is impossible to know in advance. It's used only as a benchmark to compare other algorithms.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 12: Key Terms -->
        <section>
            <h2>9.12 Key Terms and Definitions</h2>
            
            <div class="key-terms">
                <div class="term-card">
                    <strong>Virtual Memory:</strong> Technique allowing execution of processes not completely in memory
                </div>
                
                <div class="term-card">
                    <strong>Demand Paging:</strong> Load pages only when they are demanded during execution
                </div>
                
                <div class="term-card">
                    <strong>Page Fault:</strong> Trap generated when process accesses page not in memory
                </div>
                
                <div class="term-card">
                    <strong>Page Replacement:</strong> Selecting victim page to swap out when no free frames
                </div>
                
                <div class="term-card">
                    <strong>Reference String:</strong> Sequence of page references used to evaluate algorithms
                </div>
                
                <div class="term-card">
                    <strong>Thrashing:</strong> Process spending more time paging than executing
                </div>
                
                <div class="term-card">
                    <strong>Working Set:</strong> Set of pages process is actively using
                </div>
                
                <div class="term-card">
                    <strong>Locality:</strong> Tendency to reference nearby memory locations
                </div>
                
                <div class="term-card">
                    <strong>Belady's Anomaly:</strong> More frames causing more page faults (FIFO)
                </div>
                
                <div class="term-card">
                    <strong>Dirty Bit:</strong> Indicates if page has been modified
                </div>
                
                <div class="term-card">
                    <strong>EAT:</strong> Effective Access Time including page fault overhead
                </div>
                
                <div class="term-card">
                    <strong>PFF:</strong> Page-Fault Frequency for frame allocation
                </div>
            </div>
        </section>

        <!-- Image Placeholders -->
        <section>
            <h2>9.13 Diagrams from Slides</h2>
            
            <div class="image-placeholder">
                <h4>üìä Page Fault Handling Steps</h4>
                <p>[Insert detailed page fault handling diagram with OS, memory, and disk]</p>
            </div>

            <div class="image-placeholder">
                <h4>üìä Page Replacement Algorithms Comparison</h4>
                <p>[Insert visual comparison of FIFO, LRU, and Optimal]</p>
            </div>

            <div class="image-placeholder">
                <h4>üìä Thrashing Graph</h4>
                <p>[Insert CPU utilization vs degree of multiprogramming curve]</p>
            </div>

            <div class="image-placeholder">
                <h4>üìä Working Set Model</h4>
                <p>[Insert working set window and WSS calculation example]</p>
            </div>

            <div class="warning-box">
                <p><strong>Note:</strong> Please provide the actual diagrams from your course materials to replace these placeholders.</p>
            </div>
        </section>

        <footer>
            <p>CS330 - Operating Systems</p>
            <p>Chapter 9: Virtual Memory</p>
            <p><strong>Created by: Shoug Alomran</strong></p>
        </footer>
    </div>
</body>
</html>