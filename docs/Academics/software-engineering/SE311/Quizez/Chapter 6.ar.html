<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SE311 - Chapter 6: Requirements Validation - Exam</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #f5f5f5;
            --text-primary: #1a1a1a;
            --text-secondary: #666666;
            --border-color: #dddddd;
            --accent-color: #2563eb;
            --success-color: #10b981;
            --error-color: #ef4444;
            --warning-color: #f59e0b;
            --shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        [data-theme="dark"] {
            --bg-primary: #1a1a1a;
            --bg-secondary: #2d2d2d;
            --text-primary: #f5f5f5;
            --text-secondary: #a0a0a0;
            --border-color: #404040;
            --accent-color: #3b82f6;
            --success-color: #10b981;
            --error-color: #ef4444;
            --warning-color: #f59e0b;
            --shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background-color: var(--bg-secondary);
            color: var(--text-primary);
            line-height: 1.6;
            padding: 20px;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background-color: var(--bg-primary);
            padding: 40px;
            border-radius: 12px;
            box-shadow: var(--shadow);
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            border-bottom: 3px solid var(--accent-color);
            padding-bottom: 20px;
        }

        .header h1 {
            font-size: 2em;
            margin-bottom: 10px;
            color: var(--accent-color);
        }

        .header p {
            color: var(--text-secondary);
            font-size: 1.1em;
        }

        .controls {
            display: flex;
            justify-content: flex-end;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .toggle-buttons {
            display: flex;
            gap: 10px;
        }

        button {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .lang-toggle {
            background-color: var(--accent-color);
            color: white;
        }

        .lang-toggle:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }

        .question {
            background-color: var(--bg-secondary);
            padding: 25px;
            margin-bottom: 25px;
            border-radius: 8px;
            border-left: 4px solid var(--accent-color);
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .question-number {
            font-size: 1.2em;
            font-weight: bold;
            color: var(--accent-color);
        }

        .question-type {
            background-color: var(--accent-color);
            color: white;
            padding: 4px 12px;
            border-radius: 4px;
            font-size: 0.85em;
        }

        .question-text {
            margin-bottom: 20px;
            font-size: 1.05em;
            line-height: 1.7;
        }

        .options {
            margin-left: 20px;
        }

        .option {
            margin-bottom: 12px;
            display: flex;
            align-items: flex-start;
        }

        .option input[type="radio"],
        .option input[type="checkbox"] {
            margin-right: 10px;
            margin-top: 4px;
            cursor: pointer;
        }

        .option label {
            cursor: pointer;
            flex: 1;
        }

        textarea {
            width: 100%;
            min-height: 120px;
            padding: 12px;
            border: 2px solid var(--border-color);
            border-radius: 6px;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            font-size: 1em;
            font-family: inherit;
            resize: vertical;
            transition: border-color 0.3s ease;
        }

        textarea:focus {
            outline: none;
            border-color: var(--accent-color);
        }

        .feedback {
            margin-top: 15px;
            padding: 15px;
            border-radius: 6px;
            display: none;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .feedback.correct {
            background-color: rgba(16, 185, 129, 0.1);
            border: 2px solid var(--success-color);
            display: block;
        }

        .feedback.incorrect {
            background-color: rgba(239, 68, 68, 0.1);
            border: 2px solid var(--error-color);
            display: block;
        }

        .feedback.partial {
            background-color: rgba(245, 158, 11, 0.1);
            border: 2px solid var(--warning-color);
            display: block;
        }

        .feedback-header {
            font-weight: bold;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .feedback-icon {
            font-size: 1.2em;
        }

        .submit-btn {
            background-color: var(--success-color);
            color: white;
            width: 100%;
            padding: 15px;
            font-size: 1.1em;
            margin-top: 30px;
        }

        .submit-btn:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }

        .submit-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .score-display {
            background: linear-gradient(135deg, var(--accent-color), var(--success-color));
            color: white;
            padding: 25px;
            border-radius: 8px;
            text-align: center;
            margin-top: 30px;
            display: none;
        }

        .score-display.show {
            display: block;
            animation: slideIn 0.5s ease;
        }

        .score-display h2 {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .score-display p {
            font-size: 1.2em;
        }

        .model-answer {
            margin-top: 10px;
            padding: 12px;
            background-color: var(--bg-primary);
            border-radius: 6px;
            border-left: 3px solid var(--success-color);
        }

        .model-answer-label {
            font-weight: bold;
            color: var(--success-color);
            margin-bottom: 8px;
        }

        .generated-tag {
            display: inline-block;
            background-color: var(--warning-color);
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.75em;
            margin-left: 8px;
            font-weight: 600;
        }

        .exam-tag {
            display: inline-block;
            background-color: var(--success-color);
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.75em;
            margin-left: 8px;
            font-weight: 600;
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }

            .controls {
                flex-direction: column;
                align-items: flex-end;
            }
        }

        /* RTL Support */
        [dir="rtl"] .question {
            border-left: none;
            border-right: 4px solid var(--accent-color);
        }

        [dir="rtl"] .option {
            flex-direction: row-reverse;
        }

        [dir="rtl"] .option input {
            margin-right: 0;
            margin-left: 10px;
        }

        [dir="rtl"] .options {
            margin-left: 0;
            margin-right: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>
                <span class="en">SE311 - Requirements Engineering</span>
                <span class="ar" style="display:none;">هندسة المتطلبات - SE311</span>
            </h1>
            <p>
                <span class="en">Chapter 6: Requirements Validation & Verification - Comprehensive Exam</span>
                <span class="ar" style="display:none;">الفصل السادس: التحقق والتثبت من المتطلبات - اختبار شامل</span>
            </p>
        </div>

        <div class="controls">
            <div class="toggle-buttons">
                <button class="lang-toggle" onclick="toggleLanguage()" type="button">
                    <span class="en">العربية</span>
                    <span class="ar" style="display:none;">English</span>
                </button>
            </div>
        </div>

        <form id="examForm">
            <!-- Question 1: MCQ - Validation vs Verification (From Exams) -->
            <div class="question">
                <div class="question-header">
                    <span class="question-number">
                        <span class="en">Question 1</span>
                        <span class="ar" style="display:none;">السؤال ١</span>
                    </span>
                    <span class="question-type">
                        <span class="en">Multiple Choice (2 points)</span>
                        <span class="ar" style="display:none;">اختيار من متعدد (٢ نقطة)</span>
                        <span class="exam-tag">EXAM</span>
                    </span>
                </div>
                <div class="question-text">
                    <span class="en">Which of the following property does NOT correspond to a good Software Requirements Specification (SRS)?</span>
                    <span class="ar" style="display:none;">أي من الخصائص التالية لا تتوافق مع مواصفات متطلبات برمجيات جيدة (SRS)؟</span>
                </div>
                <div class="options">
                    <div class="option">
                        <input type="radio" id="q1a" name="q1" value="a">
                        <label for="q1a">
                            <span class="en">Verifiable</span>
                            <span class="ar" style="display:none;">قابلة للتحقق</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q1b" name="q1" value="b">
                        <label for="q1b">
                            <span class="en">Ambiguous</span>
                            <span class="ar" style="display:none;">غامضة</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q1c" name="q1" value="c">
                        <label for="q1c">
                            <span class="en">Complete</span>
                            <span class="ar" style="display:none;">مكتملة</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q1d" name="q1" value="d">
                        <label for="q1d">
                            <span class="en">Traceable</span>
                            <span class="ar" style="display:none;">قابلة للتتبع</span>
                        </label>
                    </div>
                </div>
                <div class="feedback" data-question="1"></div>
            </div>

            <!-- Question 2: MCQ - Validation Definition -->
            <div class="question">
                <div class="question-header">
                    <span class="question-number">
                        <span class="en">Question 2</span>
                        <span class="ar" style="display:none;">السؤال ٢</span>
                    </span>
                    <span class="question-type">
                        <span class="en">Multiple Choice (2 points)</span>
                        <span class="ar" style="display:none;">اختيار من متعدد (٢ نقطة)</span>
                        <span class="generated-tag">GENERATED</span>
                    </span>
                </div>
                <div class="question-text">
                    <span class="en">What is the main question that Requirements Validation answers?</span>
                    <span class="ar" style="display:none;">ما هو السؤال الرئيسي الذي يجيب عليه التثبت من المتطلبات؟</span>
                </div>
                <div class="options">
                    <div class="option">
                        <input type="radio" id="q2a" name="q2" value="a">
                        <label for="q2a">
                            <span class="en">Are we building the product right?</span>
                            <span class="ar" style="display:none;">هل نبني المنتج بشكل صحيح؟</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q2b" name="q2" value="b">
                        <label for="q2b">
                            <span class="en">Are we building the right product?</span>
                            <span class="ar" style="display:none;">هل نبني المنتج الصحيح؟</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q2c" name="q2" value="c">
                        <label for="q2c">
                            <span class="en">Is the code free of bugs?</span>
                            <span class="ar" style="display:none;">هل الكود خالٍ من الأخطاء؟</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q2d" name="q2" value="d">
                        <label for="q2d">
                            <span class="en">Is the system performance optimal?</span>
                            <span class="ar" style="display:none;">هل أداء النظام مثالي؟</span>
                        </label>
                    </div>
                </div>
                <div class="feedback" data-question="2"></div>
            </div>

            <!-- Question 3: MCQ - Verification Definition -->
            <div class="question">
                <div class="question-header">
                    <span class="question-number">
                        <span class="en">Question 3</span>
                        <span class="ar" style="display:none;">السؤال ٣</span>
                    </span>
                    <span class="question-type">
                        <span class="en">Multiple Choice (2 points)</span>
                        <span class="ar" style="display:none;">اختيار من متعدد (٢ نقطة)</span>
                        <span class="generated-tag">GENERATED</span>
                    </span>
                </div>
                <div class="question-text">
                    <span class="en">Requirements Verification checks that:</span>
                    <span class="ar" style="display:none;">التحقق من المتطلبات يفحص أن:</span>
                </div>
                <div class="options">
                    <div class="option">
                        <input type="radio" id="q3a" name="q3" value="a">
                        <label for="q3a">
                            <span class="en">The product satisfies customer needs</span>
                            <span class="ar" style="display:none;">المنتج يرضي احتياجات العملاء</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q3b" name="q3" value="b">
                        <label for="q3b">
                            <span class="en">Each development step meets its requirements correctly</span>
                            <span class="ar" style="display:none;">كل خطوة تطوير تحقق متطلباتها بشكل صحيح</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q3c" name="q3" value="c">
                        <label for="q3c">
                            <span class="en">The business objectives are met</span>
                            <span class="ar" style="display:none;">الأهداف التجارية تتحقق</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q3d" name="q3" value="d">
                        <label for="q3d">
                            <span class="en">Stakeholders are satisfied</span>
                            <span class="ar" style="display:none;">المعنيون راضون</span>
                        </label>
                    </div>
                </div>
                <div class="feedback" data-question="3"></div>
            </div>

            <!-- Question 4: Multiple Select - V&V Techniques -->
            <div class="question">
                <div class="question-header">
                    <span class="question-number">
                        <span class="en">Question 4</span>
                        <span class="ar" style="display:none;">السؤال ٤</span>
                    </span>
                    <span class="question-type">
                        <span class="en">Multiple Select (3 points)</span>
                        <span class="ar" style="display:none;">اختيار متعدد (٣ نقاط)</span>
                        <span class="generated-tag">GENERATED</span>
                    </span>
                </div>
                <div class="question-text">
                    <span class="en">Which of the following are valid Requirements V&V techniques? (Select all that apply)</span>
                    <span class="ar" style="display:none;">أي من التالي تعد تقنيات صحيحة للتحقق والتثبت من المتطلبات؟ (اختر جميع الإجابات الصحيحة)</span>
                </div>
                <div class="options">
                    <div class="option">
                        <input type="checkbox" id="q4a" name="q4" value="a">
                        <label for="q4a">
                            <span class="en">Reviews and Inspections</span>
                            <span class="ar" style="display:none;">المراجعات والتفتيشات</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="checkbox" id="q4b" name="q4" value="b">
                        <label for="q4b">
                            <span class="en">Prototyping</span>
                            <span class="ar" style="display:none;">النماذج الأولية</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="checkbox" id="q4c" name="q4" value="c">
                        <label for="q4c">
                            <span class="en">Functional Test Design</span>
                            <span class="ar" style="display:none;">تصميم الاختبارات الوظيفية</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="checkbox" id="q4d" name="q4" value="d">
                        <label for="q4d">
                            <span class="en">Code Optimization</span>
                            <span class="ar" style="display:none;">تحسين الكود</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="checkbox" id="q4e" name="q4" value="e">
                        <label for="q4e">
                            <span class="en">Simple Checks using Traceability</span>
                            <span class="ar" style="display:none;">فحوصات بسيطة باستخدام القابلية للتتبع</span>
                        </label>
                    </div>
                </div>
                <div class="feedback" data-question="4"></div>
            </div>

            <!-- Question 5: MCQ - Fagan Inspection -->
            <div class="question">
                <div class="question-header">
                    <span class="question-number">
                        <span class="en">Question 5</span>
                        <span class="ar" style="display:none;">السؤال ٥</span>
                    </span>
                    <span class="question-type">
                        <span class="en">Multiple Choice (2 points)</span>
                        <span class="ar" style="display:none;">اختيار من متعدد (٢ نقطة)</span>
                        <span class="generated-tag">GENERATED</span>
                    </span>
                </div>
                <div class="question-text">
                    <span class="en">In Fagan Inspection, how many reviewers should typically participate?</span>
                    <span class="ar" style="display:none;">في تفتيش فاغان، كم عدد المراجعين الذين يجب أن يشاركوا عادةً؟</span>
                </div>
                <div class="options">
                    <div class="option">
                        <input type="radio" id="q5a" name="q5" value="a">
                        <label for="q5a">
                            <span class="en">1 to 2 reviewers</span>
                            <span class="ar" style="display:none;">من ١ إلى ٢ مراجع</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q5b" name="q5" value="b">
                        <label for="q5b">
                            <span class="en">3 to 5 reviewers</span>
                            <span class="ar" style="display:none;">من ٣ إلى ٥ مراجعين</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q5c" name="q5" value="c">
                        <label for="q5c">
                            <span class="en">6 to 10 reviewers</span>
                            <span class="ar" style="display:none;">من ٦ إلى ١٠ مراجعين</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q5d" name="q5" value="d">
                        <label for="q5d">
                            <span class="en">More than 10 reviewers</span>
                            <span class="ar" style="display:none;">أكثر من ١٠ مراجعين</span>
                        </label>
                    </div>
                </div>
                <div class="feedback" data-question="5"></div>
            </div>

            <!-- Question 6: MCQ - Review Problem Categories -->
            <div class="question">
                <div class="question-header">
                    <span class="question-number">
                        <span class="en">Question 6</span>
                        <span class="ar" style="display:none;">السؤال ٦</span>
                    </span>
                    <span class="question-type">
                        <span class="en">Multiple Choice (2 points)</span>
                        <span class="ar" style="display:none;">اختيار من متعدد (٢ نقطة)</span>
                        <span class="generated-tag">GENERATED</span>
                    </span>
                </div>
                <div class="question-text">
                    <span class="en">Which of the following is NOT a typical problem category found during requirements reviews?</span>
                    <span class="ar" style="display:none;">أي من التالي ليس فئة مشكلة نموذجية يتم العثور عليها أثناء مراجعات المتطلبات؟</span>
                </div>
                <div class="options">
                    <div class="option">
                        <input type="radio" id="q6a" name="q6" value="a">
                        <label for="q6a">
                            <span class="en">Requirements clarification</span>
                            <span class="ar" style="display:none;">توضيح المتطلبات</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q6b" name="q6" value="b">
                        <label for="q6b">
                            <span class="en">Missing information</span>
                            <span class="ar" style="display:none;">معلومات مفقودة</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q6c" name="q6" value="c">
                        <label for="q6c">
                            <span class="en">Code implementation errors</span>
                            <span class="ar" style="display:none;">أخطاء تنفيذ الكود</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q6d" name="q6" value="d">
                        <label for="q6d">
                            <span class="en">Unrealistic requirements</span>
                            <span class="ar" style="display:none;">متطلبات غير واقعية</span>
                        </label>
                    </div>
                </div>
                <div class="feedback" data-question="6"></div>
            </div>

            <!-- Question 7: MCQ - Review Checklist -->
            <div class="question">
                <div class="question-header">
                    <span class="question-number">
                        <span class="en">Question 7</span>
                        <span class="ar" style="display:none;">السؤال ٧</span>
                    </span>
                    <span class="question-type">
                        <span class="en">Multiple Choice (2 points)</span>
                        <span class="ar" style="display:none;">اختيار من متعدد (٢ نقطة)</span>
                        <span class="generated-tag">GENERATED</span>
                    </span>
                </div>
                <div class="question-text">
                    <span class="en">Which checklist item checks if requirements can be linked to their origins and related requirements?</span>
                    <span class="ar" style="display:none;">أي عنصر من قائمة الفحص يتحقق من إمكانية ربط المتطلبات بمصادرها والمتطلبات ذات الصلة؟</span>
                </div>
                <div class="options">
                    <div class="option">
                        <input type="radio" id="q7a" name="q7" value="a">
                        <label for="q7a">
                            <span class="en">Comprehensibility</span>
                            <span class="ar" style="display:none;">الوضوح</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q7b" name="q7" value="b">
                        <label for="q7b">
                            <span class="en">Traceability</span>
                            <span class="ar" style="display:none;">القابلية للتتبع</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q7c" name="q7" value="c">
                        <label for="q7c">
                            <span class="en">Consistency</span>
                            <span class="ar" style="display:none;">الاتساق</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q7d" name="q7" value="d">
                        <label for="q7d">
                            <span class="en">Organization</span>
                            <span class="ar" style="display:none;">التنظيم</span>
                        </label>
                    </div>
                </div>
                <div class="feedback" data-question="7"></div>
            </div>

            <!-- Question 8: MCQ - Functional Test Design -->
            <div class="question">
                <div class="question-header">
                    <span class="question-number">
                        <span class="en">Question 8</span>
                        <span class="ar" style="display:none;">السؤال ٨</span>
                    </span>
                    <span class="question-type">
                        <span class="en">Multiple Choice (2 points)</span>
                        <span class="ar" style="display:none;">اختيار من متعدد (٢ نقطة)</span>
                        <span class="generated-tag">GENERATED</span>
                    </span>
                </div>
                <div class="question-text">
                    <span class="en">What is a key benefit of designing functional tests during requirements validation?</span>
                    <span class="ar" style="display:none;">ما هي الفائدة الرئيسية من تصميم الاختبارات الوظيفية أثناء التثبت من المتطلبات؟</span>
                </div>
                <div class="options">
                    <div class="option">
                        <input type="radio" id="q8a" name="q8" value="a">
                        <label for="q8a">
                            <span class="en">It speeds up coding</span>
                            <span class="ar" style="display:none;">يسرع عملية البرمجة</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q8b" name="q8" value="b">
                        <label for="q8b">
                            <span class="en">It may reveal errors in specification before design and implementation</span>
                            <span class="ar" style="display:none;">قد يكشف عن أخطاء في المواصفات قبل التصميم والتنفيذ</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q8c" name="q8" value="c">
                        <label for="q8c">
                            <span class="en">It replaces the need for prototyping</span>
                            <span class="ar" style="display:none;">يستبدل الحاجة للنماذج الأولية</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q8d" name="q8" value="d">
                        <label for="q8d">
                            <span class="en">It eliminates the need for reviews</span>
                            <span class="ar" style="display:none;">يلغي الحاجة للمراجعات</span>
                        </label>
                    </div>
                </div>
                <div class="feedback" data-question="8"></div>
            </div>

            <!-- Question 9: Short Answer - What to Validate -->
            <div class="question">
                <div class="question-header">
                    <span class="question-number">
                        <span class="en">Question 9</span>
                        <span class="ar" style="display:none;">السؤال ٩</span>
                    </span>
                    <span class="question-type">
                        <span class="en">Short Answer (4 points)</span>
                        <span class="ar" style="display:none;">إجابة قصيرة (٤ نقاط)</span>
                        <span class="generated-tag">GENERATED</span>
                    </span>
                </div>
                <div class="question-text">
                    <span class="en">List and briefly explain four key aspects that should be validated during requirements validation.</span>
                    <span class="ar" style="display:none;">اسرد واشرح بإيجاز أربعة جوانب رئيسية يجب التحقق منها أثناء التثبت من المتطلبات.</span>
                </div>
                <textarea name="q9" rows="8" placeholder="Type your answer here / اكتب إجابتك هنا"></textarea>
                <div class="feedback" data-question="9"></div>
            </div>

            <!-- Question 10: Short Answer - Validation vs Verification -->
            <div class="question">
                <div class="question-header">
                    <span class="question-number">
                        <span class="en">Question 10</span>
                        <span class="ar" style="display:none;">السؤال ١٠</span>
                    </span>
                    <span class="question-type">
                        <span class="en">Short Answer (3 points)</span>
                        <span class="ar" style="display:none;">إجابة قصيرة (٣ نقاط)</span>
                        <span class="generated-tag">GENERATED</span>
                    </span>
                </div>
                <div class="question-text">
                    <span class="en">Explain the difference between requirements validation and requirements verification with examples.</span>
                    <span class="ar" style="display:none;">اشرح الفرق بين التثبت من المتطلبات والتحقق من المتطلبات مع أمثلة.</span>
                </div>
                <textarea name="q10" rows="6" placeholder="Type your answer here / اكتب إجابتك هنا"></textarea>
                <div class="feedback" data-question="10"></div>
            </div>

            <!-- Question 11: MCQ - Review Advantages -->
            <div class="question">
                <div class="question-header">
                    <span class="question-number">
                        <span class="en">Question 11</span>
                        <span class="ar" style="display:none;">السؤال ١١</span>
                    </span>
                    <span class="question-type">
                        <span class="en">Multiple Choice (2 points)</span>
                        <span class="ar" style="display:none;">اختيار من متعدد (٢ نقطة)</span>
                        <span class="generated-tag">GENERATED</span>
                    </span>
                </div>
                <div class="question-text">
                    <span class="en">Which of the following is an advantage of requirements reviews and inspections?</span>
                    <span class="ar" style="display:none;">أي من التالي يعد ميزة لمراجعات وتفتيشات المتطلبات؟</span>
                </div>
                <div class="options">
                    <div class="option">
                        <input type="radio" id="q11a" name="q11" value="a">
                        <label for="q11a">
                            <span class="en">They are inexpensive and quick</span>
                            <span class="ar" style="display:none;">غير مكلفة وسريعة</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q11b" name="q11" value="b">
                        <label for="q11b">
                            <span class="en">They allow finding sources of errors, not just symptoms</span>
                            <span class="ar" style="display:none;">تسمح بإيجاد مصادر الأخطاء وليس الأعراض فقط</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q11c" name="q11" value="c">
                        <label for="q11c">
                            <span class="en">They are always enjoyable for participants</span>
                            <span class="ar" style="display:none;">دائماً ممتعة للمشاركين</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q11d" name="q11" value="d">
                        <label for="q11d">
                            <span class="en">They eliminate the need for testing</span>
                            <span class="ar" style="display:none;">تلغي الحاجة للاختبار</span>
                        </label>
                    </div>
                </div>
                <div class="feedback" data-question="11"></div>
            </div>

            <!-- Question 12: MCQ - Model Checking -->
            <div class="question">
                <div class="question-header">
                    <span class="question-number">
                        <span class="en">Question 12</span>
                        <span class="ar" style="display:none;">السؤال ١٢</span>
                    </span>
                    <span class="question-type">
                        <span class="en">Multiple Choice (2 points)</span>
                        <span class="ar" style="display:none;">اختيار من متعدد (٢ نقطة)</span>
                        <span class="generated-tag">GENERATED</span>
                    </span>
                </div>
                <div class="question-text">
                    <span class="en">What is a major obstacle in model checking?</span>
                    <span class="ar" style="display:none;">ما هي العقبة الرئيسية في فحص النماذج؟</span>
                </div>
                <div class="options">
                    <div class="option">
                        <input type="radio" id="q12a" name="q12" value="a">
                        <label for="q12a">
                            <span class="en">Lack of tools</span>
                            <span class="ar" style="display:none;">نقص الأدوات</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q12b" name="q12" value="b">
                        <label for="q12b">
                            <span class="en">State space explosion</span>
                            <span class="ar" style="display:none;">انفجار فضاء الحالة</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q12c" name="q12" value="c">
                        <label for="q12c">
                            <span class="en">Poor documentation</span>
                            <span class="ar" style="display:none;">وثائق ضعيفة</span>
                        </label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q12d" name="q12" value="d">
                        <label for="q12d">
                            <span class="en">Stakeholder disagreement</span>
                            <span class="ar" style="display:none;">عدم اتفاق المعنيين</span>
                        </label>
                    </div>
                </div>
                <div class="feedback" data-question="12"></div>
            </div>

            <!-- Question 13: Short Answer - Review Process -->
            <div class="question">
                <div class="question-header">
                    <span class="question-number">
                        <span class="en">Question 13</span>
                        <span class="ar" style="display:none;">السؤال ١٣</span>
                    </span>
                    <span class="question-type">
                        <span class="en">Short Answer (4 points)</span>
                        <span class="ar" style="display:none;">إجابة قصيرة (٤ نقاط)</span>
                        <span class="generated-tag">GENERATED</span>
                    </span>
                </div>
                <div class="question-text">
                    <span class="en">Describe the key characteristics of a Fagan Inspection and explain why it is considered an effective requirements validation technique.</span>
                    <span class="ar" style="display:none;">صف الخصائص الرئيسية لتفتيش فاغان واشرح لماذا يعتبر تقنية فعالة للتثبت من المتطلبات.</span>
                </div>
                <textarea name="q13" rows="8" placeholder="Type your answer here / اكتب إجابتك هنا"></textarea>
                <div class="feedback" data-question="13"></div>
            </div>

            <button type="button" class="submit-btn" onclick="gradeExam()">
                <span class="en">Submit Exam</span>
                <span class="ar" style="display:none;">تسليم الاختبار</span>
            </button>
        </form>

        <div class="score-display" id="scoreDisplay">
            <h2>
                <span class="en">Your Score:</span>
                <span class="ar" style="display:none;">درجتك:</span>
                <span id="finalScore"></span>
            </h2>
            <p>
                <span class="en">out of 30 points</span>
                <span class="ar" style="display:none;">من ٣٠ نقطة</span>
            </p>
        </div>
    </div>

    <script>
        // Language toggle
        let currentLang = 'en';

        function toggleLanguage() {
            currentLang = currentLang === 'en' ? 'ar' : 'en';
            const html = document.documentElement;
            
            if (currentLang === 'ar') {
                html.setAttribute('dir', 'rtl');
                html.setAttribute('lang', 'ar');
                document.querySelectorAll('.en').forEach(el => el.style.display = 'none');
                document.querySelectorAll('.ar').forEach(el => el.style.display = '');
            } else {
                html.setAttribute('dir', 'ltr');
                html.setAttribute('lang', 'en');
                document.querySelectorAll('.en').forEach(el => el.style.display = '');
                document.querySelectorAll('.ar').forEach(el => el.style.display = 'none');
            }
        }

        // Dark mode detection
        function detectColorScheme() {
            const darkModeQuery = window.matchMedia('(prefers-color-scheme: dark)');
            
            function updateTheme(e) {
                document.documentElement.setAttribute('data-theme', e.matches ? 'dark' : 'light');
            }
            
            updateTheme(darkModeQuery);
            darkModeQuery.addEventListener('change', updateTheme);
        }

        // Initialize on page load
        detectColorScheme();

        // Answer key with detailed feedback
        const answerKey = {
            q1: {
                correct: 'b',
                explanation: {
                    en: "A good SRS should be verifiable, complete, and traceable, but should NOT be ambiguous. Ambiguity leads to misunderstandings and incorrect implementations.",
                    ar: "يجب أن تكون مواصفات المتطلبات الجيدة قابلة للتحقق ومكتملة وقابلة للتتبع، ولكن لا يجب أن تكون غامضة. الغموض يؤدي إلى سوء الفهم والتنفيذ غير الصحيح."
                },
                modelAnswer: {
                    en: "Ambiguous - Requirements should be unambiguous, meaning they should have a single, clear interpretation.",
                    ar: "غامضة - يجب أن تكون المتطلبات واضحة وغير غامضة، أي يجب أن يكون لها تفسير واحد واضح."
                }
            },
            q2: {
                correct: 'b',
                explanation: {
                    en: "Requirements Validation asks 'Are we building the right product?' - checking if the product satisfies customer needs. Verification asks 'Are we building the product right?'",
                    ar: "التثبت من المتطلبات يسأل 'هل نبني المنتج الصحيح؟' - للتحقق مما إذا كان المنتج يرضي احتياجات العملاء. التحقق يسأل 'هل نبني المنتج بشكل صحيح؟'"
                },
                modelAnswer: {
                    en: "Are we building the right product? - Validation assesses whether a product satisfies customer needs.",
                    ar: "هل نبني المنتج الصحيح؟ - التثبت يقيّم ما إذا كان المنتج يرضي احتياجات العملاء."
                }
            },
            q3: {
                correct: 'b',
                explanation: {
                    en: "Verification checks that each step in the development process meets its requirements correctly - ensuring the product is being built right according to specifications.",
                    ar: "التحقق يفحص أن كل خطوة في عملية التطوير تحقق متطلباتها بشكل صحيح - لضمان بناء المنتج بشكل صحيح وفقاً للمواصفات."
                },
                modelAnswer: {
                    en: "Each development step meets its requirements correctly - Verification ensures each step yields the right products.",
                    ar: "كل خطوة تطوير تحقق متطلباتها بشكل صحيح - التحقق يضمن أن كل خطوة تنتج المنتجات الصحيحة."
                }
            },
            q4: {
                correct: ['a', 'b', 'c', 'e'],
                explanation: {
                    en: "Valid V&V techniques include: Reviews/Inspections, Prototyping, Functional Test Design, and Simple Checks using Traceability. Code Optimization is not a requirements validation technique.",
                    ar: "تقنيات التحقق والتثبت الصحيحة تشمل: المراجعات/التفتيشات، النماذج الأولية، تصميم الاختبارات الوظيفية، والفحوصات البسيطة باستخدام القابلية للتتبع. تحسين الكود ليس تقنية للتثبت من المتطلبات."
                },
                modelAnswer: {
                    en: "Reviews and Inspections, Prototyping, Functional Test Design, Simple Checks using Traceability. Also valid: Model-Based V&V.",
                    ar: "المراجعات والتفتيشات، النماذج الأولية، تصميم الاختبارات الوظيفية، الفحوصات البسيطة باستخدام القابلية للتتبع. أيضاً صحيح: التحقق والتثبت المبني على النماذج."
                }
            },
            q5: {
                correct: 'b',
                explanation: {
                    en: "Fagan Inspection is characterized by having 3 to 5 reviewers. Sessions should not exceed 2 hours to keep participants focused.",
                    ar: "يتميز تفتيش فاغان بوجود من ٣ إلى ٥ مراجعين. يجب ألا تتجاوز الجلسات ساعتين للحفاظ على تركيز المشاركين."
                },
                modelAnswer: {
                    en: "3 to 5 reviewers - This is optimal for effective inspection while keeping the process manageable.",
                    ar: "من ٣ إلى ٥ مراجعين - هذا العدد مثالي للتفتيش الفعال مع الحفاظ على العملية قابلة للإدارة."
                }
            },
            q6: {
                correct: 'c',
                explanation: {
                    en: "Code implementation errors are not found during requirements reviews. Typical categories include: requirements clarification, missing information, requirements conflict, and unrealistic requirements.",
                    ar: "أخطاء تنفيذ الكود لا يتم العثور عليها أثناء مراجعات المتطلبات. الفئات النموذجية تشمل: توضيح المتطلبات، المعلومات المفقودة، تعارض المتطلبات، والمتطلبات غير الواقعية."
                },
                modelAnswer: {
                    en: "Code implementation errors - Reviews focus on requirements quality, not code implementation.",
                    ar: "أخطاء تنفيذ الكود - المراجعات تركز على جودة المتطلبات وليس تنفيذ الكود."
                }
            },
            q7: {
                correct: 'b',
                explanation: {
                    en: "Traceability checks if requirements are unambiguously identified and include links to related requirements and their origins.",
                    ar: "القابلية للتتبع تتحقق مما إذا كانت المتطلبات محددة بشكل لا لبس فيه وتتضمن روابط للمتطلبات ذات الصلة ومصادرها."
                },
                modelAnswer: {
                    en: "Traceability - Ensures requirements can be linked to their origins and related requirements.",
                    ar: "القابلية للتتبع - تضمن إمكانية ربط المتطلبات بمصادرها والمتطلبات ذات الصلة."
                }
            },
            q8: {
                correct: 'b',
                explanation: {
                    en: "Designing functional tests during validation may reveal errors in the specification before design and implementation, saving time and cost by finding issues early.",
                    ar: "تصميم الاختبارات الوظيفية أثناء التثبت قد يكشف عن أخطاء في المواصفات قبل التصميم والتنفيذ، مما يوفر الوقت والتكلفة باكتشاف المشاكل مبكراً."
                },
                modelAnswer: {
                    en: "It may reveal errors in specification before design and implementation - Early detection saves costs.",
                    ar: "قد يكشف عن أخطاء في المواصفات قبل التصميم والتنفيذ - الاكتشاف المبكر يوفر التكاليف."
                }
            },
            q9: {
                keywords: {
                    en: ['accurate', 'complete', 'feasible', 'verifiable', 'necessary', 'sufficient', 'consistent',
                         'stakeholders', 'business objectives', 'design', 'construction', 'requirements'],
                    ar: ['دقيقة', 'مكتملة', 'قابلة للتنفيذ', 'قابلة للتحقق', 'ضرورية', 'كافية', 'متسقة',
                         'معنيين', 'أهداف', 'تصميم', 'بناء', 'متطلبات']
                },
                modelAnswer: {
                    en: `Four key aspects to validate:

1. ACCURACY AND CORRECTNESS: The software requirements accurately describe the intended system capabilities and properties that will satisfy stakeholders' needs. Requirements should be correctly derived from business requirements and other sources.

2. COMPLETENESS AND SUFFICIENCY: All requirements are necessary, and the entire set is sufficient to meet the business objectives. No critical requirements should be missing.

3. FEASIBILITY AND VERIFIABILITY: Requirements are complete, feasible to implement with available technology and constraints, and verifiable through testing or other means.

4. CONSISTENCY AND ADEQUACY: All requirements representations are consistent with each other, and the requirements provide an adequate basis to proceed with design and construction.`,
                    ar: `أربعة جوانب رئيسية للتحقق منها:

١. الدقة والصحة: متطلبات البرمجيات تصف بدقة قدرات وخصائص النظام المقصود التي سترضي احتياجات المعنيين. يجب اشتقاق المتطلبات بشكل صحيح من متطلبات العمل ومصادر أخرى.

٢. الاكتمال والكفاية: جميع المتطلبات ضرورية، والمجموعة الكاملة كافية لتحقيق أهداف العمل. لا يجب أن تكون هناك متطلبات حاسمة مفقودة.

٣. قابلية التنفيذ والتحقق: المتطلبات مكتملة وقابلة للتنفيذ بالتقنية والقيود المتاحة، وقابلة للتحقق من خلال الاختبار أو وسائل أخرى.

٤. الاتساق والملاءمة: جميع تمثيلات المتطلبات متسقة مع بعضها البعض، والمتطلبات توفر أساساً كافياً للمضي قدماً في التصميم والبناء.`
                }
            },
            q10: {
                keywords: {
                    en: ['validation', 'verification', 'right product', 'product right', 'customer needs',
                         'specifications', 'building', 'requirements', 'quality assurance'],
                    ar: ['تثبت', 'تحقق', 'منتج صحيح', 'بشكل صحيح', 'احتياجات العملاء',
                         'مواصفات', 'بناء', 'متطلبات', 'ضمان الجودة']
                },
                modelAnswer: {
                    en: `Validation vs Verification:

VALIDATION (Are we building the right product?):
- Assesses whether the product satisfies customer needs and stakeholder requirements
- Checks if the software requirements specification aligns with stakeholders' goals
- Focuses on "doing the right thing"
- Example: Conducting user acceptance testing to ensure the banking app meets customer expectations for mobile deposits

VERIFICATION (Are we building the product right?):
- Determines whether the product of each development activity meets its requirements
- Checks consistency of SRS artifacts and development products against specifications
- Focuses on "doing the thing right"
- Example: Reviewing code to ensure it correctly implements the specified login authentication algorithm

Both are complementary processes related to quality assurance and should be performed throughout requirements development.`,
                    ar: `التثبت مقابل التحقق:

التثبت (هل نبني المنتج الصحيح؟):
- يقيّم ما إذا كان المنتج يرضي احتياجات العملاء ومتطلبات المعنيين
- يتحقق مما إذا كانت مواصفات متطلبات البرمجيات تتوافق مع أهداف المعنيين
- يركز على "فعل الشيء الصحيح"
- مثال: إجراء اختبار قبول المستخدم للتأكد من أن تطبيق الخدمات المصرفية يلبي توقعات العملاء للإيداعات عبر الجوال

التحقق (هل نبني المنتج بشكل صحيح؟):
- يحدد ما إذا كان ناتج كل نشاط تطوير يحقق متطلباته
- يتحقق من اتساق مكونات مواصفات المتطلبات ومنتجات التطوير مع المواصفات
- يركز على "فعل الشيء بشكل صحيح"
- مثال: مراجعة الكود للتأكد من أنه ينفذ بشكل صحيح خوارزمية المصادقة على تسجيل الدخول المحددة

كلاهما عمليات مكملة تتعلق بضمان الجودة ويجب تنفيذهما طوال تطوير المتطلبات.`
                }
            },
            q11: {
                correct: 'b',
                explanation: {
                    en: "Reviews and inspections allow finding sources of errors (root causes), not just symptoms. This makes them more effective than just finding surface-level problems.",
                    ar: "المراجعات والتفتيشات تسمح بإيجاد مصادر الأخطاء (الأسباب الجذرية) وليس الأعراض فقط. هذا يجعلها أكثر فعالية من مجرد إيجاد المشاكل السطحية."
                },
                modelAnswer: {
                    en: "They allow finding sources of errors, not just symptoms - This leads to more effective problem resolution.",
                    ar: "تسمح بإيجاد مصادر الأخطاء وليس الأعراض فقط - هذا يؤدي إلى حل أكثر فعالية للمشاكل."
                }
            },
            q12: {
                correct: 'b',
                explanation: {
                    en: "State space explosion is a major obstacle in model checking. As systems grow, the number of possible states grows exponentially, making exhaustive verification difficult.",
                    ar: "انفجار فضاء الحالة هو عقبة رئيسية في فحص النماذج. مع نمو الأنظمة، يزداد عدد الحالات المحتملة بشكل أسي، مما يجعل التحقق الشامل صعباً."
                },
                modelAnswer: {
                    en: "State space explosion - The number of possible system states grows exponentially, making verification difficult.",
                    ar: "انفجار فضاء الحالة - عدد حالات النظام المحتملة يزداد بشكل أسي، مما يجعل التحقق صعباً."
                }
            },
            q13: {
                keywords: {
                    en: ['formal', 'structured', '3 to 5', 'reviewers', 'author', 'moderator', 'checklists',
                         'metrics', 'inspection', '2 hours', 'problems', 'effective', 're-inspection'],
                    ar: ['رسمي', 'منظم', '٣ إلى ٥', 'مراجعين', 'مؤلف', 'منسق', 'قوائم فحص',
                         'مقاييس', 'تفتيش', 'ساعتين', 'مشاكل', 'فعال', 'إعادة تفتيش']
                },
                modelAnswer: {
                    en: `Fagan Inspection Characteristics:

KEY CHARACTERISTICS:
1. FORMAL AND STRUCTURED: Defined rules on who participates, how many reviewers, and what roles they play
2. LIMITED DURATION: Sessions not more than 2 hours at a time to keep participants focused
3. TEAM SIZE: 3 to 5 reviewers participate
4. DEFINED ROLES: Author presents the document, moderator leads the meeting and ensures issues are fixed
5. PREPARATION: All reviewers prepare using checklists before the meeting
6. METRICS COLLECTION: Data is collected but the author's supervisor doesn't participate (not an evaluation)
7. BRAINSTORMING APPROACH: Meeting focuses on identifying potential problems
8. RE-INSPECTION: Required if more than 5% of the document changes

WHY IT'S EFFECTIVE:
- Structured approach ensures thorough review
- Multiple perspectives from different reviewers
- Focuses on finding root causes, not just symptoms
- Preparation with checklists improves quality
- Time limits maintain focus and efficiency
- Separation from employee evaluation encourages honesty
- Re-inspection ensures quality of changes`,
                    ar: `خصائص تفتيش فاغان:

الخصائص الرئيسية:
١. رسمي ومنظم: قواعد محددة حول من يشارك وكم عدد المراجعين وما هي أدوارهم
٢. مدة محدودة: جلسات لا تزيد عن ساعتين في المرة الواحدة للحفاظ على تركيز المشاركين
٣. حجم الفريق: يشارك من ٣ إلى ٥ مراجعين
٤. أدوار محددة: المؤلف يقدم الوثيقة، والمنسق يقود الاجتماع ويضمن إصلاح المشاكل
٥. التحضير: جميع المراجعين يحضرون باستخدام قوائم الفحص قبل الاجتماع
٦. جمع المقاييس: يتم جمع البيانات لكن مشرف المؤلف لا يشارك (ليس تقييماً)
٧. نهج العصف الذهني: الاجتماع يركز على تحديد المشاكل المحتملة
٨. إعادة التفتيش: مطلوبة إذا تغير أكثر من ٥٪ من الوثيقة

لماذا هو فعال:
- النهج المنظم يضمن مراجعة شاملة
- وجهات نظر متعددة من مراجعين مختلفين
- يركز على إيجاد الأسباب الجذرية وليس الأعراض فقط
- التحضير بقوائم الفحص يحسن الجودة
- حدود الوقت تحافظ على التركيز والكفاءة
- الفصل عن تقييم الموظف يشجع على الصدق
- إعادة التفتيش تضمن جودة التغييرات`
                }
            }
        };

        // Grade exam function
        function gradeExam() {
            let totalScore = 0;
            const maxScore = 30;

            // Grade Q1-Q3, Q5-Q8, Q11-Q12 (MCQ)
            ['q1', 'q2', 'q3', 'q5', 'q6', 'q7', 'q8', 'q11', 'q12'].forEach(qId => {
                const answer = document.querySelector(`input[name="${qId}"]:checked`);
                gradeMultipleChoice(qId, answer, 2);
            });

            // Grade Q4 (Multiple Select)
            const q4Answers = document.querySelectorAll('input[name="q4"]:checked');
            gradeMultipleSelect('q4', q4Answers, 3);

            // Grade Q9, Q10, Q13 (Short Answer)
            ['q9', 'q10', 'q13'].forEach(qId => {
                const answer = document.querySelector(`textarea[name="${qId}"]`).value;
                const points = qId === 'q10' ? 3 : 4;
                gradeShortAnswer(qId, answer, points);
            });

            // Calculate total score
            document.querySelectorAll('.feedback').forEach(feedback => {
                const score = parseFloat(feedback.dataset.score || 0);
                totalScore += score;
            });

            // Display score
            document.getElementById('finalScore').textContent = `${totalScore.toFixed(1)} / ${maxScore}`;
            document.getElementById('scoreDisplay').classList.add('show');

            // Scroll to score
            document.getElementById('scoreDisplay').scrollIntoView({ behavior: 'smooth' });

            // Disable submit button
            event.target.disabled = true;
        }

        function gradeMultipleChoice(questionId, answer, points) {
            const feedback = document.querySelector(`.feedback[data-question="${questionId.replace('q', '')}"]`);
            const correctAnswer = answerKey[questionId].correct;
            
            if (!answer) {
                showFeedback(feedback, 'incorrect', 0, questionId, currentLang === 'en' ? 
                    'No answer selected.' : 
                    'لم يتم تحديد إجابة.');
                return;
            }

            if (answer.value === correctAnswer) {
                showFeedback(feedback, 'correct', points, questionId, currentLang === 'en' ? 
                    '✓ Correct!' : 
                    '✓ صحيح!');
            } else {
                showFeedback(feedback, 'incorrect', 0, questionId, currentLang === 'en' ? 
                    '✗ Incorrect.' : 
                    '✗ خطأ.');
            }
        }

        function gradeMultipleSelect(questionId, answers, points) {
            const feedback = document.querySelector(`.feedback[data-question="${questionId.replace('q', '')}"]`);
            const correctAnswers = answerKey[questionId].correct;
            
            if (answers.length === 0) {
                showFeedback(feedback, 'incorrect', 0, questionId, currentLang === 'en' ? 
                    'No answers selected.' : 
                    'لم يتم تحديد أي إجابات.');
                return;
            }

            const selectedValues = Array.from(answers).map(a => a.value).sort();
            const correctValues = correctAnswers.sort();

            if (JSON.stringify(selectedValues) === JSON.stringify(correctValues)) {
                showFeedback(feedback, 'correct', points, questionId, currentLang === 'en' ? 
                    '✓ All correct!' : 
                    '✓ جميع الإجابات صحيحة!');
            } else {
                const correctCount = selectedValues.filter(v => correctValues.includes(v)).length;
                const incorrectCount = selectedValues.filter(v => !correctValues.includes(v)).length;
                const missedCount = correctValues.filter(v => !selectedValues.includes(v)).length;
                
                const partialScore = Math.max(0, (correctCount - incorrectCount) / correctValues.length * points);
                
                if (partialScore > 0) {
                    showFeedback(feedback, 'partial', partialScore, questionId, currentLang === 'en' ? 
                        `⚠ Partial credit: ${correctCount} correct, ${incorrectCount} incorrect, ${missedCount} missed.` :
                        `⚠ درجة جزئية: ${correctCount} صحيحة، ${incorrectCount} خاطئة، ${missedCount} مفقودة.`);
                } else {
                    showFeedback(feedback, 'incorrect', 0, questionId, currentLang === 'en' ? 
                        '✗ Incorrect selections.' : 
                        '✗ اختيارات خاطئة.');
                }
            }
        }

        function gradeShortAnswer(questionId, answer, points) {
            const feedback = document.querySelector(`.feedback[data-question="${questionId.replace('q', '')}"]`);
            
            if (!answer.trim()) {
                showFeedback(feedback, 'incorrect', 0, questionId, currentLang === 'en' ? 
                    'No answer provided.' : 
                    'لم يتم تقديم إجابة.');
                return;
            }

            const keywords = answerKey[questionId].keywords[currentLang];
            const answerLower = answer.toLowerCase();
            const matchedKeywords = keywords.filter(keyword => 
                answerLower.includes(keyword.toLowerCase())
            );

            const score = Math.min(points, (matchedKeywords.length / keywords.length) * points);
            
            if (score >= points * 0.8) {
                showFeedback(feedback, 'correct', score, questionId, currentLang === 'en' ? 
                    `✓ Excellent answer! Covered ${matchedKeywords.length} key concepts.` :
                    `✓ إجابة ممتازة! غطت ${matchedKeywords.length} من المفاهيم الرئيسية.`);
            } else if (score >= points * 0.5) {
                showFeedback(feedback, 'partial', score, questionId, currentLang === 'en' ? 
                    `⚠ Good effort! Covered ${matchedKeywords.length} key concepts. Review model answer for missing points.` :
                    `⚠ جهد جيد! غطت ${matchedKeywords.length} من المفاهيم الرئيسية. راجع الإجابة النموذجية للنقاط المفقودة.`);
            } else {
                showFeedback(feedback, 'partial', score, questionId, currentLang === 'en' ? 
                    `⚠ Needs improvement. Covered ${matchedKeywords.length} key concepts. Please review model answer.` :
                    `⚠ يحتاج إلى تحسين. غطت ${matchedKeywords.length} من المفاهيم الرئيسية. يرجى مراجعة الإجابة النموذجية.`);
            }
        }

        function showFeedback(feedbackElement, type, score, questionId, message) {
            feedbackElement.className = `feedback ${type}`;
            feedbackElement.dataset.score = score;
            
            const explanation = answerKey[questionId].explanation[currentLang];
            const modelAnswer = answerKey[questionId].modelAnswer[currentLang];
            
            feedbackElement.innerHTML = `
                <div class="feedback-header">
                    <span class="feedback-icon">${type === 'correct' ? '✓' : type === 'partial' ? '⚠' : '✗'}</span>
                    <span>${message} (${currentLang === 'en' ? 'Score' : 'الدرجة'}: ${score})</span>
                </div>
                <div style="margin-top: 8px;">${explanation}</div>
                <div class="model-answer">
                    <div class="model-answer-label">
                        ${currentLang === 'en' ? '📝 Model Answer:' : '📝 الإجابة النموذجية:'}
                    </div>
                    <div style="white-space: pre-line;">${modelAnswer}</div>
                </div>
            `;
        }
    </script>
</body>
</html>